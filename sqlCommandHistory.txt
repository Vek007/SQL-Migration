select ar_oeitm.product_id, ar_oeitm.descript as description, iv_sell_units.size as pk_size, iv_mast.vprod_id as vprod_id, 
iv_mast.pk_upc as pk_upc, iv_gtin.gtin as it_gtin, iv_mast.iv_class as it_class, iv_mast.brand as it_brand, iv_mast.vend_id as vend_id, apvend.company1 as vend_name, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.unit as it_unit, 
ar_oehdr.shipto_no as cust_no, ar_oehdr.ord_date as ord_date, ar_oehdr.shp_date as ship_date,  ar_oehdr.refno as order_no,   
ar_oehdr.oe_type, ar_oehdr.oe_status, arcust.Company1 as cust_name 
from ar_oeitm 
inner join ar_oehdr on ar_oeitm.refno = ar_oehdr.refno 
inner join arcust on arcust.cust_id = ar_oehdr.cust_id 
inner join iv_mast on ar_oeitm.product_id = iv_mast.product_id 
inner join apvend on iv_mast.vend_id = apvend.vend_id 
inner join iv_sell_units on ar_oeitm.product_id = iv_sell_units.product_id and ar_oeitm.price_unit = iv_sell_units.unit and ar_oeitm.bc = iv_sell_units.bc 
left join iv_gtin on ar_oeitm.product_id = iv_gtin.product_id 
where  ar_oeitm.refno = 1045249


select ar_oeitm.product_id, ar_oeitm.descript as description, iv_sell_units.size as pk_size, iv_mast.vprod_id as vprod_id, 
iv_mast.pk_upc as pk_upc, iv_gtin.gtin as it_gtin, iv_mast.iv_class as it_class, iv_mast.brand as it_brand, iv_mast.vend_id as vend_id, apvend.company1 as vend_name, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.unit as it_unit, 
ar_oehdr.shipto_no as cust_no, ar_oehdr.ord_date as ord_date, ar_oehdr.shp_date as ship_date,  ar_oehdr.refno as order_no,   
ar_oehdr.oe_type, ar_oehdr.oe_status, arcust.Company1 as cust_name 
from ar_oeitm 
inner join ar_oehdr on ar_oeitm.refno = ar_oehdr.refno 
inner join arcust on arcust.cust_id = ar_oehdr.cust_id 
inner join iv_mast on ar_oeitm.product_id = iv_mast.product_id 
inner join apvend on iv_mast.vend_id = apvend.vend_id 
inner join iv_sell_units on ar_oeitm.product_id = iv_sell_units.product_id and ar_oeitm.price_unit = iv_sell_units.unit and ar_oeitm.bc = iv_sell_units.bc 
left join iv_gtin on ar_oeitm.product_id = iv_gtin.product_id 
where  ar_oeitm.refno = 1045249

select * from apvend
select * from apvend where vend_id like '%90001%'
select ar_oeitm.product_id, ar_oeitm.descript as description, iv_sell_units.size as pk_size, iv_mast.vprod_id as vprod_id, 
iv_mast.pk_upc as pk_upc, iv_gtin.gtin as it_gtin, iv_mast.iv_class as it_class, iv_mast.brand as it_brand, iv_mast.vend_id as vend_id, apvend.company1 as vend_name, apvend.supplr_no as supplier, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.unit as it_unit, 
ar_oehdr.shipto_no as cust_no, ar_oehdr.ord_date as ord_date, ar_oehdr.shp_date as ship_date,  ar_oehdr.refno as order_no,   
ar_oehdr.oe_type, ar_oehdr.oe_status, arcust.Company1 as cust_name 
from ar_oeitm 
inner join ar_oehdr on ar_oeitm.refno = ar_oehdr.refno 
inner join arcust on arcust.cust_id = ar_oehdr.cust_id 
inner join iv_mast on ar_oeitm.product_id = iv_mast.product_id 
inner join apvend on iv_mast.vend_id = apvend.vend_id 
inner join iv_sell_units on ar_oeitm.product_id = iv_sell_units.product_id and ar_oeitm.price_unit = iv_sell_units.unit and ar_oeitm.bc = iv_sell_units.bc 
left join iv_gtin on ar_oeitm.product_id = iv_gtin.product_id 
where  ar_oeitm.refno = 1045249
select ar_oehdr.cust_id as cust_no,  ar_oehdr.shipto_no as shp_to_no, arcust.Company1 as cust_name, ar_oehdr.ord_date as ord_date, ar_oehdr.shp_date as ship_date, ar_oehdr.refno as order_no, ar_oeitm.item as inv_line_no, ar_oeitm.product_id, 
                iv_mast.pk_ctch_wt as has_ctch_wgt, ar_oeitm.descript as description, iv_sell_units.size as pk_size, iv_mast.vprod_id as vprod_id, iv_mast.pk_upc as pk_upc, iv_gtin.gtin as it_gtin, iv_mast.brand as it_brand,  iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.unit as it_unit, iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, apvend.company1 as vend_name, , apvend.supp_no as supplier, ar_oeitm.ord_qty as order_qty 
                from ar_oeitm 
                inner join ar_oehdr on ar_oeitm.refno = ar_oehdr.refno 
                inner join arcust on arcust.cust_id = ar_oehdr.cust_id 
                inner join iv_mast on ar_oeitm.product_id = iv_mast.product_id 
                inner join apvend on iv_mast.vend_id = apvend.vend_id 
                inner join iv_sell_units on ar_oeitm.product_id = iv_sell_units.product_id and ar_oeitm.price_unit = iv_sell_units.unit and ar_oeitm.bc = iv_sell_units.bc left join iv_gtin on ar_oeitm.product_id = iv_gtin.product_id 
                where ar_oehdr.cust_id like '%171155%' and oe_status <> 5 order by order_no, inv_line_no
select ar_oehdr.cust_id as cust_no,  ar_oehdr.shipto_no as shp_to_no, arcust.Company1 as cust_name, ar_oehdr.ord_date as ord_date, ar_oehdr.shp_date as ship_date, ar_oehdr.refno as order_no, ar_oeitm.item as inv_line_no, ar_oeitm.product_id, 
                iv_mast.pk_ctch_wt as has_ctch_wgt, ar_oeitm.descript as description, iv_sell_units.size as pk_size, iv_mast.vprod_id as vprod_id, iv_mast.pk_upc as pk_upc, iv_gtin.gtin as it_gtin, iv_mast.brand as it_brand,  iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.unit as it_unit, iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, apvend.company1 as vend_name, apvend.supp_no as supplier, ar_oeitm.ord_qty as order_qty 
                from ar_oeitm 
                inner join ar_oehdr on ar_oeitm.refno = ar_oehdr.refno 
                inner join arcust on arcust.cust_id = ar_oehdr.cust_id 
                inner join iv_mast on ar_oeitm.product_id = iv_mast.product_id 
                inner join apvend on iv_mast.vend_id = apvend.vend_id 
                inner join iv_sell_units on ar_oeitm.product_id = iv_sell_units.product_id and ar_oeitm.price_unit = iv_sell_units.unit and ar_oeitm.bc = iv_sell_units.bc left join iv_gtin on ar_oeitm.product_id = iv_gtin.product_id 
                where ar_oehdr.cust_id like '%171155%' and oe_status <> 5 order by order_no, inv_line_no
select ar_oehdr.cust_id as cust_no,  ar_oehdr.shipto_no as shp_to_no, arcust.Company1 as cust_name, ar_oehdr.ord_date as ord_date, ar_oehdr.shp_date as ship_date, ar_oehdr.refno as order_no, ar_oeitm.item as inv_line_no, ar_oeitm.product_id, 
                iv_mast.pk_ctch_wt as has_ctch_wgt, ar_oeitm.descript as description, iv_sell_units.size as pk_size, iv_mast.vprod_id as vprod_id, iv_mast.pk_upc as pk_upc, iv_gtin.gtin as it_gtin, iv_mast.brand as it_brand,  iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.unit as it_unit, iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, apvend.company1 as vend_name, apvend.supp_no as supplier, ar_oeitm.ord_qty as order_qty 
                from ar_oeitm 
                inner join ar_oehdr on ar_oeitm.refno = ar_oehdr.refno 
                inner join arcust on arcust.cust_id = ar_oehdr.cust_id 
                inner join iv_mast on ar_oeitm.product_id = iv_mast.product_id 
                inner join apvend on iv_mast.vend_id = apvend.vend_id 
                inner join iv_sell_units on ar_oeitm.product_id = iv_sell_units.product_id and ar_oeitm.price_unit = iv_sell_units.unit and ar_oeitm.bc = iv_sell_units.bc left join iv_gtin on ar_oeitm.product_id = iv_gtin.product_id 
                where ar_oehdr.cust_id like '%171155%' and oe_status <> 5 order by order_no, inv_line_no
select ar_oehdr.cust_id as cust_no,  ar_oehdr.shipto_no as shp_to_no, arcust.Company1 as cust_name, ar_oehdr.ord_date as ord_date, ar_oehdr.shp_date as ship_date, ar_oehdr.refno as order_no, ar_oeitm.item as inv_line_no, ar_oeitm.product_id, 
                iv_mast.pk_ctch_wt as has_ctch_wgt, ar_oeitm.descript as description, iv_sell_units.size as pk_size, iv_mast.vprod_id as vprod_id, iv_mast.pk_upc as pk_upc, iv_gtin.gtin as it_gtin, iv_mast.brand as it_brand,  iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.unit as it_unit, iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, apvend.company1 as vend_name, apvend.supplr_no as supplier, ar_oeitm.ord_qty as order_qty from ar_oeitm 
                inner join ar_oehdr on ar_oeitm.refno = ar_oehdr.refno 
                inner join arcust on arcust.cust_id = ar_oehdr.cust_id 
                inner join iv_mast on ar_oeitm.product_id = iv_mast.product_id 
                inner join apvend on iv_mast.vend_id = apvend.vend_id 
                inner join iv_sell_units on ar_oeitm.product_id = iv_sell_units.product_id and ar_oeitm.price_unit = iv_sell_units.unit and ar_oeitm.bc = iv_sell_units.bc left join iv_gtin on ar_oeitm.product_id = iv_gtin.product_id 
                where ar_oehdr.cust_id like '%171155%' and oe_status <> 5 order by order_no, inv_line_no
select ar_oehdr.cust_id as cust_no,  ar_oehdr.shipto_no as shp_to_no, arcust.Company1 as cust_name, ar_oehdr.ord_date as ord_date, ar_oehdr.shp_date as ship_date, ar_oehdr.refno as order_no, ar_oeitm.item as inv_line_no, ar_oeitm.product_id, 
                iv_mast.pk_ctch_wt as has_ctch_wgt, ar_oeitm.descript as description, iv_sell_units.size as pk_size, iv_mast.vprod_id as vprod_id, iv_mast.pk_upc as pk_upc, iv_gtin.gtin as it_gtin, iv_mast.brand as it_brand,  iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.unit as it_unit, iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, apvend.company1 as vend_name, apvend.supplr_no as supplier, ar_oeitm.ord_qty as order_qty 
                from ar_oeitm 
                inner join ar_oehdr on ar_oeitm.refno = ar_oehdr.refno 
                inner join arcust on arcust.cust_id = ar_oehdr.cust_id 
                inner join iv_mast on ar_oeitm.product_id = iv_mast.product_id 
                inner join apvend on iv_mast.vend_id = apvend.vend_id 
                inner join iv_sell_units on ar_oeitm.product_id = iv_sell_units.product_id and ar_oeitm.price_unit = iv_sell_units.unit and ar_oeitm.bc = iv_sell_units.bc left join iv_gtin on ar_oeitm.product_id = iv_gtin.product_id 
                where ar_oehdr.cust_id like '%171155%' and oe_status <> 5 order by order_no, inv_line_no
select * from coremeta

select * from coremeta where cobjectnam like '%ctch_wt%'

SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt,  ar_ctitm.product_id as item_no, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_expiry as exp_dt, ar_ctitm.price as it_price, iv_mast.vprod_id as vprod_id, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, apvend.company1 as vend_name, iv_gtin.gtin as it_gtin  from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id = ?

SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt,  ar_ctitm.product_id as item_no, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_expiry as exp_dt, ar_ctitm.price as it_price, iv_mast.vprod_id as vprod_id, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, apvend.company1 as vend_name, iv_gtin.gtin as it_gtin  from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id = 171155
SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt,  ar_ctitm.product_id as item_no, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_expiry as exp_dt, ar_ctitm.price as it_price, iv_mast.vprod_id as vprod_id, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, apvend.company1 as vend_name, iv_gtin.gtin as it_gtin  from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like'%171155%'
SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt,  ar_ctitm.product_id as item_no, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_expiry as exp_dt, ar_ctitm.price as it_price, iv_mast.vprod_id as vprod_id, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, apvend.company1 as vend_name, iv_gtin.gtin as it_gtin  from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like'%17155%'
SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, 
                    ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt,  ar_ctitm.product_id as item_no, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_expiry as exp_dt, ar_ctitm.price as it_price,  
                iv_mast.pk_ctch_wt as has_ctch_wgt, iv_mast.vprod_id as vprod_id, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, apvend.company1 as vend_name, apvend.supplr_no as supplier, iv_gtin.gtin as it_gtin  
                    from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like'%17155%'

SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, 
                    ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt,  ar_ctitm.product_id as item_no, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_expiry as exp_dt, ar_ctitm.price as it_price,  
                iv_mast.pk_ctch_wt as has_ctch_wgt, iv_mast.vprod_id as vprod_id, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, apvend.company1 as vend_name, apvend.supplr_no as supplier, iv_gtin.gtin as it_gtin  
                    from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like'%171155%'

SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, 
                    ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt,  ar_ctitm.product_id as item_no, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_expiry as exp_dt, ar_ctitm.price as it_price,  
                iv_mast.pk_ctch_wt as has_ctch_wgt, iv_mast.vprod_id as vprod_id, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, apvend.company1 as vend_name, apvend.supplr_no as supplier, iv_gtin.gtin as it_gtin  
                    from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id = '17115'
SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, 
                    ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt,  ar_ctitm.product_id as item_no, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_expiry as exp_dt, ar_ctitm.price as it_price,  
                iv_mast.pk_ctch_wt as has_ctch_wgt, iv_mast.vprod_id as vprod_id, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, apvend.company1 as vend_name, apvend.supplr_no as supplier, iv_gtin.gtin as it_gtin  
                    from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like '17115'
SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, 
                    ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt,  ar_ctitm.product_id as item_no, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_expiry as exp_dt, ar_ctitm.price as it_price,  
                iv_mast.pk_ctch_wt as has_ctch_wgt, iv_mast.vprod_id as vprod_id, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, apvend.company1 as vend_name, apvend.supplr_no as supplier, iv_gtin.gtin as it_gtin  
                    from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like '%17115%'
select * from iv_sell_units where product_id like '%221335%'
SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt,  ar_ctitm.product_id as item_no, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_expiry as exp_dt, ar_ctitm.price as it_price, iv_mast.pk_ctch_wt as has_ctch_wgt, iv_mast.vprod_id as vprod_id, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.price_unit as price_unit, apvend.company1 as vend_name, apvend.supplr_no as supplier, iv_gtin.gtin as it_gtin from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like '%17115%'
select * from iv_sell_units where product_id like '%265688%'
select * from iv_mast where product_id like '%265688%'
select * from iv_sell_units where product_id like '%265688%'
select * from iv_mast where product_id like '%265688%'

select * from iv_sell_units where product_id like '%265688%'
SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt,  ar_ctitm.product_id as item_no, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_expiry as exp_dt, ar_ctitm.price as it_price, iv_mast.pk_ctch_wt as has_ctch_wgt, iv_mast.vprod_id as vprod_id, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.price_unit as price_unit, apvend.company1 as vend_name, apvend.supplr_no as supplier, iv_gtin.gtin as it_gtin from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like '%17115%'

select * from iv_mast where product_id like '%265688%'

select * from iv_sell_units where product_id like '%265688%'
SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt,  ar_ctitm.product_id as item_no, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_expiry as exp_dt, ar_ctitm.price as it_price, iv_mast.pk_ctch_wt as has_ctch_wgt, iv_mast.vprod_id as vprod_id, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.price_unit as price_unit, apvend.company1 as vend_name, apvend.supplr_no as supplier, iv_gtin.gtin as it_gtin from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like '%17115%'


select * from iv_mast where product_id like '%265688%'

select * from iv_sell_units where product_id like '%265688%'
SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt,  ar_ctitm.product_id as item_no, ar_ctitm.item as item1, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_expiry as exp_dt, ar_ctitm.price as it_price, iv_mast.pk_ctch_wt as has_ctch_wgt, iv_mast.vprod_id as vprod_id, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.price_unit as price_unit, apvend.company1 as vend_name, apvend.supplr_no as supplier, iv_gtin.gtin as it_gtin from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like '%17115%'


select * from iv_mast where product_id like '%265688%'

select * from iv_sell_units where product_id like '%265688%'
select * from iv_mast where product_id like '%265688%'

select * from iv_sell_units where product_id like '%265688%'

select * from ar_cthdr where contr_id like '%17115%'



select * from iv_mast where product_id like '%265688%'

select * from iv_sell_units where product_id like '%265688%'

select * from ar_cthdr where contr_id like '%17115%'

select * from ar_ctitm where refno = 72
select * from iv_mast where product_id like '%265688%'

select * from iv_sell_units where product_id like '%265688%'

select * from ar_cthdr where contr_id like '%17115%'

select * from ar_ctitm where refno = 72 and product_id like '%265688%'

apvend.supplr_no as supplier, iv_gtin.gtin as it_gtin from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc  
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like '%17115%'

vprod_id, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.price_unit as price_unit, apvend.company1 as vend_name, apvend.supplr_no as supplier, iv_gtin.gtin as it_gtin from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc  
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like '%17115%'

SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt,  ar_ctitm.product_id as item_no, ar_ctitm.item as item1, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_expiry as exp_dt, ar_ctitm.price as it_price, iv_mast.pk_ctch_wt as has_ctch_wgt, iv_mast.vprod_id as vprod_id, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.price_unit as price_unit, apvend.company1 as vend_name, apvend.supplr_no as supplier, iv_gtin.gtin as it_gtin from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc  
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like '%17115%'


select * from ar_ctitm where refno = 72 and product_id like '%265688%'

select * from iv_mast where product_id like '%265688%'

select * from iv_sell_units where product_id like '%265688%'

select * from ar_cthdr where contr_id like '%17115%'

select * from ar_ctitm where refno = 72 and product_id like '%265688%'

select * from iv_mast where product_id like '%265688%'

select * from iv_sell_units where product_id like '%265688%'

select * from ar_cthdr where contr_id like '%17115%'

select * from ar_ctitm where refno = 72 and product_id like '%265688%'

select * from coremeta 
select * from coremeta where cobjectnam like '%effect_dt%'
select * from iv_pchdr where refno = 1808

select * from iv_pchdr
select * from iv_pcitm
select neffect_dt from iv_mast


select neffect_dt from iv_mast


select * from coremeta where cobjectnam like '%effect_dt%'
select * from coremeta where cobjectnam like '%_dt%'
select * from coremeta where cobjectnam like '%effect%'
select * from iv_locat

select * from iv_mast where product_id like '%265688%'


select * from iv_mast where product_id like '%265688%'

select * from iv_sell_units where product_id like '%265688%'

select * from ar_cthdr where contr_id like '%17115%'

select * from ar_ctitm where refno = 72 and product_id like '%265688%'

select * from iv_mast where product_id like '%265688%'

select * from iv_sell_units where product_id like '%265688%'

select * from ar_cthdr where contr_id like '%17115%'

select * from ar_ctitm where refno = 72 and product_id like '%265688%'
select * from iv_mast where product_id like '%265688%'


select * from iv_sell_units where product_id like '%265688%'


select * from ar_cthdr where contr_id like '%17115%'


select * from ar_ctitm where refno = 72 and product_id like '%265688%'

SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, 
                    ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt, ar_cthdr.start_date as og_st_dt, ar_ctitm.product_id as item_no, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_effect as expiry_dt, ar_ctitm.price as it_price, iv_mast.pk_ctch_wt as has_ctch_wgt, iv_mast.vprod_id as vprod_id, .t. as primary_vendor_flag, not iv_mast.inactive and iv_mast.to_be_ord, 'S', 'A') as varchar(1)) as item_status_code, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.price_unit as price_unit, apvend.company1 as vend_name, apvend.supplr_no as supplier, iv_gtin.gtin as it_gtin  
                    from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like '%17115%'
select * from gl_brch

SELECT ar_cthdr.wh_locat as wh_locat, 
ar_cthdr.contr_id as contr_id, 
 ar_cthdr.descript as ogName, 
ar_cthdr.begin_date as og_gen_dt, 
ar_cthdr.start_date as og_st_dt, 
ar_ctitm.product_id as item_no,
 ar_ctitm.descript as it_desc, 
ar_ctitm.pk_unit as pk_unit,  
ar_ctitm.brand as it_brand,
 ar_ctitm.new_effect as effect_dt, 
ar_ctitm.new_effect as expiry_dt, 
ar_ctitm.price as it_price, 
iv_mast.pk_ctch_wt as has_ctch_wgt, 
iv_mast.vprod_id as vprod_id, 
.t. as primary_vendor_flag, 
not iv_mast.inactive and iv_mast.to_be_ord, 'S', 'A') as varchar(1)) as item_status_code, 
iv_mast.pk_upc as pk_upc, 
iv_mast.iv_class as it_class, 
iv_mast.vend_id as vend_id,
 iv_sell_units.size as pk_size,
 iv_sell_units.unit as it_unit, 
iv_sell_units.prod_wt as prod_wt, 
iv_sell_units.tare as tare,
iv_sell_units.price_unit as price_unit, 
apvend.company1 as vend_name, 
apvend.supplr_no as supplier, 
iv_gtin.gtin as it_gtin 
 from ar_ctitm 
inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
 inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
 inner join apvend on iv_mast.vend_id = apvend.vend_id 
 inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
WHERE ar_cthdr.contr_id like '%17115%'
select * from gl_brch

select * from gl_brch

SELECT ar_cthdr.wh_locat as wh_locat, 
ar_cthdr.contr_id as contr_id, 
 ar_cthdr.descript as ogName, 
ar_cthdr.begin_date as og_gen_dt, 
ar_cthdr.start_date as og_st_dt, 
ar_ctitm.product_id as item_no,
 ar_ctitm.descript as it_desc, 
ar_ctitm.pk_unit as pk_unit,  
ar_ctitm.brand as it_brand,
 ar_ctitm.new_effect as effect_dt, 
ar_ctitm.new_effect as expiry_dt, 
ar_ctitm.price as it_price, 
iv_mast.pk_ctch_wt as has_ctch_wgt, 
iv_mast.vprod_id as vprod_id, 
.t. as primary_vendor_flag, 
not iv_mast.inactive and iv_mast.to_be_ord, 'S', 'A') as varchar(1)) as item_status_code, 
iv_mast.pk_upc as pk_upc, 
iv_mast.iv_class as it_class, 
iv_mast.vend_id as vend_id,
 iv_sell_units.size as pk_size,
 iv_sell_units.unit as it_unit, 
iv_sell_units.prod_wt as prod_wt, 
iv_sell_units.tare as tare,
iv_sell_units.price_unit as price_unit, 
apvend.company1 as vend_name, 
apvend.supplr_no as supplier, 
iv_gtin.gtin as it_gtin 
 from ar_ctitm 
inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
 inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
 inner join apvend on iv_mast.vend_id = apvend.vend_id 
 inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
WHERE ar_cthdr.contr_id like '%17115%'
SELECT ar_cthdr.wh_locat as wh_locat, 
ar_cthdr.contr_id as contr_id, 
 ar_cthdr.descript as ogName, 
ar_cthdr.begin_date as og_gen_dt, 
ar_cthdr.start_date as og_st_dt, 
ar_ctitm.product_id as item_no,
 ar_ctitm.descript as it_desc, 
ar_ctitm.pk_unit as pk_unit,  
ar_ctitm.brand as it_brand,
 ar_ctitm.new_effect as effect_dt, 
ar_ctitm.new_effect as expiry_dt, 
ar_ctitm.price as it_price, 
iv_mast.pk_ctch_wt as has_ctch_wgt, 
iv_mast.vprod_id as vprod_id, 
.t. as primary_vendor_flag, 
cast(icase(iv_mast.inactive, "D", not iv_mast.inactive and iv_mast.to_be_ord, "S", "A") as varchar(1)) as item_status_code, 
iv_mast.pk_upc as pk_upc, 
iv_mast.iv_class as it_class, 
iv_mast.vend_id as vend_id,
 iv_sell_units.size as pk_size,
 iv_sell_units.unit as it_unit, 
iv_sell_units.prod_wt as prod_wt, 
iv_sell_units.tare as tare,
iv_sell_units.price_unit as price_unit, 
apvend.company1 as vend_name, 
apvend.supplr_no as supplier, 
iv_gtin.gtin as it_gtin 
 from ar_ctitm 
inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
 inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
 inner join apvend on iv_mast.vend_id = apvend.vend_id 
 inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
WHERE ar_cthdr.contr_id like '%17115%'
SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, 
                    ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt, ar_cthdr.start_date as og_st_dt, ar_ctitm.product_id as item_no, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_effect as expiry_dt, ar_ctitm.price as it_price,  iv_mast.pk_sell_un,
                iv_mast.pk_ctch_wt as has_ctch_wgt, iv_mast.vprod_id as vprod_id, .t. as primary_vendor_flag, cast(icase(iv_mast.inactive, 'D', not iv_mast.inactive and iv_mast.to_be_ord, 'S', 'A') as varchar(1)) as item_status_code, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.price_unit as price_unit, apvend.company1 as vend_name, apvend.supplr_no as supplier, iv_gtin.gtin as it_gtin,
                cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_qtyoh / iv_mast.pk_weight, iv_locat.pk_qtyoh) * 2.204621, 0) as integer) as cases_on_hand, cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_on_ord / iv_mast.pk_weight, iv_locat.pk_on_ord) * 2.204621, 0) as integer) as cases_on_order, cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_allocat / iv_mast.pk_weight, iv_locat.pk_allocat) * 2.204621, 0) as integer) as cases_sold from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like '%17115%'

SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, 
                    ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt, ar_cthdr.start_date as og_st_dt, ar_ctitm.product_id as item_no, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_effect as expiry_dt, ar_ctitm.price as it_price,  iv_mast.pk_sell_un,
                iv_mast.pk_ctch_wt as has_ctch_wgt, iv_mast.vprod_id as vprod_id, .t. as primary_vendor_flag, cast(icase(iv_mast.inactive, 'D', not iv_mast.inactive and iv_mast.to_be_ord, 'S', 'A') as varchar(1)) as item_status_code, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.price_unit as price_unit, apvend.company1 as vend_name, apvend.supplr_no as supplier, iv_gtin.gtin as it_gtin,
                cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_qtyoh / iv_mast.pk_weight, iv_locat.pk_qtyoh) * 2.204621, 0) as integer) as cases_on_hand, cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_on_ord / iv_mast.pk_weight, iv_locat.pk_on_ord) * 2.204621, 0) as integer) as cases_on_order, cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_allocat / iv_mast.pk_weight, iv_locat.pk_allocat) * 2.204621, 0) as integer) as cases_sold from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like '%17115%'
SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, 
                    ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt, ar_cthdr.start_date as og_st_dt, ar_ctitm.product_id as item_no, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_effect as expiry_dt, ar_ctitm.price as it_price,  iv_mast.pk_sell_un,
                iv_mast.pk_ctch_wt as has_ctch_wgt, iv_mast.vprod_id as vprod_id, .t. as primary_vendor_flag, cast(icase(iv_mast.inactive, 'D', not iv_mast.inactive and iv_mast.to_be_ord, 'S', 'A') as varchar(1)) as item_status_code, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.price_unit as price_unit, apvend.company1 as vend_name, apvend.supplr_no as supplier, iv_gtin.gtin as it_gtin,
                cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_qtyoh / iv_mast.pk_weight, iv_locat.pk_qtyoh) * 2.204621, 0) as integer) as cases_on_hand, cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_on_ord / iv_mast.pk_weight, iv_locat.pk_on_ord) * 2.204621, 0) as integer) as cases_on_order, cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_allocat / iv_mast.pk_weight, iv_locat.pk_allocat) * 2.204621, 0) as integer) as cases_sold from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like '%17115%'
SELECT ar_cthdr.wh_locat as wh_locat, 
ar_cthdr.contr_id as contr_id, 
 ar_cthdr.descript as ogName, 
ar_cthdr.begin_date as og_gen_dt, 
ar_cthdr.start_date as og_st_dt, 
ar_ctitm.product_id as item_no,
 ar_ctitm.descript as it_desc, 
ar_ctitm.pk_unit as pk_unit,  
ar_ctitm.brand as it_brand,
 ar_ctitm.new_effect as effect_dt, 
ar_ctitm.new_effect as expiry_dt, 
ar_ctitm.price as it_price, 
iv_mast.pk_ctch_wt as has_ctch_wgt, 
iv_mast.vprod_id as vprod_id, 
.t. as primary_vendor_flag, 
not iv_mast.inactive and iv_mast.to_be_ord, 'S', 'A') as varchar(1)) as item_status_code, 
iv_mast.pk_upc as pk_upc, 
iv_mast.iv_class as it_class, 
iv_mast.vend_id as vend_id,
 iv_sell_units.size as pk_size,
 iv_sell_units.unit as it_unit, 
iv_sell_units.prod_wt as prod_wt, 
iv_sell_units.tare as tare,
iv_sell_units.price_unit as price_unit, 
apvend.company1 as vend_name, 
apvend.supplr_no as supplier, 
iv_gtin.gtin as it_gtin 
 from ar_ctitm 
inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
 inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
 inner join apvend on iv_mast.vend_id = apvend.vend_id 
 inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
WHERE ar_cthdr.contr_id like '%17115%'
SELECT ar_cthdr.wh_locat as wh_locat, 
ar_cthdr.contr_id as contr_id, 
 ar_cthdr.descript as ogName, 
ar_cthdr.begin_date as og_gen_dt, 
ar_cthdr.start_date as og_st_dt, 
ar_ctitm.product_id as item_no,
 ar_ctitm.descript as it_desc, 
ar_ctitm.pk_unit as pk_unit,  
ar_ctitm.brand as it_brand,
 ar_ctitm.new_effect as effect_dt, 
ar_ctitm.new_effect as expiry_dt, 
ar_ctitm.price as it_price, 
iv_mast.pk_ctch_wt as has_ctch_wgt, 
iv_mast.vprod_id as vprod_id, 
.t. as primary_vendor_flag, 
not iv_mast.inactive and iv_mast.to_be_ord, 'S', 'A') as varchar(1)) as item_status_code, 
iv_mast.pk_upc as pk_upc, 
iv_mast.iv_class as it_class, 
iv_mast.vend_id as vend_id,
 iv_sell_units.size as pk_size,
 iv_sell_units.unit as it_unit, 
iv_sell_units.prod_wt as prod_wt, 
iv_sell_units.tare as tare,
iv_sell_units.price_unit as price_unit, 
apvend.company1 as vend_name, 
apvend.supplr_no as supplier, 
iv_gtin.gtin as it_gtin 
 from ar_ctitm 
inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
 inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
 inner join apvend on iv_mast.vend_id = apvend.vend_id 
 inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
WHERE ar_cthdr.contr_id like '%17115%'
SELECT ar_cthdr.wh_locat as wh_locat, 
ar_cthdr.contr_id as contr_id, 
 ar_cthdr.descript as ogName, 
ar_cthdr.begin_date as og_gen_dt, 
ar_cthdr.start_date as og_st_dt, 
ar_ctitm.product_id as item_no,
 ar_ctitm.descript as it_desc, 
ar_ctitm.pk_unit as pk_unit,  
ar_ctitm.brand as it_brand,
 ar_ctitm.new_effect as effect_dt, 
ar_ctitm.new_effect as expiry_dt, 
ar_ctitm.price as it_price, 
iv_mast.pk_ctch_wt as has_ctch_wgt, 
iv_mast.vprod_id as vprod_id, 
.t. as primary_vendor_flag, 
not iv_mast.inactive and iv_mast.to_be_ord, 'S', 'A') as varchar(1)) as item_status_code, 
iv_mast.pk_upc as pk_upc, 
iv_mast.iv_class as it_class, 
iv_mast.vend_id as vend_id,
 iv_sell_units.size as pk_size,
 iv_sell_units.unit as it_unit, 
iv_sell_units.prod_wt as prod_wt, 
iv_sell_units.tare as tare,
iv_sell_units.price_unit as price_unit, 
apvend.company1 as vend_name, 
apvend.supplr_no as supplier, 
iv_gtin.gtin as it_gtin 
 from ar_ctitm 
inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
 inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
 inner join apvend on iv_mast.vend_id = apvend.vend_id 
 inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
WHERE ar_cthdr.contr_id like '%17115%'
SELECT ar_cthdr.wh_locat as wh_locat, 
ar_cthdr.contr_id as contr_id, 
 ar_cthdr.descript as ogName, 
ar_cthdr.begin_date as og_gen_dt, 
ar_cthdr.start_date as og_st_dt, 
ar_ctitm.product_id as item_no,
 ar_ctitm.descript as it_desc, 
ar_ctitm.pk_unit as pk_unit,  
ar_ctitm.brand as it_brand,
 ar_ctitm.new_effect as effect_dt, 
ar_ctitm.new_effect as expiry_dt, 
ar_ctitm.price as it_price, 
iv_mast.pk_ctch_wt as has_ctch_wgt, 
iv_mast.vprod_id as vprod_id, 
.t. as primary_vendor_flag, 
not iv_mast.inactive and iv_mast.to_be_ord, 'S', 'A') as varchar(1)) as item_status_code, 
iv_mast.pk_upc as pk_upc, 
iv_mast.iv_class as it_class, 
iv_mast.vend_id as vend_id,
 iv_sell_units.size as pk_size,
 iv_sell_units.unit as it_unit, 
iv_sell_units.prod_wt as prod_wt, 
iv_sell_units.tare as tare,
iv_sell_units.price_unit as price_unit, 
apvend.company1 as vend_name, 
apvend.supplr_no as supplier, 
iv_gtin.gtin as it_gtin 
 from ar_ctitm 
inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
 inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
 inner join apvend on iv_mast.vend_id = apvend.vend_id 
 inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
WHERE ar_cthdr.contr_id like '%17115%'
SELECT ar_cthdr.wh_locat as wh_locat,
 ar_cthdr.contr_id as contr_id, 
                    ar_cthdr.descript as ogName, 
ar_cthdr.begin_date as og_gen_dt, 
ar_cthdr.start_date as og_st_dt, 
ar_ctitm.product_id as item_no, 
ar_ctitm.descript as it_desc, 
ar_ctitm.pk_unit as pk_unit,  
ar_ctitm.brand as it_brand,
 ar_ctitm.new_effect as effect_dt, 
ar_ctitm.new_effect as expiry_dt, 
ar_ctitm.price as it_price, 
 iv_mast.pk_sell_un,
                iv_mast.pk_ctch_wt as has_ctch_wgt, 
iv_mast.vprod_id as vprod_id, 
.t. as primary_vendor_flag, 
cast(icase(iv_mast.inactive, 'D', not iv_mast.inactive and iv_mast.to_be_ord, 'S', 'A') as varchar(1)) as item_status_code, 
cast(round(iif(iv_mast.pk_sell_un = "KG", iv_locat.pk_qtyoh / iv_mast.pk_weight, iv_locat.pk_qtyoh) * 2.204621, 0) as integer) as cases_on_hand, 
iv_mast.pk_upc as pk_upc, 
iv_mast.iv_class as it_class,
 iv_mast.vend_id as vend_id,
 iv_sell_units.size as pk_size, 
iv_sell_units.unit as it_unit, 
iv_sell_units.prod_wt as prod_wt, 
iv_sell_units.tare as tare, 
iv_sell_units.price_unit as price_unit, 
apvend.company1 as vend_name,
 apvend.supplr_no as supplier, 
iv_gtin.gtin as it_gtin
 from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                   inner join iv_locat on iv_locat.refno = iv_mast.refno 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like '%17115%'
SELECT ar_cthdr.wh_locat as wh_locat,
 ar_cthdr.contr_id as contr_id, 
                    ar_cthdr.descript as ogName, 
ar_cthdr.begin_date as og_gen_dt, 
ar_cthdr.start_date as og_st_dt, 
ar_ctitm.product_id as item_no, 
ar_ctitm.descript as it_desc, 
ar_ctitm.pk_unit as pk_unit,  
ar_ctitm.brand as it_brand,
 ar_ctitm.new_effect as effect_dt, 
ar_ctitm.new_effect as expiry_dt, 
ar_ctitm.price as it_price, 
 iv_mast.pk_sell_un,
                iv_mast.pk_ctch_wt as has_ctch_wgt, 
iv_mast.vprod_id as vprod_id, 
.t. as primary_vendor_flag, 
cast(icase(iv_mast.inactive, 'D', not iv_mast.inactive and iv_mast.to_be_ord, 'S', 'A') as varchar(1)) as item_status_code, 
cast(round(iif(iv_mast.pk_sell_un = "KG", iv_locat.pk_qtyoh / iv_mast.pk_weight, iv_locat.pk_qtyoh) * 2.204621, 0) as integer) as cases_on_hand, 
cast(round(iif(iv_mast.pk_sell_un = "KG", iv_locat.pk_on_ord / iv_mast.pk_weight, iv_locat.pk_on_ord) * 2.204621, 0) as integer) as cases_on_order,
cast(round(iif(iv_mast.pk_sell_un = "KG", iv_locat.pk_allocat / iv_mast.pk_weight, iv_locat.pk_allocat) * 2.204621, 0) as integer) as cases_sold, 
iv_mast.pk_upc as pk_upc, 
iv_mast.iv_class as it_class,
 iv_mast.vend_id as vend_id,
 iv_sell_units.size as pk_size, 
iv_sell_units.unit as it_unit, 
iv_sell_units.prod_wt as prod_wt, 
iv_sell_units.tare as tare, 
iv_sell_units.price_unit as price_unit, 
apvend.company1 as vend_name,
 apvend.supplr_no as supplier, 
iv_gtin.gtin as it_gtin
 from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                   inner join iv_locat on iv_locat.refno = iv_mast.refno 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like '%17115%'
SELECT ar_cthdr.wh_locat as wh_locat,
 ar_cthdr.contr_id as contr_id, 
                    ar_cthdr.descript as ogName, 
ar_cthdr.begin_date as og_gen_dt, 
ar_cthdr.start_date as og_st_dt, 
ar_ctitm.product_id as item_no, 
ar_ctitm.descript as it_desc, 
ar_ctitm.pk_unit as pk_unit,  
ar_ctitm.brand as it_brand,
 ar_ctitm.new_effect as effect_dt, 
ar_ctitm.new_effect as expiry_dt, 
ar_ctitm.price as it_price, 
 iv_mast.pk_sell_un,
                iv_mast.pk_ctch_wt as has_ctch_wgt, 
iv_mast.vprod_id as vprod_id, 
.t. as primary_vendor_flag, 
cast(icase(iv_mast.inactive, 'D', not iv_mast.inactive and iv_mast.to_be_ord, 'S', 'A') as varchar(1)) as item_status_code, 
cast(round(iif(iv_mast.pk_sell_un = "KG", iv_locat.pk_qtyoh / iv_mast.pk_weight, iv_locat.pk_qtyoh) * 2.204621, 0) as integer) as cases_on_hand, 
cast(round(iif(iv_mast.pk_sell_un = "KG", iv_locat.pk_on_ord / iv_mast.pk_weight, iv_locat.pk_on_ord) * 2.204621, 0) as integer) as cases_on_order,
cast(round(iif(iv_mast.pk_sell_un = "KG", iv_locat.pk_allocat / iv_mast.pk_weight, iv_locat.pk_allocat) * 2.204621, 0) as integer) as cases_sold, 
iv_mast.pk_upc as pk_upc, 
iv_mast.iv_class as it_class,
 iv_mast.vend_id as vend_id,
 iv_sell_units.size as pk_size, 
iv_sell_units.unit as it_unit, 
iv_sell_units.prod_wt as prod_wt, 
iv_sell_units.tare as tare, 
iv_sell_units.price_unit as price_unit, 
apvend.company1 as vend_name,
 apvend.supplr_no as supplier, 
iv_gtin.gtin as it_gtin
 from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                   inner join iv_locat on iv_locat.refno = iv_mast.refno 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like '%17115%'
SELECT ar_cthdr.wh_locat as wh_locat,
 ar_cthdr.contr_id as contr_id, 
                    ar_cthdr.descript as ogName, 
ar_cthdr.begin_date as og_gen_dt, 
ar_cthdr.start_date as og_st_dt, 
ar_ctitm.product_id as item_no, 
ar_ctitm.descript as it_desc, 
ar_ctitm.pk_unit as pk_unit,  
ar_ctitm.brand as it_brand,
 ar_ctitm.new_effect as effect_dt, 
ar_ctitm.new_effect as expiry_dt, 
ar_ctitm.price as it_price, 
 iv_mast.pk_sell_un,
                iv_mast.pk_ctch_wt as has_ctch_wgt, 
iv_mast.vprod_id as vprod_id, 
.t. as primary_vendor_flag, 
cast(icase(iv_mast.inactive, 'D', not iv_mast.inactive and iv_mast.to_be_ord, 'S', 'A') as varchar(1)) as item_status_code, 
cast(round(iif(iv_mast.pk_sell_un = "KG", iv_locat.pk_qtyoh / iv_mast.pk_weight, iv_locat.pk_qtyoh) * 2.204621, 0) as integer) as cases_on_hand, 
cast(round(iif(iv_mast.pk_sell_un = "KG", iv_locat.pk_on_ord / iv_mast.pk_weight, iv_locat.pk_on_ord) * 2.204621, 0) as integer) as cases_on_order,
cast(round(iif(iv_mast.pk_sell_un = "KG", iv_locat.pk_allocat / iv_mast.pk_weight, iv_locat.pk_allocat) * 2.204621, 0) as integer) as cases_sold, 
iv_mast.pk_upc as pk_upc, 
iv_mast.iv_class as it_class,
 iv_mast.vend_id as vend_id,
 iv_sell_units.size as pk_size, 
iv_sell_units.unit as it_unit, 
iv_sell_units.prod_wt as prod_wt, 
iv_sell_units.tare as tare, 
iv_sell_units.price_unit as price_unit, 
apvend.company1 as vend_name,
 apvend.supplr_no as supplier, 
iv_gtin.gtin as it_gtin
 from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                   inner join iv_locat on iv_locat.refno = iv_mast.refno 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like '%17115%'

SELECT ar_cthdr.wh_locat as wh_locat,
 ar_cthdr.contr_id as contr_id, 
                    ar_cthdr.descript as ogName, 
ar_cthdr.begin_date as og_gen_dt, 
ar_cthdr.start_date as og_st_dt, 
ar_ctitm.product_id as item_no, 
ar_ctitm.descript as it_desc, 
ar_ctitm.pk_unit as pk_unit,  
ar_ctitm.brand as it_brand,
 ar_ctitm.new_effect as effect_dt, 
ar_ctitm.new_effect as expiry_dt, 
ar_ctitm.price as it_price, 
 iv_mast.pk_sell_un,
                iv_mast.pk_ctch_wt as has_ctch_wgt, 
iv_mast.vprod_id as vprod_id, 
.t. as primary_vendor_flag, 
cast(icase(iv_mast.inactive, 'D', not iv_mast.inactive and iv_mast.to_be_ord, 'S', 'A') as varchar(1)) as item_status_code, 
cast(round(iif(iv_mast.pk_sell_un = "KG", iv_locat.pk_qtyoh / iv_mast.pk_weight, iv_locat.pk_qtyoh) * 2.204621, 0) as integer) as cases_on_hand, 
cast(round(iif(iv_mast.pk_sell_un = "KG", iv_locat.pk_on_ord / iv_mast.pk_weight, iv_locat.pk_on_ord) * 2.204621, 0) as integer) as cases_on_order,
cast(round(iif(iv_mast.pk_sell_un = "KG", iv_locat.pk_allocat / iv_mast.pk_weight, iv_locat.pk_allocat) * 2.204621, 0) as integer) as cases_sold, 
iv_mast.pk_upc as pk_upc, 
iv_mast.iv_class as it_class,
 iv_mast.vend_id as vend_id,
 iv_sell_units.size as pk_size, 
iv_sell_units.unit as it_unit, 
iv_sell_units.prod_wt as prod_wt, 
iv_sell_units.tare as tare, 
iv_sell_units.price_unit as price_unit, 
apvend.company1 as vend_name,
 apvend.supplr_no as supplier, 
iv_gtin.gtin as it_gtin
 from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                   inner join iv_locat on iv_locat.refno = iv_mast.refno 
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like '%17115%'
select * frpm ap_pohdr

select * from ap_pohdr

Select * from ap_pohdr where oe_pono like '%17115%'

Select * from ap_pohdr where oe_pono like '%ch%'

Select * from ap_pohdr where oe_pono like '%CH%'

select disintct po_type from ap_pohdr

select distinct po_type from ap_pohdr

Select * from ap_pohdr where pono like '%109762%'

Select * from ap_pohdr

Select * from ap_pohdr where pono like '109762'

Select * from ap_pohdr where pono = '109762'

Select * from ap_pohdr where pono = '81278'

Select * from ap_pohdr where pono = '109762'


Select * from ap_pohdr where pono = '109758'

Select * from ap_pohdr where pono = '109757'

Select * from ap_pohdr where pono = '109756'

select * from ap_poitm where refno = 573171

Select * from ap_pohdr where pono = '109756'

select * from ap_poitm where refno = 573171

Select * from ap_pohdr where pono = '109756'

select * from ap_poitm where refno = 573171

Select * from ap_pohdr where pono = '109756'

select * from ap_poitm where refno = 573171


Select * from ap_pohdr where pono = '109756'

select * from ap_poitm where refno = 573171

Select * from ap_pohdr where pono = '109756'

select * from ap_poitm where refno = 573171

select * from iv_mast where refno = 573171

select * from iv_mast where product_id like '%592778%'

select ap_pohdr.pono from ap_pohdr

select ap_pohdr.pono, ap_pohdr.vend_id from ap_pohdr

select ap_pohdr.pono, ap_pohdr.vend_id,
 left(ttoc(ap_pohdr.date, 1), 8) as po_creation_date, 
 left(ttoc(ap_pohdr.req_date, 1), 8) as po_schedule_receipt_date, 
 left(ttoc(ap_pohdr.req_date, 1), 8) as po_actual_receipt_date, 
 cast("" as varchar(2)) as transportation_code 
 from ap_pohdr


select ap_pohdr.pono, ap_pohdr.vend_id,
 left(ttoc(ap_pohdr.date, 1), 8) as po_creation_date, 
 ap_pohdr.date, 
 left(ttoc(ap_pohdr.req_date, 1), 8) as po_schedule_receipt_date, 
 left(ttoc(ap_pohdr.req_date, 1), 8) as po_actual_receipt_date, 
 cast("" as varchar(2)) as transportation_code 
 from ap_pohdr


select ap_pohdr.pono, ap_pohdr.vend_id,
 ap_pohdr.date as po_creation_date, 
 ap_pohdr.req_date as po_schedule_receipt_date, 
 ap_pohdr.req_date as po_actual_receipt_date, 
 cast("" as varchar(2)) as transportation_code 
 from ap_pohdr


select ap_pohdr.pono, 
 ap_pohdr.vend_id,
 ap_pohdr.supplr_no,
 ap_pohdr.date as po_creation_date, 
 ap_pohdr.req_date as po_schedule_receipt_date, 
 ap_pohdr.req_date as po_actual_receipt_date, 
 cast("" as varchar(2)) as transportation_code 
 from ap_pohdr

select ap_pohdr.pono, 
 ap_pohdr.vend_id,
 ap_pohdr.supplr_no,
 ap_pohdr.date as po_creation_date, 
 ap_pohdr.req_date as po_schedule_receipt_date, 
 ap_pohdr.req_date as po_actual_receipt_date, 
 cast("" as varchar(2)) as transportation_code 
 from ap_pohdr


select 
   ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,
   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
   ap_pohdr.req_date as po_actual_receipt_date,
   cast("" as varchar(2)) as transportation_code,
   apvend.company1 as vendor_name, 
   apsupplr.company1 as vendor_pickup_warehouse_name, 
   apsupplr.address1 as vendor_pickup_warehouse_address1,  
   apsupplr.address2 as vendor_pickup_warehouse_address2,   
   apsupplr.city as vendor_pickup_warehouse_city,      
   apsupplr.province as vendor_pickup_warehouse_state, 
   apsupplr.postcode as vendor_pickup_warehouse_zip  
 from ap_pohdr 
   inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id  
   inner join apsupplr on apsupplr.refno = apvend.refno
Select * from ap_pohdr where pono = '109756'

select * from ap_poitm where refno = 573171

select * from iv_mast where refno = 573171

select * from iv_mast where product_id like '%592778%'

Select * from ap_pohdr where pono = '109756'

select * from ap_poitm where refno = 573171

select * from iv_mast where refno = 573171

select * from iv_mast where product_id like '%592778%'
Select * from ap_pohdr where pono = '109756'

select * from ap_poitm where refno = 573171

select * from iv_mast where product_id like '%592778%'

select 
   ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,
   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
   ap_pohdr.req_date as po_actual_receipt_date,
   cast("" as varchar(2)) as transportation_code,
   apvend.company1 as vendor_name,
 
   apsupplr.company1 as vendor_pickup_warehouse_name,
 
   apsupplr.address1 as vendor_pickup_warehouse_address1,
  
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   
   apsupplr.city as vendor_pickup_warehouse_city,
      
   apsupplr.province as vendor_pickup_warehouse_state,
 
   apsupplr.postcode as vendor_pickup_warehouse_zip  
 from ap_pohdr 
   inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id  
   inner join apsupplr on apsupplr.refno = apvend.refno 
where  pono = '109756';
select 
   ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,
   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
   ap_pohdr.req_date as po_actual_receipt_date,
   cast("" as varchar(2)) as transportation_code,
   apvend.company1 as vendor_name,
 
   apsupplr.company1 as vendor_pickup_warehouse_name,
 
   apsupplr.address1 as vendor_pickup_warehouse_address1,
  
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   
   apsupplr.city as vendor_pickup_warehouse_city,
      
   apsupplr.province as vendor_pickup_warehouse_state,
 
   apsupplr.postcode as vendor_pickup_warehouse_zip  
 from ap_poitm
   inner join  ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
   inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id  
   inner join apsupplr on apsupplr.refno = apvend.refno 
where  product_id like '%592778%';
select 
   ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,
   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
   ap_pohdr.req_date as po_actual_receipt_date,
   cast("" as varchar(2)) as transportation_code,
   apvend.company1 as vendor_name,
 
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
   apsupplr.province as vendor_pickup_warehouse_state,
   apsupplr.postcode as vendor_pickup_warehouse_zip,

    ap_poitm.product_id as item_number,
    iv_mast.descript as item_description_long,
    iv_mast.pk_size as item_pack_size, 
    iv_mast.vprod_id as vprod_id,
    iv_mast.brand as item_brand_name   
 from ap_poitm 
inner join  ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
   inner join iv_mast on iv_mast.product_id = ap_poitm.product_id  
   inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id   
   inner join apsupplr on apsupplr.refno = apvend.refno   
where  ap_poitm.product_id like '%592778%';
select 
   ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,
   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
   ap_pohdr.req_date as po_actual_receipt_date,
   cast("" as varchar(2)) as transportation_code,
   apvend.company1 as vendor_name,
 
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
   apsupplr.province as vendor_pickup_warehouse_state,
   apsupplr.postcode as vendor_pickup_warehouse_zip,

    ap_poitm.product_id as item_number,
    iv_mast.descript as item_description_long,
    iv_mast.pk_size as item_pack_size,

     cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case, 
     cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight, 
     cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight, 
     icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure, 
 
    iv_mast.vprod_id as vprod_id,
    iv_mast.brand as item_brand_name   
 from ap_poitm 
inner join  ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
   inner join iv_mast on iv_mast.product_id = ap_poitm.product_id  
   inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id   
   inner join apsupplr on apsupplr.refno = apvend.refno   
where  ap_poitm.product_id like '%592778%';
select 
   ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,
   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
   ap_pohdr.req_date as po_actual_receipt_date,
   cast("" as varchar(2)) as transportation_code,
   apvend.company1 as vendor_name,
 
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
   apsupplr.province as vendor_pickup_warehouse_state,
   apsupplr.postcode as vendor_pickup_warehouse_zip,

    ap_poitm.product_id as item_number,
    iv_mast.descript as item_description_long,
    iv_mast.pk_size as item_pack_size,

   cast(nvl(icase(rtrim(iv_type.descript) = "DRY", "D", rtrim(iv_type.descript) = "FROZEN", "F", rtrim(iv_type.descript) = "FRESH", "R", ""), "") as varchar(1)) as temperature_protection_code,


     cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case, 
     cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight, 
     cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight, 
     icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure, 
 
    iv_mast.vprod_id as vprod_id,
    iv_mast.brand as item_brand_name   
   
  from ap_poitm  
   
   inner join  ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
   inner join iv_mast on iv_mast.product_id = ap_poitm.product_id  
   inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id   
   inner join apsupplr on apsupplr.refno = apvend.refno   
   left join iv_type on iv_type.iv_type = iv_mast.iv_type 
   where  ap_poitm.product_id like '%592778%';
select 
   ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,
   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
   ap_pohdr.req_date as po_actual_receipt_date,
   cast("" as varchar(2)) as transportation_code,
   apvend.company1 as vendor_name,
 
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
   apsupplr.province as vendor_pickup_warehouse_state,
   apsupplr.postcode as vendor_pickup_warehouse_zip,

    ap_poitm.product_id as item_number,
    iv_mast.descript as item_description_long,
    iv_mast.pk_size as item_pack_size,

     cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case, 
     cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight, 
     cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight, 
     icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure, 
 
    iv_mast.vprod_id as vprod_id,
    iv_mast.brand as item_brand_name   
 from ap_poitm 
inner join  ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
   inner join iv_mast on iv_mast.product_id = ap_poitm.product_id  
   inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id   
   inner join apsupplr on apsupplr.refno = apvend.refno   
where  ap_poitm.product_id like '%592778%';
select 
   ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,
   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
   ap_pohdr.req_date as po_actual_receipt_date,
   cast("" as varchar(2)) as transportation_code,
   apvend.company1 as vendor_name,
 
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
   apsupplr.province as vendor_pickup_warehouse_state,
   apsupplr.postcode as vendor_pickup_warehouse_zip,

    ap_poitm.product_id as item_number,
    iv_mast.descript as item_description_long,
    iv_mast.pk_size as item_pack_size,
    iv_mast.iv_class as it_class,

     cast(icase(iv_mast.bc_factor <> 0,
 int(iv_mast.bc_factor),
 1) as integer) as units_per_case,
 
     cast(round(iif(iv_mast.pk_tare_wt <> 0,
 (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621,
 0),
 4) as numeric(9,
 4)) as gross_case_weight,
 
     cast(round(iif(iv_mast.pk_tare_wt <> 0,
 0,
 iv_mast.pk_weight * 2.204621),
 4) as numeric(9,
 4)) as net_case_weight,
 
     icase(iv_mast.pk_sell_un = "KG",
 "LB",
 iv_mast.pk_sell_un) as stocking_unit_of_measure,
 
 
    iv_mast.vprod_id as vprod_id,
    iv_mast.brand as item_brand_name   
 from ap_poitm 
inner join  ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
   inner join iv_mast on iv_mast.product_id = ap_poitm.product_id  
   inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id   
   inner join apsupplr on apsupplr.refno = apvend.refno   
where  ap_poitm.product_id like '%592778%';
select 
   ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,
   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
   ap_pohdr.req_date as po_actual_receipt_date,
   cast("" as varchar(2)) as transportation_code,
   apvend.company1 as vendor_name,
 
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
   apsupplr.province as vendor_pickup_warehouse_state,
   apsupplr.postcode as vendor_pickup_warehouse_zip,

    ap_poitm.product_id as item_number,
    iv_mast.descript as item_description_long,
    iv_mast.pk_size as item_pack_size,
    iv_mast.iv_class as it_class,
    iv_mast.pk_upc as pk_upc,

     cast(icase(iv_mast.bc_factor <> 0,
 int(iv_mast.bc_factor),
 1) as integer) as units_per_case,
 
     cast(round(iif(iv_mast.pk_tare_wt <> 0,
 (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621,
 0),
 4) as numeric(9,
 4)) as gross_case_weight,
 
     cast(round(iif(iv_mast.pk_tare_wt <> 0,
 0,
 iv_mast.pk_weight * 2.204621),
 4) as numeric(9,
 4)) as net_case_weight,
 
     icase(iv_mast.pk_sell_un = "KG",
 "LB",
 iv_mast.pk_sell_un) as stocking_unit_of_measure,
 
 
    iv_mast.vprod_id as vprod_id,
    iv_mast.brand as item_brand_name   
 from ap_poitm 
inner join  ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
   inner join iv_mast on iv_mast.product_id = ap_poitm.product_id  
   inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id   
   inner join apsupplr on apsupplr.refno = apvend.refno   
where  ap_poitm.product_id like '%592778%';
select 
   ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,
   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
   ap_pohdr.req_date as po_actual_receipt_date,
   cast("" as varchar(2)) as transportation_code,
   apvend.company1 as vendor_name,
 
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
   apsupplr.province as vendor_pickup_warehouse_state,
   apsupplr.postcode as vendor_pickup_warehouse_zip,

    ap_poitm.product_id as item_number,
    iv_mast.descript as item_description_long,
    iv_mast.pk_size as item_pack_size,
    iv_mast.iv_class as it_class,
    iv_mast.pk_upc as pk_upc,
    iv_gtin.gtin as it_gtin,


     cast(icase(iv_mast.bc_factor <> 0,
 int(iv_mast.bc_factor),
 1) as integer) as units_per_case,
 
     cast(round(iif(iv_mast.pk_tare_wt <> 0,
 (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621,
 0),
 4) as numeric(9,
 4)) as gross_case_weight,
 
     cast(round(iif(iv_mast.pk_tare_wt <> 0,
 0,
 iv_mast.pk_weight * 2.204621),
 4) as numeric(9,
 4)) as net_case_weight,
 
     icase(iv_mast.pk_sell_un = "KG",
 "LB",
 iv_mast.pk_sell_un) as stocking_unit_of_measure,
 
 
    iv_mast.vprod_id as vprod_id,
    iv_mast.brand as item_brand_name   
 from ap_poitm 
inner join  ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
   inner join iv_mast on iv_mast.product_id = ap_poitm.product_id  
   inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id   
   inner join apsupplr on apsupplr.refno = apvend.refno   
left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id  
where  ap_poitm.product_id like '%592778%';
select 
   ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,
   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
   ap_pohdr.req_date as po_actual_receipt_date,
   cast("" as varchar(2)) as transportation_code,
   apvend.company1 as vendor_name,
 
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
   apsupplr.province as vendor_pickup_warehouse_state,
   apsupplr.postcode as vendor_pickup_warehouse_zip,

    ap_poitm.product_id as item_number,
    iv_mast.descript as item_description_long,
    iv_mast.pk_size as item_pack_size,
    iv_mast.iv_class as it_class,
    iv_mast.pk_upc as pk_upc,
    iv_gtin.gtin as it_gtin,

     cast(icase(iv_mast.bc_factor <> 0,
 int(iv_mast.bc_factor),
 1) as integer) as units_per_case,
 
     cast(round(iif(iv_mast.pk_tare_wt <> 0,
 (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621,
 0),
 4) as numeric(9,
 4)) as gross_case_weight,
 
     cast(round(iif(iv_mast.pk_tare_wt <> 0,
 0,
 iv_mast.pk_weight * 2.204621),
 4) as numeric(9,
 4)) as net_case_weight,
 
     icase(iv_mast.pk_sell_un = "KG",
 "LB",
 iv_mast.pk_sell_un) as stocking_unit_of_measure,
 
     cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
     cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, 
     cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube, 

 
    iv_mast.vprod_id as vprod_id,
    iv_mast.brand as item_brand_name   
 from ap_poitm 
inner join  ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
   inner join iv_mast on iv_mast.product_id = ap_poitm.product_id  
   inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id   
   inner join apsupplr on apsupplr.refno = apvend.refno   
left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id  
where  ap_poitm.product_id like '%592778%';
select 
   ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,
   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
   ap_pohdr.req_date as po_actual_receipt_date,
   cast("" as varchar(2)) as transportation_code,
   apvend.company1 as vendor_name,
 
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
   apsupplr.province as vendor_pickup_warehouse_state,
   apsupplr.postcode as vendor_pickup_warehouse_zip,

    ap_poitm.product_id as item_number,
    iv_mast.descript as item_description_long,
    iv_mast.pk_size as item_pack_size,
    iv_mast.iv_class as it_class,
    iv_mast.pk_upc as pk_upc,
    iv_gtin.gtin as it_gtin,

    cast(round(iif(ap_poitm.ord_unit = "KG", (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantity, 
    cast(round(iif(ap_poitm.ord_unit = "KG", (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity, 
    cast(0 as integer) as po_cancelled_quantity, 
    cast(ap_poitm.amount as numeric(9, 4)) as product_price, 

     cast(icase(iv_mast.bc_factor <> 0,
 int(iv_mast.bc_factor),
 1) as integer) as units_per_case,
 
     cast(round(iif(iv_mast.pk_tare_wt <> 0,
 (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621,
 0),
 4) as numeric(9,
 4)) as gross_case_weight,
 
     cast(round(iif(iv_mast.pk_tare_wt <> 0,
 0,
 iv_mast.pk_weight * 2.204621),
 4) as numeric(9,
 4)) as net_case_weight,
 
     icase(iv_mast.pk_sell_un = "KG",
 "LB",
 iv_mast.pk_sell_un) as stocking_unit_of_measure,
 
     cast(round(iif(iv_mast.pk_ctch_wt,
 ap_poitm.ord_qty_lb,
 0),
 0) as integer) as po_catch_weight,
 
     cast(round(iif(ap_pohdr.lb_prefer,
 ap_pohdr.wt_total,
 ap_pohdr.wt_total * 2.204621),
 0) as integer) as po_total_weight,
 
     cast(round(ap_pohdr.cube_total * 3.2808399,
 0) as integer) as po_total_cube,
  
    iv_mast.vprod_id as vprod_id,
    iv_mast.brand as item_brand_name   
 from ap_poitm 
inner join  ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
   inner join iv_mast on iv_mast.product_id = ap_poitm.product_id  
   inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id   
   inner join apsupplr on apsupplr.refno = apvend.refno   
left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id  
where  ap_poitm.product_id like '%592778%';
select 
   ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,
   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
   ap_pohdr.req_date as po_actual_receipt_date,
   cast("" as varchar(2)) as transportation_code,
   apvend.company1 as vendor_name,
 
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
   apsupplr.province as vendor_pickup_warehouse_state,
   apsupplr.postcode as vendor_pickup_warehouse_zip,

    ap_poitm.product_id as item_number,
    iv_mast.descript as item_description_long,
    iv_mast.pk_size as item_pack_size,
    iv_mast.iv_class as it_class,
    iv_mast.pk_upc as pk_upc,
    iv_gtin.gtin as it_gtin,

    cast(round(iif(ap_poitm.ord_unit = "KG",
 (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621,
 ap_poitm.ord_qty),
 0) as integer) as po_order_quantity,
 
    cast(round(iif(ap_poitm.ord_unit = "KG", (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity, 
     cast(0 as integer) as po_cancelled_quantity,
     cast(ap_poitm.amount as numeric(9, 4)) as product_price,
     cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
     cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, 
     cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,

 
     cast(icase(iv_mast.bc_factor <> 0,
 int(iv_mast.bc_factor),
 1) as integer) as units_per_case,
 
     cast(round(iif(iv_mast.pk_tare_wt <> 0,
 (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621,
 0),
 4) as numeric(9,
 4)) as gross_case_weight,
 
     cast(round(iif(iv_mast.pk_tare_wt <> 0,
 0,
 iv_mast.pk_weight * 2.204621),
 4) as numeric(9,
 4)) as net_case_weight,
 
     icase(iv_mast.pk_sell_un = "KG",
 "LB",
 iv_mast.pk_sell_un) as stocking_unit_of_measure,
 
     cast(round(iif(iv_mast.pk_ctch_wt,
 ap_poitm.ord_qty_lb,
 0),
 0) as integer) as po_catch_weight,
 
     cast(round(iif(ap_pohdr.lb_prefer,
 ap_pohdr.wt_total,
 ap_pohdr.wt_total * 2.204621),
 0) as integer) as po_total_weight,
 
     cast(round(ap_pohdr.cube_total * 3.2808399,
 0) as integer) as po_total_cube,
  
    iv_mast.vprod_id as vprod_id,
    iv_mast.brand as item_brand_name   
 from ap_poitm 
inner join  ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
   inner join iv_mast on iv_mast.product_id = ap_poitm.product_id  
   inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id   
   inner join apsupplr on apsupplr.refno = apvend.refno   
left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id  
where  ap_poitm.product_id like '%592778%';
select 
   ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,
   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
   ap_pohdr.req_date as po_actual_receipt_date,
   cast("" as varchar(2)) as transportation_code,
   apvend.company1 as vendor_name,
 
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
   apsupplr.province as vendor_pickup_warehouse_state,
   apsupplr.postcode as vendor_pickup_warehouse_zip,

    ap_poitm.product_id as item_number,
    iv_mast.descript as item_description_long,
    iv_mast.pk_size as item_pack_size,
    iv_mast.iv_class as it_class,
    iv_mast.pk_upc as pk_upc,
    iv_gtin.gtin as it_gtin,

    cast(round(iif(ap_poitm.ord_unit = "KG",
 (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621,
 ap_poitm.ord_qty),
 0) as integer) as po_order_quantity,
 
    cast(round(iif(ap_poitm.ord_unit = "KG", (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity, 
     cast(0 as integer) as po_cancelled_quantity,
     cast(ap_poitm.amount as numeric(9, 4)) as product_price,
     cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
     cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, 
     cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,

 
     cast(icase(iv_mast.bc_factor <> 0,
 int(iv_mast.bc_factor),
 1) as integer) as units_per_case,
 
     cast(round(iif(iv_mast.pk_tare_wt <> 0,
 (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621,
 0),
 4) as numeric(9,
 4)) as gross_case_weight,
 
     cast(round(iif(iv_mast.pk_tare_wt <> 0,
 0,
 iv_mast.pk_weight * 2.204621),
 4) as numeric(9,
 4)) as net_case_weight,
 
     icase(iv_mast.pk_sell_un = "KG",
 "LB",
 iv_mast.pk_sell_un) as stocking_unit_of_measure,
 
     cast(round(iif(iv_mast.pk_ctch_wt,
 ap_poitm.ord_qty_lb,
 0),
 0) as integer) as po_catch_weight,
 
     cast(round(iif(ap_pohdr.lb_prefer,
 ap_pohdr.wt_total,
 ap_pohdr.wt_total * 2.204621),
 0) as integer) as po_total_weight,
 
     cast(round(ap_pohdr.cube_total * 3.2808399,
 0) as integer) as po_total_cube,
  
    iv_mast.vprod_id as vprod_id,
    iv_mast.brand as item_brand_name   
 from ap_poitm 
inner join  ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
   inner join iv_mast on iv_mast.product_id = ap_poitm.product_id  
   inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id   
   inner join apsupplr on apsupplr.refno = apvend.refno   
left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id  
where  ap_poitm.product_id like '%592778%'


select ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,
   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
   ap_pohdr.req_date as po_actual_receipt_date,
   cast("" as varchar(2)) as transportation_code,
   apvend.company1 as vendor_name,
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
   apsupplr.province as vendor_pickup_warehouse_state,
   apsupplr.postcode as vendor_pickup_warehouse_zip,
   ap_poitm.product_id as item_number,
   iv_mast.descript as item_description_long,
   iv_mast.pk_size as item_pack_size,
   iv_mast.iv_class as it_class,
   iv_mast.pk_upc as pk_upc,
   iv_gtin.gtin as it_gtin,
  cast(round(iif(ap_poitm.ord_unit = "KG",(ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
  cast(round(iif(ap_poitm.ord_unit = "KG",(ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621,ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity,
   cast(0 as integer) as po_cancelled_quantity,
   cast(ap_poitm.amount as numeric(9, 4)) as product_price, 
   cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
   cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight,
   cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube, 
   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,
   cast(round(iif(iv_mast.pk_tare_wt <> 0,
   (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
   icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure, cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight,
    cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight,
    cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube, 
	iv_mast.vprod_id as vprod_id,
    iv_mast.brand as item_brand_name 
	from ap_poitm 
	inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
	inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
	inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
	inner join apsupplr on apsupplr.refno = apvend.refno 
	left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id 
	where  ap_poitm.product_id like '%592778%'
select ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,
   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
   ap_pohdr.req_date as po_actual_receipt_date,
   cast("" as varchar(2)) as transportation_code,
   apvend.company1 as vendor_name,
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
   apsupplr.province as vendor_pickup_warehouse_state,
   apsupplr.postcode as vendor_pickup_warehouse_zip,
   ap_poitm.product_id as item_number,
   iv_mast.descript as item_description_long,
   iv_mast.pk_size as item_pack_size,
   iv_mast.iv_class as it_class,
   iv_mast.pk_upc as pk_upc,
   iv_gtin.gtin as it_gtin,
  cast(round(iif(ap_poitm.ord_unit = "KG",(ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
  cast(round(iif(ap_poitm.ord_unit = "KG",(ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621,ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity,
   cast(0 as integer) as po_cancelled_quantity,
   cast(ap_poitm.amount as numeric(9, 4)) as product_price, 
   cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
   cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight,
   cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube, 
   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,
   cast(round(iif(iv_mast.pk_tare_wt <> 0,
   (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
   icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure, cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight,
    cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight,
    cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube, 
	iv_mast.vprod_id as vprod_id,
    iv_mast.brand as item_brand_name 
	from ap_poitm 
	inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
	inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
	inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
	inner join apsupplr on apsupplr.refno = apvend.refno 
	left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id 
	where  ap_poitm.product_id like '%592778%'
select * from ap_pohdr;
select * from ap_pohdr

select * from ap_pohdr
select * from ap_pohdr

select * from ap_pohdr
select * from ap_pohdr

select top(1) from ap_pohdr

select top 1 * from ap_pohdr

select top (1) refno from ap_pohdr

select top (1) refno from ap_pohdr order by refno

select top (1) * from ap_pohdr order by refno

select ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,
   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
   ap_pohdr.req_date as po_actual_receipt_date,
   cast("" as varchar(2)) as transportation_code,
   apvend.company1 as vendor_name,
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
   apsupplr.province as vendor_pickup_warehouse_state,
   apsupplr.postcode as vendor_pickup_warehouse_zip,
   ap_poitm.product_id as item_number,
   iv_mast.descript as item_description_long,
   iv_mast.pk_size as item_pack_size,
   iv_mast.iv_class as it_class,
   iv_mast.pk_upc as pk_upc,
   iv_gtin.gtin as it_gtin,
  cast(round(iif(ap_poitm.ord_unit = "KG",(ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
  cast(round(iif(ap_poitm.ord_unit = "KG",(ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621,ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity,
   cast(0 as integer) as po_cancelled_quantity,
   cast(ap_poitm.amount as numeric(9, 4)) as product_price, 
   cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
   cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight,
   cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube, 
   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,
   cast(round(iif(iv_mast.pk_tare_wt <> 0,
   (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
   icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure, cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight,
    cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight,
    cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube, 
	iv_mast.vprod_id as vprod_id,
    iv_mast.brand as item_brand_name 
	from ap_poitm 
	inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
	inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
	inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
	inner join apsupplr on apsupplr.refno = apvend.refno 
	left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id 
	where  ap_poitm.product_id like '%592778%'
select ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,

   ap_pohdr.closed as po_closed_date,
   ap_pohdr.issued as po_issued_date,
   ap_pohdr.re_open as po_re_re_open_date,
   ap_pohdr.cancelled as po_cancelled_date,

   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
   ap_pohdr.req_date as po_actual_receipt_date,
   cast("" as varchar(2)) as transportation_code,
   apvend.company1 as vendor_name,
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
   apsupplr.province as vendor_pickup_warehouse_state,
   apsupplr.postcode as vendor_pickup_warehouse_zip,
   ap_poitm.product_id as item_number,
   iv_mast.descript as item_description_long,
   iv_mast.pk_size as item_pack_size,
   iv_mast.iv_class as it_class,
   iv_mast.pk_upc as pk_upc,
   iv_gtin.gtin as it_gtin,
  cast(round(iif(ap_poitm.ord_unit = "KG",(ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
  cast(round(iif(ap_poitm.ord_unit = "KG",(ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621,ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity,
   cast(0 as integer) as po_cancelled_quantity,
   cast(ap_poitm.amount as numeric(9, 4)) as product_price, 
   cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
   cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight,
   cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube, 
   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,
   cast(round(iif(iv_mast.pk_tare_wt <> 0,
   (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
   icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure, cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight,
    cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight,
    cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube, 
	iv_mast.vprod_id as vprod_id,
    iv_mast.brand as item_brand_name 
	from ap_poitm 
	inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
	inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
	inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
	inner join apsupplr on apsupplr.refno = apvend.refno 
	left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id 
	where  ap_poitm.product_id like '%592778%'
select ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,

   ap_pohdr.closed as po_closed_date,
   ap_pohdr.issued as po_issued_date,
   ap_pohdr.re_open as po_re_re_open_date,
   ap_pohdr.cancelled as po_cancelled_date,

   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
   ap_pohdr.req_date as po_actual_receipt_date,
   cast("" as varchar(2)) as transportation_code,
   apvend.company1 as vendor_name,
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
   apsupplr.province as vendor_pickup_warehouse_state,
   apsupplr.postcode as vendor_pickup_warehouse_zip,
   ap_poitm.product_id as item_number,
   iv_mast.descript as item_description_long,
   iv_mast.pk_size as item_pack_size,
   iv_mast.iv_class as it_class,
   iv_mast.pk_upc as pk_upc,
   iv_gtin.gtin as it_gtin,
  cast(round(iif(ap_poitm.ord_unit = "KG",(ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
  cast(round(iif(ap_poitm.ord_unit = "KG",(ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621,ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity,
   cast(0 as integer) as po_cancelled_quantity,
   cast(ap_poitm.amount as numeric(9, 4)) as product_price, 
   cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
   cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube, 
   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,
   cast(round(iif(iv_mast.pk_tare_wt <> 0,
   (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
   icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure, 
   cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight,
   cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight,
   cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube, 
   iv_mast.vprod_id as vprod_id,
    iv_mast.brand as item_brand_name 
	from ap_poitm 
	inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
	inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
	inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
	inner join apsupplr on apsupplr.refno = apvend.refno 
	left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id 
	where  ap_poitm.product_id like '%592778%'
select ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,

   ap_pohdr.closed as po_closed_date,
   ap_pohdr.issued as po_issued_date,
   ap_pohdr.re_open as po_re_re_open_date,
   ap_pohdr.cancelled as po_cancelled_date,

   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
   ap_pohdr.req_date as po_actual_receipt_date,
   cast("" as varchar(2)) as transportation_code,
   apvend.company1 as vendor_name,
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
   apsupplr.province as vendor_pickup_warehouse_state,
   apsupplr.postcode as vendor_pickup_warehouse_zip,
   ap_poitm.product_id as item_number,
   iv_mast.descript as item_description_long,
   iv_mast.pk_size as item_pack_size,
   iv_mast.iv_class as it_class,
   iv_mast.pk_upc as pk_upc,
   iv_gtin.gtin as it_gtin,
  cast(round(iif(ap_poitm.ord_unit = "KG",(ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
  cast(round(iif(ap_poitm.ord_unit = "KG",(ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621,ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity,
   cast(0 as integer) as po_cancelled_quantity,
   cast(ap_poitm.amount as numeric(9, 4)) as product_price, 
   cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
   cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube, 
   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,
   cast(round(iif(iv_mast.pk_tare_wt <> 0,
   (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
   icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure, 
   cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight,
   cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube, 
   iv_mast.vprod_id as vprod_id,
    iv_mast.brand as item_brand_name 
	from ap_poitm 
	inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
	inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
	inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
	inner join apsupplr on apsupplr.refno = apvend.refno 
	left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id 
	where  ap_poitm.product_id like '%592778%'
select ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,

   ap_pohdr.closed as po_closed_date,
   ap_pohdr.issued as po_issued_date,
   ap_pohdr.re_open as po_re_re_open_date,
   ap_pohdr.cancelled as po_cancelled_date,

   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
   ap_pohdr.req_date as po_actual_receipt_date,
   cast("" as varchar(2)) as transportation_code,
   apvend.company1 as vendor_name,
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
   apsupplr.province as vendor_pickup_warehouse_state,
   apsupplr.postcode as vendor_pickup_warehouse_zip,
   ap_poitm.product_id as item_number,
   iv_mast.descript as item_description_long,
   iv_mast.pk_size as item_pack_size,
   iv_mast.iv_class as it_class,
   iv_mast.pk_upc as pk_upc,
   iv_gtin.gtin as it_gtin,
  cast(round(iif(ap_poitm.ord_unit = "KG",(ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
  cast(round(iif(ap_poitm.ord_unit = "KG",(ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621,ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity,
   cast(0 as integer) as po_cancelled_quantity,
   cast(ap_poitm.amount as numeric(9, 4)) as product_price, 
   cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
   cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube, 
   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,
   cast(round(iif(iv_mast.pk_tare_wt <> 0,
   (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
   icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure, 
   cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight,
   iv_mast.vprod_id as vprod_id,
    iv_mast.brand as item_brand_name 
	from ap_poitm 
	inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
	inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
	inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
	inner join apsupplr on apsupplr.refno = apvend.refno 
	left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id 
	where  ap_poitm.product_id like '%592778%'
select ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,

   ap_pohdr.closed as po_closed_date,
   ap_pohdr.issued as po_issued_date,
   ap_pohdr.re_open as po_re_re_open_date,
   ap_pohdr.cancelled as po_cancelled_date,

   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
   ap_pohdr.req_date as po_actual_receipt_date,
   cast("" as varchar(2)) as transportation_code,
   apvend.company1 as vendor_name,
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
   apsupplr.province as vendor_pickup_warehouse_state,
   apsupplr.postcode as vendor_pickup_warehouse_zip,
   ap_poitm.product_id as item_number,
   iv_mast.descript as item_description_long,
   iv_mast.pk_size as item_pack_size,
   iv_mast.iv_class as it_class,
   iv_mast.pk_upc as pk_upc,
   iv_gtin.gtin as it_gtin,
  cast(round(iif(ap_poitm.ord_unit = "KG",(ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
  cast(round(iif(ap_poitm.ord_unit = "KG",(ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621,ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity,
   cast(0 as integer) as po_cancelled_quantity,
   cast(ap_poitm.amount as numeric(9, 4)) as product_price, 
   cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
   cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube, 
   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,
   cast(round(iif(iv_mast.pk_tare_wt <> 0,
   (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
   icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure, 
   cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight,
   iv_mast.vprod_id as vprod_id,
    iv_mast.brand as item_brand_name 
	from ap_poitm 
	inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
	inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
	inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
	inner join apsupplr on apsupplr.refno = apvend.refno 
	left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id 
	where  ap_poitm.product_id like '%592778%'
select ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,

   ap_pohdr.closed as po_closed_date,
   ap_pohdr.issued as po_issued_date,
   ap_pohdr.re_open as po_re_re_open_date,
   ap_pohdr.cancelled as po_cancelled_date,

   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
   ap_pohdr.req_date as po_actual_receipt_date,
   cast("" as varchar(2)) as transportation_code,

   apvend.company1 as vendor_name,
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
   apsupplr.province as vendor_pickup_warehouse_state,
   apsupplr.postcode as vendor_pickup_warehouse_zip,


   ap_poitm.product_id as item_number,
   iv_mast.descript as item_description_long,
   iv_mast.pk_size as item_pack_size,
   iv_mast.iv_class as it_class,
   iv_mast.pk_upc as pk_upc,
   iv_gtin.gtin as it_gtin,


  cast(round(iif(ap_poitm.ord_unit = "KG",(ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
  cast(round(iif(ap_poitm.ord_unit = "KG",(ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621,ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity,
   cast(0 as integer) as po_cancelled_quantity,

   cast(ap_poitm.amount as numeric(9, 4)) as product_price, 
   cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
   cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube, 
   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,
   cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
   icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure, 
   cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight,
   iv_mast.vprod_id as vprod_id,
    iv_mast.brand as item_brand_name 
	from ap_poitm 
	inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
	inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
	inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
	inner join apsupplr on apsupplr.refno = apvend.refno 
	left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id 
	where  ap_poitm.product_id like '%592778%'
select ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,

   ap_pohdr.closed as po_closed_date,
   ap_pohdr.issued as po_issued_date,
   ap_pohdr.re_open as po_re_re_open_date,
   ap_pohdr.cancelled as po_cancelled_date,

   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
   ap_pohdr.req_date as po_actual_receipt_date,
   cast("" as varchar(2)) as transportation_code,

   apvend.company1 as vendor_name,
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
   apsupplr.province as vendor_pickup_warehouse_state,
   apsupplr.postcode as vendor_pickup_warehouse_zip,


   ap_poitm.product_id as item_number,
   iv_mast.descript as item_description_long,
   iv_mast.pk_size as item_pack_size,
   iv_mast.iv_class as it_class,
   iv_mast.pk_upc as pk_upc,
   iv_gtin.gtin as it_gtin,


  cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
  cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621,ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity,
   cast(0 as integer) as po_cancelled_quantity,

   cast(ap_poitm.amount as numeric(9, 4)) as product_price, 
   cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
   cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube, 
   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,
   cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
   icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, 
   cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight,
   iv_mast.vprod_id as vprod_id,
    iv_mast.brand as item_brand_name 
	from ap_poitm 
	inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
	inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
	inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
	inner join apsupplr on apsupplr.refno = apvend.refno 
	left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id 
	where  ap_poitm.product_id like '%592778%'
select ap_pohdr.pono,   ap_pohdr.vend_id,   ap_pohdr.supplr_no,   ap_pohdr.closed as po_closed_date,   ap_pohdr.issued as po_issued_date,
   ap_pohdr.re_open as po_re_re_open_date,   ap_pohdr.cancelled as po_cancelled_date,   ap_pohdr.date as po_creation_date,   ap_pohdr.req_date as po_schedule_receipt_date,   ap_pohdr.req_date as po_actual_receipt_date,   cast("" as varchar(2)) as transportation_code,   apvend.company1 as vendor_name,   apsupplr.company1 as vendor_pickup_warehouse_name,   apsupplr.address1 as vendor_pickup_warehouse_address1,   apsupplr.address2 as vendor_pickup_warehouse_address2,   apsupplr.city as vendor_pickup_warehouse_city,  apsupplr.province as vendor_pickup_warehouse_state,  apsupplr.postcode as vendor_pickup_warehouse_zip,
   ap_poitm.product_id as item_number,   iv_mast.descript as item_description_long,   iv_mast.pk_size as item_pack_size,   iv_mast.iv_class as it_class,   iv_mast.pk_upc as pk_upc,   iv_gtin.gtin as it_gtin,  cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,  cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621,ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity,   cast(0 as integer) as po_cancelled_quantity,
   cast(ap_poitm.amount as numeric(9, 4)) as product_price,    cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, iv_mast.vprod_id as vprod_id,
    iv_mast.brand as item_brand_name from ap_poitm inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno inner join iv_mast on iv_mast.product_id = ap_poitm.product_id inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 	inner join apsupplr on apsupplr.refno = apvend.refno left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id where  ap_poitm.product_id like '%592778%'
select ap_pohdr.pono,   ap_pohdr.vend_id,   ap_pohdr.supplr_no,   ap_pohdr.closed as po_closed_date,   ap_pohdr.issued as po_issued_date,
   ap_pohdr.re_open as po_re_re_open_date,   ap_pohdr.cancelled as po_cancelled_date,   ap_pohdr.date as po_creation_date,   ap_pohdr.req_date as po_schedule_receipt_date,   ap_pohdr.req_date as po_actual_receipt_date,   cast("" as varchar(2)) as transportation_code,   apvend.company1 as vendor_name,   apsupplr.company1 as vendor_pickup_warehouse_name,   apsupplr.address1 as vendor_pickup_warehouse_address1,   apsupplr.address2 as vendor_pickup_warehouse_address2,   apsupplr.city as vendor_pickup_warehouse_city,  apsupplr.province as vendor_pickup_warehouse_state,  apsupplr.postcode as vendor_pickup_warehouse_zip,
   ap_poitm.product_id as item_number,   iv_mast.descript as item_description_long,   iv_mast.pk_size as item_pack_size,   iv_mast.iv_class as it_class,   iv_mast.pk_upc as pk_upc,   iv_gtin.gtin as it_gtin,  cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,  cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621,ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity,   cast(0 as integer) as po_cancelled_quantity,
   cast(ap_poitm.amount as numeric(9, 4)) as product_price,    cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, iv_mast.vprod_id as vprod_id,
    iv_mast.brand as item_brand_name from ap_poitm inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno inner join iv_mast on iv_mast.product_id = ap_poitm.product_id inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 	inner join apsupplr on apsupplr.refno = apvend.refno left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id where  ap_poitm.product_id like '%221335%'
select ap_pohdr.pono,   ap_pohdr.vend_id,   ap_pohdr.supplr_no,   ap_pohdr.closed as po_closed_date,   ap_pohdr.issued as po_issued_date, ap_pohdr.re_open as po_re_re_open_date,   ap_pohdr.cancelled as po_cancelled_date,   ap_pohdr.date as po_creation_date,   ap_pohdr.req_date as po_schedule_receipt_date, ap_pohdr.req_date as po_actual_receipt_date,   cast(" as varchar(2)) as transportation_code,   apvend.company1 as vendor_name,   apsupplr.company1 as vendor_pickup_warehouse_name,   apsupplr.address1 as vendor_pickup_warehouse_address1,   apsupplr.address2 as vendor_pickup_warehouse_address2,   apsupplr.city as vendor_pickup_warehouse_city,  apsupplr.province as vendor_pickup_warehouse_state,  apsupplr.postcode as vendor_pickup_warehouse_zip, ap_poitm.product_id as item_number,   iv_mast.descript as item_description_long,   iv_mast.pk_size as item_pack_size,   iv_mast.iv_class as it_class,   iv_mast.pk_upc as pk_upc,   iv_gtin.gtin as it_gtin,  cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,  cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621,ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity,   cast(0 as integer) as po_cancelled_quantity, cast(ap_poitm.amount as numeric(9, 4)) as product_price,    cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name from ap_poitm inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno inner join iv_mast on iv_mast.product_id = ap_poitm.product_id inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 	inner join apsupplr on apsupplr.refno = apvend.refno left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id where  ap_poitm.product_id like '221335'
select ap_pohdr.pono,   ap_pohdr.vend_id,   ap_pohdr.supplr_no,   ap_pohdr.closed as po_closed_date,   ap_pohdr.issued as po_issued_date, ap_pohdr.re_open as po_re_re_open_date,   ap_pohdr.cancelled as po_cancelled_date,   ap_pohdr.date as po_creation_date,   ap_pohdr.req_date as po_schedule_receipt_date, ap_pohdr.req_date as po_actual_receipt_date,  apvend.company1 as vendor_name,   apsupplr.company1 as vendor_pickup_warehouse_name,   apsupplr.address1 as vendor_pickup_warehouse_address1,   apsupplr.address2 as vendor_pickup_warehouse_address2,   apsupplr.city as vendor_pickup_warehouse_city,  apsupplr.province as vendor_pickup_warehouse_state,  apsupplr.postcode as vendor_pickup_warehouse_zip, ap_poitm.product_id as item_number,   iv_mast.descript as item_description_long,   iv_mast.pk_size as item_pack_size,   iv_mast.iv_class as it_class,   iv_mast.pk_upc as pk_upc,   iv_gtin.gtin as it_gtin,  cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,  cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621,ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity,   cast(0 as integer) as po_cancelled_quantity, cast(ap_poitm.amount as numeric(9, 4)) as product_price,    cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name 
from ap_poitm 
inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 	
inner join apsupplr on apsupplr.refno = apvend.refno 
left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id 


where  ap_poitm.product_id like '221335'
select ap_pohdr.pono,   ap_pohdr.vend_id,   ap_pohdr.supplr_no,   ap_pohdr.closed as po_closed_date,   ap_pohdr.issued as po_issued_date, ap_pohdr.re_open as po_re_re_open_date,   ap_pohdr.cancelled as po_cancelled_date,   ap_pohdr.date as po_creation_date,   ap_pohdr.req_date as po_schedule_receipt_date, ap_pohdr.req_date as po_actual_receipt_date,  apvend.company1 as vendor_name,   apsupplr.company1 as vendor_pickup_warehouse_name,   apsupplr.address1 as vendor_pickup_warehouse_address1,   apsupplr.address2 as vendor_pickup_warehouse_address2,   apsupplr.city as vendor_pickup_warehouse_city,  apsupplr.province as vendor_pickup_warehouse_state,  apsupplr.postcode as vendor_pickup_warehouse_zip, ap_poitm.product_id as item_number,   iv_mast.descript as item_description_long,   iv_mast.pk_size as item_pack_size,   iv_mast.iv_class as it_class,   iv_mast.pk_upc as pk_upc,   iv_gtin.gtin as it_gtin,  cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,  cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621,ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity,   cast(0 as integer) as po_cancelled_quantity, cast(ap_poitm.amount as numeric(9, 4)) as product_price,    cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name 
from ap_poitm 
inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 	
inner join apsupplr on apsupplr.refno = apvend.refno 
left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id 
where  ap_poitm.product_id like '221335'
SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, 
                    ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt, ar_cthdr.start_date as og_st_dt, ar_ctitm.product_id as item_no, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_effect as expiry_dt, ar_ctitm.price as it_price,  iv_mast.pk_sell_un,
                iv_mast.pk_ctch_wt as has_ctch_wgt, iv_mast.vprod_id as vprod_id, .t. as primary_vendor_flag, cast(icase(iv_mast.inactive, 'D', not iv_mast.inactive and iv_mast.to_be_ord, 'S', 'A') as varchar(1)) as item_status_code, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.price_unit as price_unit, apvend.company1 as vend_name, apvend.supplr_no as supplier, iv_gtin.gtin as it_gtin,
                cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_qtyoh / iv_mast.pk_weight, iv_locat.pk_qtyoh) * 2.204621, 0) as integer) as cases_on_hand, cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_on_ord / iv_mast.pk_weight, iv_locat.pk_on_ord) * 2.204621, 0) as integer) as cases_on_order, cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_allocat / iv_mast.pk_weight, iv_locat.pk_allocat) * 2.204621, 0) as integer) as cases_sold from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join iv_locat on iv_locat.refno = iv_mast.refno                    
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like '%171155%'
SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, 
                    ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt, ar_cthdr.start_date as og_st_dt, ar_ctitm.product_id as item_no, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_effect as expiry_dt, ar_ctitm.price as it_price,  iv_mast.pk_sell_un,
                iv_mast.pk_ctch_wt as has_ctch_wgt, iv_mast.vprod_id as vprod_id, .t. as primary_vendor_flag, cast(icase(iv_mast.inactive, 'D', not iv_mast.inactive and iv_mast.to_be_ord, 'S', 'A') as varchar(1)) as item_status_code, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.price_unit as price_unit, apvend.company1 as vend_name, apvend.supplr_no as supplier, iv_gtin.gtin as it_gtin,
                cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_qtyoh / iv_mast.pk_weight, iv_locat.pk_qtyoh) * 2.204621, 0) as integer) as cases_on_hand, cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_on_ord / iv_mast.pk_weight, iv_locat.pk_on_ord) * 2.204621, 0) as integer) as cases_on_order, cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_allocat / iv_mast.pk_weight, iv_locat.pk_allocat) * 2.204621, 0) as integer) as cases_sold from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join iv_locat on iv_locat.refno = iv_mast.refno                    
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like '%17155%'
SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, 
                    ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt, ar_cthdr.start_date as og_st_dt, ar_ctitm.product_id as item_no, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_effect as expiry_dt, ar_ctitm.price as it_price,  iv_mast.pk_sell_un,
                iv_mast.pk_ctch_wt as has_ctch_wgt, iv_mast.vprod_id as vprod_id, .t. as primary_vendor_flag, cast(icase(iv_mast.inactive, 'D', not iv_mast.inactive and iv_mast.to_be_ord, 'S', 'A') as varchar(1)) as item_status_code, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.price_unit as price_unit, apvend.company1 as vend_name, apvend.supplr_no as supplier, iv_gtin.gtin as it_gtin,
                cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_qtyoh / iv_mast.pk_weight, iv_locat.pk_qtyoh) * 2.204621, 0) as integer) as cases_on_hand, cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_on_ord / iv_mast.pk_weight, iv_locat.pk_on_ord) * 2.204621, 0) as integer) as cases_on_order, cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_allocat / iv_mast.pk_weight, iv_locat.pk_allocat) * 2.204621, 0) as integer) as cases_sold from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join iv_locat on iv_locat.refno = iv_mast.refno                    
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id like '%17115%'
select * ivmast where product_id like '%221335%'
select * from ivmast where product_id like '%221335%'
select * from ivmast where product_id like '%221335%'
select * from iv_mast where product_id like '%221335%'
select * from coremeta
select * from coremeta where cobjectnam like '%pk_qtyoh%'
select * from iv_mast where product_id like '%265688%'
SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, 
                    ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt, ar_cthdr.start_date as og_st_dt, ar_ctitm.product_id as item_no, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_effect as expiry_dt, ar_ctitm.price as it_price,  iv_mast.pk_sell_un,
                iv_mast.pk_ctch_wt as has_ctch_wgt, 
                iv_mast.vprod_id as vprod_id, 
                .t. as primary_vendor_flag, 
                cast(icase(iv_mast.inactive, 'D', not iv_mast.inactive and iv_mast.to_be_ord, 'S', 'A') as varchar(1)) as item_status_code,
                iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, 
                iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.price_unit as price_unit, apvend.company1 as vend_name, apvend.supplr_no as supplier, iv_gtin.gtin as it_gtin,
                iv_locat.pk_qtyoh as cases_on_hand, 
                iv_locat.pk_on_ord as cases_on_order, 
                iv_locat.pk_allocat as cases_sold 
                from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join iv_locat on iv_locat.refno = iv_mast.refno                    
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id = '17115'
SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, 
                    ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt, ar_cthdr.start_date as og_st_dt, ar_ctitm.product_id as item_no, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_effect as expiry_dt, ar_ctitm.price as it_price,  iv_mast.pk_sell_un,iv_mast.pk_weight,
                iv_mast.pk_ctch_wt as has_ctch_wgt, iv_mast.vprod_id as vprod_id, .t. as primary_vendor_flag, cast(icase(iv_mast.inactive, 'D', not iv_mast.inactive and iv_mast.to_be_ord, 'S', 'A') as varchar(1)) as item_status_code, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.price_unit as price_unit, apvend.company1 as vend_name, apvend.supplr_no as supplier, iv_gtin.gtin as it_gtin,
                cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_qtyoh / iv_mast.pk_weight, iv_locat.pk_qtyoh) * 2.204621, 0) as integer) as cases_on_hand, 
                cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_on_ord / iv_mast.pk_weight, iv_locat.pk_on_ord) * 2.204621, 0) as integer) as cases_on_order, 
                cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_allocat / iv_mast.pk_weight, iv_locat.pk_allocat) * 2.204621, 0) as integer) as cases_sold from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join iv_locat on iv_locat.refno = iv_mast.refno                    
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id = '17115'
SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, 
                    ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt, ar_cthdr.start_date as og_st_dt, ar_ctitm.product_id as item_no, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_effect as expiry_dt, ar_ctitm.price as it_price,  iv_mast.pk_sell_un, iv_mast.pk_weight as pack_weight,
                iv_mast.pk_ctch_wt as has_ctch_wgt, iv_mast.vprod_id as vprod_id, .t. as primary_vendor_flag, cast(icase(iv_mast.inactive, 'D', not iv_mast.inactive and iv_mast.to_be_ord, 'S', 'A') as varchar(1)) as item_status_code, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.price_unit as price_unit, apvend.company1 as vend_name, apvend.supplr_no as supplier, iv_gtin.gtin as it_gtin,
                cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_qtyoh / iv_mast.pk_weight, iv_locat.pk_qtyoh) * 2.204621, 0) as integer) as cases_on_hand, 
                cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_on_ord / iv_mast.pk_weight, iv_locat.pk_on_ord) * 2.204621, 0) as integer) as cases_on_order, 
                cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_allocat / iv_mast.pk_weight, iv_locat.pk_allocat) * 2.204621, 0) as integer) as cases_sold from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join iv_locat on iv_locat.refno = iv_mast.refno                    
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id = '17115'
select * from iv_locat
select * from iv_locat where product_id like '%265688%'

select * from iv_sell_units where product_id like '%265688%'
SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, 
                    ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt, ar_cthdr.start_date as og_st_dt, ar_ctitm.product_id as item_no, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_effect as expiry_dt, ar_ctitm.price as it_price,  iv_mast.pk_sell_un, iv_mast.pk_weight as pack_weight,
                iv_mast.pk_ctch_wt as has_ctch_wgt, iv_mast.vprod_id as vprod_id, .t. as primary_vendor_flag, cast(icase(iv_mast.inactive, 'D', not iv_mast.inactive and iv_mast.to_be_ord, 'S', 'A') as varchar(1)) as item_status_code, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.price_unit as price_unit, apvend.company1 as vend_name, apvend.supplr_no as supplier, iv_gtin.gtin as it_gtin,
                cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_qtyoh / iv_mast.pk_weight, iv_locat.pk_qtyoh) * 2.204621, 0) as integer) as cases_on_hand, 
                cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_on_ord / iv_mast.pk_weight, iv_locat.pk_on_ord) * 2.204621, 0) as integer) as cases_on_order, 
                cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_allocat / iv_mast.pk_weight, iv_locat.pk_allocat) * 2.204621, 0) as integer) as cases_sold from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join iv_locat on iv_locat.refno = iv_mast.refno                    
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id = '17115'
SELECT ar_cthdr.wh_locat as wh_locat, ar_cthdr.contr_id as contr_id, 
                    ar_cthdr.descript as ogName, ar_cthdr.begin_date as og_gen_dt, ar_cthdr.start_date as og_st_dt, ar_ctitm.product_id as item_no, ar_ctitm.descript as it_desc, ar_ctitm.pk_unit as pk_unit,  ar_ctitm.brand as it_brand, ar_ctitm.new_effect as effect_dt, ar_ctitm.new_effect as expiry_dt, ar_ctitm.price as it_price,  iv_mast.pk_sell_un, iv_mast.pk_weight as pack_weight,  iv_sell_units.factor as pack_weight_factor,
                iv_mast.pk_ctch_wt as has_ctch_wgt, iv_mast.vprod_id as vprod_id, .t. as primary_vendor_flag, cast(icase(iv_mast.inactive, 'D', not iv_mast.inactive and iv_mast.to_be_ord, 'S', 'A') as varchar(1)) as item_status_code, iv_mast.pk_upc as pk_upc,iv_mast.iv_class as it_class, iv_mast.vend_id as vend_id, iv_sell_units.size as pk_size, iv_sell_units.unit as it_unit, iv_sell_units.prod_wt as prod_wt, iv_sell_units.tare as tare, iv_sell_units.price_unit as price_unit, apvend.company1 as vend_name, apvend.supplr_no as supplier, iv_gtin.gtin as it_gtin,
                cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_qtyoh / iv_mast.pk_weight, iv_locat.pk_qtyoh) * 2.204621, 0) as integer) as cases_on_hand, 
                cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_on_ord / iv_mast.pk_weight, iv_locat.pk_on_ord) * 2.204621, 0) as integer) as cases_on_order, 
                cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_allocat / iv_mast.pk_weight, iv_locat.pk_allocat) * 2.204621, 0) as integer) as cases_sold from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join iv_locat on iv_locat.refno = iv_mast.refno                    
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.pk_unit = iv_sell_units.unit and ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id = '17115'
SELECT 
ar_cthdr.wh_locat as wh_locat,
 
ar_cthdr.contr_id as contr_id,
 
ar_cthdr.descript as ogName,
 
ar_cthdr.begin_date as og_gen_dt,
 
ar_cthdr.start_date as og_st_dt,
 
ar_ctitm.product_id as item_no,
 ar_ctitm.descript as it_desc,
 ar_ctitm.pk_unit as pk_unit,
  ar_ctitm.brand as it_brand,
 ar_ctitm.new_effect as effect_dt,
 ar_ctitm.new_effect as expiry_dt,
 ar_ctitm.price as it_price,
 
 iv_mast.pk_sell_un,
 iv_mast.pk_weight as pack_weight,
  iv_sell_units.factor as pack_weight_factor,
  iv_mast.pk_ctch_wt as has_ctch_wgt,
 iv_mast.vprod_id as vprod_id,
 .t. as primary_vendor_flag,
 cast(icase(iv_mast.inactive,
 'D',
 not iv_mast.inactive and iv_mast.to_be_ord,
 'S',
 'A') as varchar(1)) as item_status_code,
 iv_mast.pk_upc as pk_upc,
iv_mast.iv_class as it_class,
 iv_mast.vend_id as vend_id,
 iv_sell_units.size as pk_size,
 iv_sell_units.unit as it_unit,
 iv_sell_units.prod_wt as prod_wt,
 iv_sell_units.tare as tare,
 iv_sell_units.price_unit as price_unit,
 apvend.company1 as vend_name,
 apvend.supplr_no as supplier,
 iv_gtin.gtin as it_gtin,
                cast(round(iif(iv_mast.pk_sell_un = 'KG',
 iv_locat.pk_qtyoh / iv_mast.pk_weight,
 iv_locat.pk_qtyoh) * 2.204621,
 0) as integer) as cases_on_hand,
 
                cast(round(iif(iv_mast.pk_sell_un = 'KG',
 iv_locat.pk_on_ord / iv_mast.pk_weight,
 iv_locat.pk_on_ord) * 2.204621,
 0) as integer) as cases_on_order,
 
                cast(round(iif(iv_mast.pk_sell_un = 'KG',
 iv_locat.pk_allocat / iv_mast.pk_weight,
 iv_locat.pk_allocat) * 2.204621,
 0) as integer) as cases_sold from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join iv_locat on iv_locat.refno = iv_mast.refno                    
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id = '17115'
SELECT 
ar_cthdr.wh_locat as wh_locat,
 
ar_cthdr.contr_id as contr_id,
 
ar_cthdr.descript as ogName,
 
ar_cthdr.begin_date as og_gen_dt,
 
ar_cthdr.start_date as og_st_dt,
 
ar_ctitm.product_id as item_no,
 ar_ctitm.descript as it_desc,
 ar_ctitm.pk_unit as pk_unit,
  ar_ctitm.brand as it_brand,
 ar_ctitm.new_effect as effect_dt,
 ar_ctitm.new_effect as expiry_dt,
 ar_ctitm.price as it_price,
 
 iv_mast.pk_sell_un,
 iv_mast.pk_weight as pack_weight,
  iv_sell_units.factor as pack_weight_factor,
  iv_mast.pk_ctch_wt as has_ctch_wgt,
 iv_mast.vprod_id as vprod_id,
 .t. as primary_vendor_flag,
 cast(icase(iv_mast.inactive,
 'D',
 not iv_mast.inactive and iv_mast.to_be_ord,
 'S',
 'A') as varchar(1)) as item_status_code,
 iv_mast.pk_upc as pk_upc,
iv_mast.iv_class as it_class,
 iv_mast.vend_id as vend_id,
 iv_sell_units.size as pk_size,
 iv_sell_units.unit as it_unit,
 iv_sell_units.prod_wt as prod_wt,
 iv_sell_units.tare as tare,
 iv_sell_units.price_unit as price_unit,
 apvend.company1 as vend_name,
 apvend.supplr_no as supplier,
 iv_gtin.gtin as it_gtin,
                cast(round(iif(iv_mast.pk_sell_un = 'KG',
 iv_locat.pk_qtyoh / iv_mast.pk_weight,
 iv_locat.pk_qtyoh) * 2.204621,
 0) as integer) as cases_on_hand,
 
                cast(round(iif(iv_mast.pk_sell_un = 'KG',
 iv_locat.pk_on_ord / iv_mast.pk_weight,
 iv_locat.pk_on_ord) * 2.204621,
 0) as integer) as cases_on_order,
 
                cast(round(iif(iv_mast.pk_sell_un = 'KG',
 iv_locat.pk_allocat / iv_mast.pk_weight,
 iv_locat.pk_allocat) * 2.204621,
 0) as integer) as cases_sold, 
iv_locat.pk_qtyoh as qtyoh,
 iv_locat.pk_on_ord as qty_on_ord,
 iv_locat.pk_allocat as qty_on_allocat 


from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join iv_locat on iv_locat.refno = iv_mast.refno                    
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.bc = iv_sell_units.bc 
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id = '17115'
SELECT 
ar_cthdr.wh_locat as wh_locat,
 
ar_cthdr.contr_id as contr_id,
 
ar_cthdr.descript as ogName,
 
ar_cthdr.begin_date as og_gen_dt,
 
ar_cthdr.start_date as og_st_dt,
 
ar_ctitm.product_id as item_no,
 ar_ctitm.descript as it_desc,
 ar_ctitm.pk_unit as pk_unit,
  ar_ctitm.brand as it_brand,
 ar_ctitm.new_effect as effect_dt,
 ar_ctitm.new_effect as expiry_dt,
 ar_ctitm.price as it_price,
 
 iv_mast.pk_sell_un,
 iv_mast.pk_weight as pack_weight,
  iv_sell_units.factor as pack_weight_factor,
  iv_mast.pk_ctch_wt as has_ctch_wgt,
 iv_mast.vprod_id as vprod_id,
 .t. as primary_vendor_flag,
 cast(icase(iv_mast.inactive,
 'D',
 not iv_mast.inactive and iv_mast.to_be_ord,
 'S',
 'A') as varchar(1)) as item_status_code,
 iv_mast.pk_upc as pk_upc,
iv_mast.iv_class as it_class,
 iv_mast.vend_id as vend_id,
 iv_sell_units.size as pk_size,
 iv_sell_units.unit as it_unit,
 iv_sell_units.prod_wt as prod_wt,
 iv_sell_units.tare as tare,
 iv_sell_units.price_unit as price_unit,
 apvend.company1 as vend_name,
 apvend.supplr_no as supplier,
 iv_gtin.gtin as it_gtin,
                cast(round(iif(iv_mast.pk_sell_un = 'KG',
 iv_locat.pk_qtyoh / iv_mast.pk_weight,
 iv_locat.pk_qtyoh) * 2.204621,
 0) as integer) as cases_on_hand,
 
                cast(round(iif(iv_mast.pk_sell_un = 'KG',
 iv_locat.pk_on_ord / iv_mast.pk_weight,
 iv_locat.pk_on_ord) * 2.204621,
 0) as integer) as cases_on_order,
 
                cast(round(iif(iv_mast.pk_sell_un = 'KG',
 iv_locat.pk_allocat / iv_mast.pk_weight,
 iv_locat.pk_allocat) * 2.204621,
 0) as integer) as cases_sold, 
iv_locat.pk_qtyoh as qtyoh,
 iv_locat.pk_on_ord as qty_on_ord,
 iv_locat.pk_allocat as qty_on_allocat 


from ar_ctitm 
                    inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                    inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                    inner join iv_locat on iv_locat.refno = iv_mast.refno                    
                    inner join apvend on iv_mast.vend_id = apvend.vend_id 
                    inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                    ar_ctitm.bc = iv_sell_units.bc and iv_mast.pk_sell_un = iv_sell_units.unit
                    left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                    WHERE ar_cthdr.contr_id = '17115'
select * from iv_locat where product_id like '%221335%'
select * from iv_locat where product_id = '221335'
SELECT 
ar_cthdr.wh_locat as wh_locat,
ar_cthdr.contr_id as contr_id,
ar_cthdr.descript as ogName,
ar_cthdr.begin_date as og_gen_dt,
ar_cthdr.start_date as og_st_dt,
ar_ctitm.product_id as item_no,
 ar_ctitm.descript as it_desc,
 ar_ctitm.pk_unit as pk_unit,
  ar_ctitm.brand as it_brand,
 ar_ctitm.new_effect as effect_dt,
 ar_ctitm.new_effect as expiry_dt,
 ar_ctitm.price as it_price,
 
 iv_mast.pk_sell_un,
 iv_mast.pk_weight as pack_weight,
  iv_sell_units.factor as pack_weight_factor,
  iv_mast.pk_ctch_wt as has_ctch_wgt,
 iv_mast.vprod_id as vprod_id,
 .t. as primary_vendor_flag,
 cast(icase(iv_mast.inactive,
 'D',
 not iv_mast.inactive and iv_mast.to_be_ord,
 'S',
 'A') as varchar(1)) as item_status_code,
 iv_mast.pk_upc as pk_upc,
iv_mast.iv_class as it_class,
 iv_mast.vend_id as vend_id,
 iv_sell_units.size as pk_size,
 iv_sell_units.unit as it_unit,
 iv_sell_units.prod_wt as prod_wt,
 iv_sell_units.tare as tare,
 iv_sell_units.price_unit as price_unit,
 apvend.company1 as vend_name,
 apvend.supplr_no as supplier,
 iv_gtin.gtin as it_gtin,
 cast(round(iif(iv_mast.pk_sell_un = 'KG',
 iv_locat.pk_qtyoh / iv_mast.pk_weight,
 iv_locat.pk_qtyoh) * 2.204621,
 0) as integer) as cases_on_hand,
 
 cast(round(iif(iv_mast.pk_sell_un = 'KG',
 iv_locat.pk_on_ord / iv_mast.pk_weight,
 iv_locat.pk_on_ord) * 2.204621,
 0) as integer) as cases_on_order,
 
 cast(round(iif(iv_mast.pk_sell_un = 'KG',
 iv_locat.pk_allocat / iv_mast.pk_weight,
 iv_locat.pk_allocat) * 2.204621,
 0) as integer) as cases_sold, 
 iv_locat.pk_qtyoh as qtyoh,
 iv_locat.pk_on_ord as qty_on_ord,
 iv_locat.pk_allocat as qty_on_allocat 


from ar_ctitm 
 inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
 inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
 inner join iv_locat on iv_locat.refno = iv_mast.refno                    
 inner join apvend on iv_mast.vend_id = apvend.vend_id 
 inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
 ar_ctitm.bc = iv_sell_units.bc and iv_mast.pk_sell_un = iv_sell_units.unit
 left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
 WHERE ar_cthdr.contr_id = '17115'
select * from iv_sell_units where product_id like '%265688%'
select * from iv_locat where product_id like '%265688%'
select * from iv_mast where product_id like '%265688%'

select * from iv_sell_units where product_id like '%265688%'

select * from iv_locat where product_id like '%265688%'

select * from iv_mast where product_id like '%265688%'


SELECT 
ar_cthdr.wh_locat as wh_locat,
ar_cthdr.contr_id as contr_id,
ar_cthdr.descript as ogName,
ar_cthdr.begin_date as og_gen_dt,
ar_cthdr.start_date as og_st_dt,
ar_ctitm.product_id as item_no,
 ar_ctitm.descript as it_desc,
 ar_ctitm.pk_unit as pk_unit,
  ar_ctitm.brand as it_brand,
 ar_ctitm.new_effect as effect_dt,
 ar_ctitm.new_effect as expiry_dt,
 ar_ctitm.price as it_price,
 
 iv_mast.pk_sell_un,
 iv_mast.pk_weight as pack_weight,
  iv_sell_units.factor as pack_weight_factor,
  iv_mast.pk_ctch_wt as has_ctch_wgt,
 iv_mast.vprod_id as vprod_id,
 .t. as primary_vendor_flag,
 cast(icase(iv_mast.inactive,
 'D',
 not iv_mast.inactive and iv_mast.to_be_ord,
 'S',
 'A') as varchar(1)) as item_status_code,
 iv_mast.pk_upc as pk_upc,
iv_mast.iv_class as it_class,
 iv_mast.vend_id as vend_id,
 iv_sell_units.size as pk_size,
 iv_sell_units.unit as it_unit,
 iv_sell_units.prod_wt as prod_wt,
 iv_sell_units.tare as tare,
 iv_sell_units.price_unit as price_unit,
 apvend.company1 as vend_name,
 apvend.supplr_no as supplier,
 iv_gtin.gtin as it_gtin,
 cast(round(iif(iv_mast.pk_sell_un = 'KG',
 iv_locat.pk_qtyoh / iv_mast.pk_weight,
 iv_locat.pk_qtyoh) * 2.204621,
 0) as integer) as cases_on_hand,
 
 cast(round(iif(iv_mast.pk_sell_un = 'KG',
 iv_locat.pk_on_ord / iv_mast.pk_weight,
 iv_locat.pk_on_ord) * 2.204621,
 0) as integer) as cases_on_order,
 
 cast(round(iif(iv_mast.pk_sell_un = 'KG',
 iv_locat.pk_allocat / iv_mast.pk_weight,
 iv_locat.pk_allocat) * 2.204621,
 0) as integer) as cases_sold, 
 iv_locat.pk_qtyoh as qtyoh,
 iv_locat.pk_on_ord as qty_on_ord,
 iv_locat.pk_allocat as qty_on_allocat ,
iv_sell_units.factor


from ar_ctitm 
 inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
 inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
 inner join iv_locat on iv_locat.refno = iv_mast.refno                    
 inner join apvend on iv_mast.vend_id = apvend.vend_id 
 inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
 ar_ctitm.bc = iv_sell_units.bc and iv_mast.pk_sell_un = iv_sell_units.unit
 left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
 WHERE ar_cthdr.contr_id = '17115'
SELECT 
ar_cthdr.wh_locat as wh_locat,
ar_cthdr.contr_id as contr_id,
ar_cthdr.descript as ogName,
ar_cthdr.begin_date as og_gen_dt,
ar_cthdr.start_date as og_st_dt,
ar_ctitm.product_id as item_no,
 ar_ctitm.descript as it_desc,
 ar_ctitm.pk_unit as pk_unit,
  ar_ctitm.brand as it_brand,
 ar_ctitm.new_effect as effect_dt,
 ar_ctitm.new_effect as expiry_dt,
 ar_ctitm.price as it_price,
 
 iv_mast.pk_sell_un,
 iv_mast.pk_weight as pack_weight,
  iv_sell_units.factor as pack_weight_factor,
  iv_mast.pk_ctch_wt as has_ctch_wgt,
 iv_mast.vprod_id as vprod_id,
 .t. as primary_vendor_flag,
 cast(icase(iv_mast.inactive,
 'D',
 not iv_mast.inactive and iv_mast.to_be_ord,
 'S',
 'A') as varchar(1)) as item_status_code,
 iv_mast.pk_upc as pk_upc,
iv_mast.iv_class as it_class,
 iv_mast.vend_id as vend_id,
 iv_sell_units.size as pk_size,
 iv_sell_units.unit as it_unit,
 iv_sell_units.prod_wt as prod_wt,
 iv_sell_units.tare as tare,
 iv_sell_units.price_unit as price_unit,
 apvend.company1 as vend_name,
 apvend.supplr_no as supplier,
 iv_gtin.gtin as it_gtin,
 cast(round(iif(iv_mast.pk_sell_un = 'KG',
 iv_locat.pk_qtyoh / iv_mast.pk_weight,
 iv_locat.pk_qtyoh) * 2.204621,
 0) as integer) as cases_on_hand,
 
 cast(round(iif(iv_mast.pk_sell_un = 'KG',
 iv_locat.pk_on_ord / iv_mast.pk_weight,
 iv_locat.pk_on_ord) * 2.204621,
 0) as integer) as cases_on_order,
 
 cast(round(iif(iv_mast.pk_sell_un = 'KG',
 iv_locat.pk_allocat / iv_mast.pk_weight,
 iv_locat.pk_allocat) * 2.204621,
 0) as integer) as cases_sold, 
 iv_locat.pk_qtyoh as qtyoh,
 iv_locat.pk_on_ord as qty_on_ord,
 iv_locat.pk_allocat as qty_on_allocat ,
iv_sell_units.factor


from ar_ctitm 
 inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
 inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
 inner join iv_locat on iv_locat.refno = iv_mast.refno                    
 inner join apvend on iv_mast.vend_id = apvend.vend_id 
 inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
 ar_ctitm.bc = iv_sell_units.bc and iv_mast.pk_sell_un = iv_sell_units.unit
 left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
 WHERE ar_cthdr.contr_id = '17115'
SELECT 
ar_cthdr.wh_locat as wh_locat,
ar_cthdr.contr_id as contr_id,
ar_cthdr.descript as ogName,
ar_cthdr.begin_date as og_gen_dt,
ar_cthdr.start_date as og_st_dt,
ar_ctitm.product_id as item_no,
 ar_ctitm.descript as it_desc,
 ar_ctitm.pk_unit as pk_unit,
  ar_ctitm.brand as it_brand,
 ar_ctitm.new_effect as effect_dt,
 ar_ctitm.new_effect as expiry_dt,
 ar_ctitm.price as it_price,
  iv_mast.pk_sell_un,
 iv_mast.pk_weight as pack_weight,
  iv_sell_units.factor as pack_weight_factor,
  iv_mast.pk_ctch_wt as has_ctch_wgt,
 iv_mast.vprod_id as vprod_id,
 .t. as primary_vendor_flag,
 cast(icase(iv_mast.inactive, 'D', not iv_mast.inactive and iv_mast.to_be_ord, 'S', 'A') as varchar(1)) as item_status_code,
 iv_mast.pk_upc as pk_upc,
iv_mast.iv_class as it_class,
 iv_mast.vend_id as vend_id,
 iv_sell_units.size as pk_size,
 iv_sell_units.unit as it_unit,
 iv_sell_units.prod_wt as prod_wt,
 iv_sell_units.tare as tare,
 iv_sell_units.price_unit as price_unit,
 apvend.company1 as vend_name,
 apvend.supplr_no as supplier,
 iv_gtin.gtin as it_gtin,
 cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_qtyoh / iv_mast.pk_weight, iv_locat.pk_qtyoh) * 2.204621, 0) as integer) as cases_on_hand,
  cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_on_ord / iv_mast.pk_weight, iv_locat.pk_on_ord) * 2.204621, 0) as integer) as cases_on_order,
  cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_allocat / iv_mast.pk_weight, iv_locat.pk_allocat) * 2.204621, 0) as integer) as cases_sold,
  iv_locat.pk_qtyoh as qtyoh,
 iv_locat.pk_on_ord as qty_on_ord,
 iv_locat.pk_allocat as qty_on_allocat ,
iv_sell_units.factor from ar_ctitm  inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno  inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id  inner join iv_locat on iv_locat.refno = iv_mast.refno                     inner join apvend on iv_mast.vend_id = apvend.vend_id  inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and  ar_ctitm.bc = iv_sell_units.bc and iv_mast.pk_sell_un = iv_sell_units.unit left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id  WHERE ar_cthdr.contr_id = '17115'
SELECT 
ar_cthdr.wh_locat as wh_locat,
ar_cthdr.contr_id as contr_id,
ar_cthdr.descript as ogName,
ar_cthdr.begin_date as og_gen_dt,
ar_cthdr.start_date as og_st_dt,
ar_ctitm.product_id as item_no,
 ar_ctitm.descript as it_desc,
 ar_ctitm.pk_unit as pk_unit,
  ar_ctitm.brand as it_brand,
 ar_ctitm.new_effect as effect_dt,
 ar_ctitm.new_effect as expiry_dt,
 ar_ctitm.price as it_price,
 
 iv_mast.pk_sell_un,
 iv_mast.pk_weight as pack_weight,
  iv_sell_units.factor as pack_weight_factor,
  iv_mast.pk_ctch_wt as has_ctch_wgt,
 iv_mast.vprod_id as vprod_id,
 .t. as primary_vendor_flag,
 cast(icase(iv_mast.inactive,
 'D',
 not iv_mast.inactive and iv_mast.to_be_ord,
 'S',
 'A') as varchar(1)) as item_status_code,
 iv_mast.pk_upc as pk_upc,
iv_mast.iv_class as it_class,
 iv_mast.vend_id as vend_id,
 iv_sell_units.size as pk_size,
 iv_sell_units.unit as it_unit,
 iv_sell_units.prod_wt as prod_wt,
 iv_sell_units.tare as tare,
 iv_sell_units.price_unit as price_unit,
 apvend.company1 as vend_name,
 apvend.supplr_no as supplier,
 iv_gtin.gtin as it_gtin,
 cast(round(iif(iv_mast.pk_sell_un = 'KG',
 iv_locat.pk_qtyoh / iv_mast.pk_weight,
 iv_locat.pk_qtyoh) * 2.204621,
 0) as integer) as cases_on_hand,
 
 cast(round(iif(iv_mast.pk_sell_un = 'KG',
 iv_locat.pk_on_ord / iv_mast.pk_weight,
 iv_locat.pk_on_ord) * 2.204621,
 0) as integer) as cases_on_order,
 
 cast(round(iif(iv_mast.pk_sell_un = 'KG',
 iv_locat.pk_allocat / iv_mast.pk_weight,
 iv_locat.pk_allocat) * 2.204621,
 0) as integer) as cases_sold, 
 iv_locat.pk_qtyoh as qtyoh,
 iv_locat.pk_on_ord as qty_on_ord,
 iv_locat.pk_allocat as qty_on_allocat ,
iv_sell_units.factor from ar_ctitm 
 inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
 inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
 inner join iv_locat on iv_locat.refno = iv_mast.refno                    
 inner join apvend on iv_mast.vend_id = apvend.vend_id 
 inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
 ar_ctitm.bc = iv_sell_units.bc and iv_mast.pk_sell_un = iv_sell_units.unit
 left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
 WHERE ar_cthdr.contr_id = '17115'
SELECT 
					journ_no
					,gl_clerk
					,recur_btch
					,hold
					,[date] as journal_date
					,descript
					,batch_no
					,posted
					,reversal
					,rev_of
					FROM gl_journ
					WHERE gl_journ.journ_no = 1758
SELECT 
					journ_no
					,gl_clerk
					,recur_btch
					,hold
					,[date] as journal_date
					,descript
					,batch_no
					,posted
					,reversal
					,rev_of
					FROM gl_journ
					WHERE gl_journ.journ_no = 1769
SELECT 
					journ_no
					,gl_clerk
					,recur_btch
					,hold
					,date as journal_date
					,descript
					,batch_no
					,posted
					,reversal
					,rev_of
					FROM gl_journ
					WHERE gl_journ.journ_no = 1769
SELECT 
					journ_no
					,gl_clerk
					,recur_btch
					,hold
					,date as journal_date
					,descript
					,batch_no
					,posted
					,reversal
					,rev_of
					FROM gl_journ
					WHERE gl_journ.journ_no = 1769
SELECT max(journ_no) FROM gl_journ

SELECT 
ar_cthdr.wh_locat as wh_locat,
ar_cthdr.contr_id as contr_id,
ar_cthdr.descript as ogName,
ar_cthdr.begin_date as og_gen_dt,
ar_cthdr.start_date as og_st_dt,
ar_ctitm.product_id as item_no,
 ar_ctitm.descript as it_desc,
 ar_ctitm.pk_unit as pk_unit,
  ar_ctitm.brand as it_brand,
 ar_ctitm.new_effect as effect_dt,
 ar_ctitm.new_effect as expiry_dt,
 ar_ctitm.price as it_price,
 
 iv_mast.pk_sell_un,
 iv_mast.pk_weight as pack_weight,
  iv_sell_units.factor as pack_weight_factor,
  iv_mast.pk_ctch_wt as has_ctch_wgt,
 iv_mast.vprod_id as vprod_id,
 .t. as primary_vendor_flag,
 cast(icase(iv_mast.inactive,
 'D',
 not iv_mast.inactive and iv_mast.to_be_ord,
 'S',
 'A') as varchar(1)) as item_status_code,
 iv_mast.pk_upc as pk_upc,
iv_mast.iv_class as it_class,
 iv_mast.vend_id as vend_id,
 iv_sell_units.size as pk_size,
 iv_sell_units.unit as it_unit,
 iv_sell_units.prod_wt as prod_wt,
 iv_sell_units.tare as tare,
 iv_sell_units.price_unit as price_unit,
 apvend.company1 as vend_name,
 apvend.supplr_no as supplier,
 iv_gtin.gtin as it_gtin,
 cast(round(iif(iv_mast.pk_sell_un = 'KG',
 iv_locat.pk_qtyoh / iv_mast.pk_weight,
 iv_locat.pk_qtyoh) * 2.204621,
 0) as integer) as cases_on_hand,
 
 cast(round(iif(iv_mast.pk_sell_un = 'KG',
 iv_locat.pk_on_ord / iv_mast.pk_weight,
 iv_locat.pk_on_ord) * 2.204621,
 0) as integer) as cases_on_order,
 
 cast(round(iif(iv_mast.pk_sell_un = 'KG',
 iv_locat.pk_allocat / iv_mast.pk_weight,
 iv_locat.pk_allocat) * 2.204621,
 0) as integer) as cases_sold, 
 iv_locat.pk_qtyoh as qtyoh,
 iv_locat.pk_on_ord as qty_on_ord,
 iv_locat.pk_allocat as qty_on_allocat ,
iv_sell_units.factor from ar_ctitm 
 inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
 inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
 inner join iv_locat on iv_locat.refno = iv_mast.refno                    
 inner join apvend on iv_mast.vend_id = apvend.vend_id 
 inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
 ar_ctitm.bc = iv_sell_units.bc and iv_mast.pk_sell_un = iv_sell_units.unit
 left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
 WHERE ar_cthdr.contr_id = '17115'
SELECT 
                     ar_cthdr.wh_locat as wh_locat,
                     ar_cthdr.contr_id as contr_id,
                     ar_cthdr.descript as ogName,
                     ar_cthdr.begin_date as og_gen_dt,
                     ar_cthdr.start_date as og_st_dt,
                     ar_ctitm.product_id as item_no,
                     ar_ctitm.descript as it_desc,
                     ar_ctitm.pk_unit as pk_unit,
                     ar_ctitm.brand as it_brand,
                     ar_ctitm.new_effect as effect_dt,
                     ar_ctitm.new_effect as expiry_dt,
                     ar_ctitm.price as it_price,
                     iv_mast.pk_sell_un,
                     iv_mast.pk_weight as pack_weight,
                     iv_sell_units.factor as pack_weight_factor,
                     iv_mast.pk_ctch_wt as has_ctch_wgt,
                     iv_mast.vprod_id as vprod_id,
                     .t. as primary_vendor_flag,
                     cast(icase(iv_mast.inactive, 'D', not iv_mast.inactive and iv_mast.to_be_ord,'S','A') as varchar(1)) as item_status_code,
                     iv_mast.pk_upc as pk_upc,
                     iv_mast.iv_class as it_class,
                     iv_mast.vend_id as vend_id,
                     iv_sell_units.size as pk_size,
                     iv_sell_units.unit as it_unit,
                     iv_sell_units.prod_wt as prod_wt,
                     iv_sell_units.tare as tare,
                     iv_sell_units.price_unit as price_unit,
                     apvend.company1 as vend_name,
                     apvend.supplr_no as supplier,
                     iv_gtin.gtin as it_gtin,

                     cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_qtyoh / iv_mast.pk_weight, iv_locat.pk_qtyoh) * 2.204621, 0) as integer) as cases_on_hand,
                     cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_on_ord / iv_mast.pk_weight, iv_locat.pk_on_ord) * 2.204621, 0) as integer) as cases_on_order,
                     cast(round(iif(iv_mast.pk_sell_un = 'KG', iv_locat.pk_allocat / iv_mast.pk_weight, iv_locat.pk_allocat) * 2.204621, 0) as integer) as cases_sold, 

                     iv_locat.pk_qtyoh as qtyoh,
                     iv_locat.pk_on_ord as qty_on_ord,
                     iv_locat.pk_allocat as qty_on_allocat,
                     iv_sell_units.factor 

                     from ar_ctitm 
                     inner join ar_cthdr on ar_ctitm.refno = ar_cthdr.refno 
                     inner join iv_mast on ar_ctitm.product_id = iv_mast.product_id 
                     inner join iv_locat on iv_locat.refno = iv_mast.refno                    
                     inner join apvend on iv_mast.vend_id = apvend.vend_id 
                     inner join iv_sell_units on ar_ctitm.product_id = iv_sell_units.product_id and 
                     ar_ctitm.bc = iv_sell_units.bc and iv_mast.pk_sell_un = iv_sell_units.unit
                     left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 
                     WHERE ar_cthdr.contr_id =  '17115'
select ap_pohdr.pono,   
ap_pohdr.vend_id,   
ap_pohdr.supplr_no,   
                ap_pohdr.closed as po_closed_date,   
                ap_pohdr.issued as po_issued_date, 
                ap_pohdr.re_open as po_re_open_date,  
ap_pohdr.cancelled as po_cancelled_date,   ap_pohdr.date as po_creation_date,   ap_pohdr.req_date as po_schedule_receipt_date, ap_pohdr.req_date as po_actual_receipt_date, apvend.company1 as vendor_name,   apsupplr.company1 as vendor_pickup_warehouse_name,   apsupplr.address1 as vendor_pickup_warehouse_address1,   apsupplr.address2 as vendor_pickup_warehouse_address2,   apsupplr.city as vendor_pickup_warehouse_city,  apsupplr.province as vendor_pickup_warehouse_state,  apsupplr.postcode as vendor_pickup_warehouse_zip, ap_poitm.product_id as item_number,   iv_mast.descript as item_description_long,   iv_mast.pk_size as item_pack_size,   iv_mast.iv_class as it_class,   iv_mast.pk_upc as pk_upc,   iv_gtin.gtin as it_gtin,  cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,  cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621,ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity,   cast(0 as integer) as po_cancelled_quantity, cast(ap_poitm.amount as numeric(9, 4)) as product_price,    cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name from ap_poitm inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno inner join iv_mast on iv_mast.product_id = ap_poitm.product_id inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 	inner join apsupplr on apsupplr.refno = apvend.refno left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id where  ap_poitm.product_id = '265688'
select ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,
   ap_pohdr.closed as po_closed_date,
   ap_pohdr.issued as po_issued_date,
   ap_pohdr.re_open as po_re_open_date,
  ap_pohdr.cancelled as po_cancelled_date,
   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
 ap_pohdr.req_date as po_actual_receipt_date,
 apvend.company1 as vendor_name,
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
  apsupplr.province as vendor_pickup_warehouse_state,
  apsupplr.postcode as vendor_pickup_warehouse_zip,
 ap_poitm.product_id as item_number,
   iv_mast.descript as item_description_long,
   iv_mast.pk_size as item_pack_size,
   iv_mast.iv_class as it_class,
   iv_mast.pk_upc as pk_upc,
   iv_gtin.gtin as it_gtin,
  cast(round(iif(ap_poitm.ord_unit = 'KG',
 (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621,
 ap_poitm.ord_qty),
 0) as integer) as po_order_quantit,
  cast(round(iif(ap_poitm.ord_unit = 'KG',
 (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621,
ap_poitm.rec_qty),
 0) as integer) as po_receipt_quantity,
   cast(0 as integer) as po_cancelled_quantity,
 cast(ap_poitm.amount as numeric(9,
 4)) as product_price,
    cast(round(iif(iv_mast.pk_ctch_wt,
 ap_poitm.ord_qty_lb,
 0),
 0) as integer) as po_catch_weight,
 cast(round(ap_pohdr.cube_total * 3.2808399,
 0) as integer) as po_total_cube,
  cast(icase(iv_mast.bc_factor <> 0,
 int(iv_mast.bc_factor),
 1) as integer) as units_per_case,
  cast(round(iif(iv_mast.pk_tare_wt <> 0,
 (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621,
 0),
 4) as numeric(9,
 4)) as gross_case_weight,
  cast(round(iif(iv_mast.pk_tare_wt <> 0,
 0,
 iv_mast.pk_weight * 2.204621),
 4) as numeric(9,
 4)) as net_case_weight,
  icase(iv_mast.pk_sell_un = 'KG',
 'LB',
 iv_mast.pk_sell_un) as stocking_unit_of_measure,
 cast(round(iif(ap_pohdr.lb_prefer,
 ap_pohdr.wt_total,
 ap_pohdr.wt_total * 2.204621),
 0) as integer) as po_total_weight,
 iv_mast.vprod_id as vprod_id,
iv_mast.brand as item_brand_name from ap_poitm inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno inner join iv_mast on iv_mast.product_id = ap_poitm.product_id inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 	inner join apsupplr on apsupplr.refno = apvend.refno left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id where  ap_poitm.product_id = '364138'
select ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,
   apsupplr.supplr_no as apVendSupno,
   ap_pohdr.closed as po_closed_date,
   ap_pohdr.issued as po_issued_date,
   ap_pohdr.re_open as po_re_open_date,
  ap_pohdr.cancelled as po_cancelled_date,
   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
 ap_pohdr.req_date as po_actual_receipt_date,
 apvend.company1 as vendor_name,
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
  apsupplr.province as vendor_pickup_warehouse_state,
  apsupplr.postcode as vendor_pickup_warehouse_zip,
 ap_poitm.product_id as item_number,
   iv_mast.descript as item_description_long,
   iv_mast.pk_size as item_pack_size,
   iv_mast.iv_class as it_class,
   iv_mast.pk_upc as pk_upc,
   iv_gtin.gtin as it_gtin,
  cast(round(iif(ap_poitm.ord_unit = 'KG',
 (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621,
 ap_poitm.ord_qty),
 0) as integer) as po_order_quantit,
  cast(round(iif(ap_poitm.ord_unit = 'KG',
 (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621,
ap_poitm.rec_qty),
 0) as integer) as po_receipt_quantity,
   cast(0 as integer) as po_cancelled_quantity,
 cast(ap_poitm.amount as numeric(9,
 4)) as product_price,
    cast(round(iif(iv_mast.pk_ctch_wt,
 ap_poitm.ord_qty_lb,
 0),
 0) as integer) as po_catch_weight,
 cast(round(ap_pohdr.cube_total * 3.2808399,
 0) as integer) as po_total_cube,
  cast(icase(iv_mast.bc_factor <> 0,
 int(iv_mast.bc_factor),
 1) as integer) as units_per_case,
  cast(round(iif(iv_mast.pk_tare_wt <> 0,
 (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621,
 0),
 4) as numeric(9,
 4)) as gross_case_weight,
  cast(round(iif(iv_mast.pk_tare_wt <> 0,
 0,
 iv_mast.pk_weight * 2.204621),
 4) as numeric(9,
 4)) as net_case_weight,
  icase(iv_mast.pk_sell_un = 'KG',
 'LB',
 iv_mast.pk_sell_un) as stocking_unit_of_measure,
 cast(round(iif(ap_pohdr.lb_prefer,
 ap_pohdr.wt_total,
 ap_pohdr.wt_total * 2.204621),
 0) as integer) as po_total_weight,
 iv_mast.vprod_id as vprod_id,
iv_mast.brand as item_brand_name from ap_poitm 
inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 	
inner join apsupplr on apsupplr.refno = apvend.refno 
left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id 
where  ap_poitm.product_id = '364138'
select ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,
   apsupplr.supplr_no as apVendSupno,
   ap_pohdr.closed as po_closed_date,
   ap_pohdr.issued as po_issued_date,
   ap_pohdr.re_open as po_re_open_date,
  ap_pohdr.cancelled as po_cancelled_date,
   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
 ap_pohdr.req_date as po_actual_receipt_date,
 apvend.company1 as vendor_name,
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
  apsupplr.province as vendor_pickup_warehouse_state,
  apsupplr.postcode as vendor_pickup_warehouse_zip,
 ap_poitm.product_id as item_number,
   iv_mast.descript as item_description_long,
   iv_mast.pk_size as item_pack_size,
   iv_mast.iv_class as it_class,
   iv_mast.pk_upc as pk_upc,
   iv_gtin.gtin as it_gtin,
  cast(round(iif(ap_poitm.ord_unit = 'KG',
 (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621,
 ap_poitm.ord_qty),
 0) as integer) as po_order_quantit,
  cast(round(iif(ap_poitm.ord_unit = 'KG',
 (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621,
ap_poitm.rec_qty),
 0) as integer) as po_receipt_quantity,
   cast(0 as integer) as po_cancelled_quantity,
 cast(ap_poitm.amount as numeric(9,
 4)) as product_price,
    cast(round(iif(iv_mast.pk_ctch_wt,
 ap_poitm.ord_qty_lb,
 0),
 0) as integer) as po_catch_weight,
 cast(round(ap_pohdr.cube_total * 3.2808399,
 0) as integer) as po_total_cube,
  cast(icase(iv_mast.bc_factor <> 0,
 int(iv_mast.bc_factor),
 1) as integer) as units_per_case,
  cast(round(iif(iv_mast.pk_tare_wt <> 0,
 (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621,
 0),
 4) as numeric(9,
 4)) as gross_case_weight,
  cast(round(iif(iv_mast.pk_tare_wt <> 0,
 0,
 iv_mast.pk_weight * 2.204621),
 4) as numeric(9,
 4)) as net_case_weight,
  icase(iv_mast.pk_sell_un = 'KG',
 'LB',
 iv_mast.pk_sell_un) as stocking_unit_of_measure,
 cast(round(iif(ap_pohdr.lb_prefer,
 ap_pohdr.wt_total,
 ap_pohdr.wt_total * 2.204621),
 0) as integer) as po_total_weight,
 iv_mast.vprod_id as vprod_id,
iv_mast.brand as item_brand_name from ap_poitm 
inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 	
inner join apsupplr on apsupplr.refno = apvend.refno 
left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id 
where  ap_poitm.product_id = '364138'
select ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,
   apsupplr.supplr_no as apVendSupno,
   ap_pohdr.closed as po_closed_date,
   ap_pohdr.issued as po_issued_date,
   ap_pohdr.re_open as po_re_open_date,
  ap_pohdr.cancelled as po_cancelled_date,
   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
 ap_pohdr.req_date as po_actual_receipt_date,
 apvend.company1 as vendor_name,
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
  apsupplr.province as vendor_pickup_warehouse_state,
  apsupplr.postcode as vendor_pickup_warehouse_zip,
 ap_poitm.product_id as item_number,
   iv_mast.descript as item_description_long,
   iv_mast.pk_size as item_pack_size,
   iv_mast.vend_id as vend_id,
   iv_mast.iv_class as it_class,
   iv_mast.pk_upc as pk_upc,
   iv_gtin.gtin as it_gtin,
  cast(round(iif(ap_poitm.ord_unit = 'KG',
 (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621,
 ap_poitm.ord_qty),
 0) as integer) as po_order_quantit,
  cast(round(iif(ap_poitm.ord_unit = 'KG',
 (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621,
ap_poitm.rec_qty),
 0) as integer) as po_receipt_quantity,
   cast(0 as integer) as po_cancelled_quantity,
 cast(ap_poitm.amount as numeric(9,
 4)) as product_price,
    cast(round(iif(iv_mast.pk_ctch_wt,
 ap_poitm.ord_qty_lb,
 0),
 0) as integer) as po_catch_weight,
 cast(round(ap_pohdr.cube_total * 3.2808399,
 0) as integer) as po_total_cube,
  cast(icase(iv_mast.bc_factor <> 0,
 int(iv_mast.bc_factor),
 1) as integer) as units_per_case,
  cast(round(iif(iv_mast.pk_tare_wt <> 0,
 (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621,
 0),
 4) as numeric(9,
 4)) as gross_case_weight,
  cast(round(iif(iv_mast.pk_tare_wt <> 0,
 0,
 iv_mast.pk_weight * 2.204621),
 4) as numeric(9,
 4)) as net_case_weight,
  icase(iv_mast.pk_sell_un = 'KG',
 'LB',
 iv_mast.pk_sell_un) as stocking_unit_of_measure,
 cast(round(iif(ap_pohdr.lb_prefer,
 ap_pohdr.wt_total,
 ap_pohdr.wt_total * 2.204621),
 0) as integer) as po_total_weight,
 iv_mast.vprod_id as vprod_id,
iv_mast.brand as item_brand_name from ap_poitm 
inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 	
inner join apsupplr on apsupplr.refno = apvend.refno 
left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id 
where  ap_poitm.product_id = '364138'
select * from ap_pohdr where pono = '103472'
Select * from ap_porhd where pono = '103472'

Select * from ap_poitm where refno = 103108


Select * from ap_porhd where pono = '103472'

Select * from ap_porhd where pono = '103472'

Select * from ap_poitm where refno = 103108


Select * from ap_pohdr where pono = '103472'

Select * from ap_pohdr where pono = '103472'

Select * from ap_poitm where refno = 539345

select ap_pohdr.pono,
   ap_pohdr.vend_id,
   ap_pohdr.supplr_no,
   apsupplr.supplr_no as apVendSupno,
   ap_pohdr.closed as po_closed_date,
   ap_pohdr.issued as po_issued_date,
   ap_pohdr.re_open as po_re_open_date,
  ap_pohdr.cancelled as po_cancelled_date,
   ap_pohdr.date as po_creation_date,
   ap_pohdr.req_date as po_schedule_receipt_date,
 ap_pohdr.req_date as po_actual_receipt_date,
 apvend.company1 as vendor_name,
   apsupplr.company1 as vendor_pickup_warehouse_name,
   apsupplr.address1 as vendor_pickup_warehouse_address1,
   apsupplr.address2 as vendor_pickup_warehouse_address2,
   apsupplr.city as vendor_pickup_warehouse_city,
  apsupplr.province as vendor_pickup_warehouse_state,
  apsupplr.postcode as vendor_pickup_warehouse_zip,
 ap_poitm.product_id as item_number,
   iv_mast.descript as item_description_long,
   iv_mast.pk_size as item_pack_size,
   iv_mast.iv_class as it_class,
   iv_mast.pk_upc as pk_upc,
iv_sell_units.size as pk_size,
   iv_gtin.gtin as it_gtin,
iv_mast.pk_ctch_wt as has_ctch_wgt,
  
 cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,

  cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621,ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity,

   cast(0 as integer) as po_cancelled_quantity, cast(ap_poitm.amount as numeric(9, 4)) as product_price,

  cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight,
  cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,
  cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,
  cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
  cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
  icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure,
  cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight,
  iv_mast.vprod_id as vprod_id,

iv_mast.brand as item_brand_name 
from ap_poitm 
inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 	
inner join apsupplr on apsupplr.refno = apvend.refno 
inner join iv_sell_units on ap_poitm.product_id = iv_sell_units.product_id and ap_poitm.bc = iv_sell_units.bc and iv_mast.pk_sell_un = iv_sell_units.unit 
left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id 
where  ap_poitm.product_id = '364138'
select 
                ap_pohdr.pono,   
                ap_pohdr.vend_id,  
                apsupplr.supplr_no,
                ap_pohdr.closed as po_closed_date,   
                ap_pohdr.issued as po_issued_date, 
                ap_pohdr.re_open as po_re_open_date,  
                ap_pohdr.cancelled as po_cancelled_date, 
                ap_pohdr.date as po_creation_date,   
                ap_pohdr.req_date as po_schedule_receipt_date, 
                ap_pohdr.req_date as po_actual_receipt_date, 
                apvend.company1 as vendor_name,   
                apsupplr.company1 as vendor_pickup_warehouse_name,   
                apsupplr.address1 as vendor_pickup_warehouse_address1,   
                apsupplr.address2 as vendor_pickup_warehouse_address2,   
                apsupplr.city as vendor_pickup_warehouse_city,  
                apsupplr.province as vendor_pickup_warehouse_state,  
                apsupplr.postcode as vendor_pickup_warehouse_zip, 
                ap_poitm.product_id as item_number,   
                iv_mast.descript as item_description_long,   
                iv_mast.pk_size as item_pack_size,   
                iv_mast.iv_class as it_class, 
                iv_mast.pk_ctch_wt as has_ctch_wgt,  
                iv_mast.pk_upc as pk_upc,   
                iv_gtin.gtin as it_gtin,  
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity, 
                cast(0 as integer) as po_cancelled_quantity, 
                cast(ap_poitm.cost as numeric(9, 4)) as product_price,    
                cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
                cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  
                cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  
                icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, 
                cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, 
                iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name 
                from ap_poitm 
                inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
                inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
                inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
                inner join apsupplr on apsupplr.refno = apvend.refno 
                left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id 
                where ap_poitm.product_id = '364138'
select * from arinvoic

Select * from arinvoic where inv_no like '%1923005%'


Select * from arinvoic where inv_no =1923005

Select * from arinvoic where inv_no =1923005


Select * from arinvoic where inv_no =1922841

Select * from arinvoic where inv_no =1922841

select * from ariitems where refno = 1108021

Select * from arinvoic where inv_no =1922841

select * from ariitems where refno = 1108021

select * from iv_mast where product_id like '%221335%'
select ariitems.wh_locat as dc_warehouse_number, 
          cast(2 as integer) as customer_brand, 
          rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, "@L 99999") as customer_number, 
          arcshpto.company1 as customer_name, 
          arcshpto.address1 as customer_address1, 
          arcshpto.address2 as customer_address2, 
          arcshpto.city as customer_city, 
          arcshpto.province as customer_state, 
          arcshpto.postcode as customer_postcode, 
          cast("" as varchar(6)) as brand_store_number, 
          arcust.contr_id as order_guide_customer_group_number, 
          left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date, 
          left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date, 
          left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date, 
          arinvoic.inv_no as customer_invoice_number, 
          ariitems.item as invoice_line_number, 
          ariitems.product_id as dc_invoice_item, 
          iv_mast.descript as item_descript_long, 
          iv_mast.pk_size as item_pack_size, 
          iv_mast.vprod_id as manufacture_item_number, 
          cast("" as varchar(14)) as upc, 
          cast("" as varchar(14)) as gtin, 
          iv_mast.brand as item_brand_name, 
          cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case, 
          cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight, 
          cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight, 
          icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure, 
          cast(nvl(icase(rtrim(iv_type.descript) = "DRY", "D", 
              rtrim(iv_type.descript) = "FROZEN", "F", 
              rtrim(iv_type.descript) = "FRESH", "R", ""), "") as varchar(1)) as temperature_protection_code, 
          cast(iif(ariitems.shp_unit = "KG", 
              ariitems.ord_qty * 2.204621, 
              icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty)) 
              as numeric(9, 4)) as case_ordered_quantity, 
          cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight, 
          cast(iif(ariitems.shp_unit = "KG", 
              ariitems.ord_qty * 2.204621, 
              icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty)) 
              as numeric(9, 4)) as cases_delivered_or_returned, 
          cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4) 
              as numeric(9, 4)) as case_price, 
          ariitems.amount as extended_price, 
          cast(0 as numeric(9, 4)) as tax, 
          arinvoic.inv_no as credit_memo_number 
     from arinvoic 
     inner join ariitems on ariitems.refno = arinvoic.refno 
     inner join iv_mast on iv_mast.product_id = ariitems.product_id 
     inner join arcust on arcust.refno = arinvoic.cust_no 
     inner join arcshpto on arcshpto.refno = arinvoic.cust_no 
          and arcshpto.shipto_no = arinvoic.shipto_no 
     left join iv_type on iv_type.iv_type = iv_mast.iv_type 
     where not ariitems.comment 
          and not ariitems.deposit 
          and not ariitems.allowance 
          and arinvoic.refno = 1108021


select ariitems.wh_locat as dc_warehouse_number,
           cast(2 as integer) as customer_brand,
           rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, "@L 99999") as customer_number,
           arcshpto.company1 as customer_name,
           arcshpto.address1 as customer_address1,
           arcshpto.address2 as customer_address2,
           arcshpto.city as customer_city,
           arcshpto.province as customer_state,
           arcshpto.postcode as customer_postcode,
           cast("" as varchar(6)) as brand_store_number,
           arcust.contr_id as order_guide_customer_group_number,
           left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
           left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
           left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
           arinvoic.inv_no as customer_invoice_number,
           ariitems.item as invoice_line_number,
           ariitems.product_id as dc_invoice_item,
           iv_mast.descript as item_descript_long,
           iv_mast.pk_size as item_pack_size,
           iv_mast.vprod_id as manufacture_item_number,
           cast("" as varchar(14)) as upc,  cast("" as varchar(14)) as gtin,
           iv_mast.brand as item_brand_name,
           cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,
           cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
           cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure,
           cast(nvl(icase(rtrim(iv_type.descript) = "DRY", "D", rtrim(iv_type.descript) = "FROZEN", "F",  rtrim(iv_type.descript) = "FRESH", "R", ""), "") as varchar(1)) as temperature_protection_code,
           cast(iif(ariitems.shp_unit = "KG",  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,
           cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,
           cast(iif(ariitems.shp_unit = "KG",   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,
           cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,
           ariitems.amount as extended_price,   cast(0 as numeric(9, 4)) as tax,
           arinvoic.inv_no as credit_memo_number      from arinvoic
           inner join ariitems on ariitems.refno = arinvoic.refno     
           inner join iv_mast on iv_mast.product_id = ariitems.product_id      
           inner join arcust on arcust.refno = arinvoic.cust_no      
           inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 
            left join iv_type on iv_type.iv_type = iv_mast.iv_type  
           where not ariitems.comment           and not ariitems.deposit           and not ariitems.allowance           and arinvoic.refno = 1108021
select ariitems.wh_locat as dc_warehouse_number,
           cast(2 as integer) as customer_brand,
           rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, "@L 99999") as customer_number,
           arcshpto.company1 as customer_name,
           arcshpto.address1 as customer_address1,
           arcshpto.address2 as customer_address2,
           arcshpto.city as customer_city,
           arcshpto.province as customer_state,
           arcshpto.postcode as customer_postcode,
           cast("" as varchar(6)) as brand_store_number,
           arcust.contr_id as order_guide_customer_group_number,
           left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
           left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
           left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
           arinvoic.inv_no as customer_invoice_number,
           ariitems.item as invoice_line_number,
           ariitems.product_id as dc_invoice_item,
           iv_mast.descript as item_descript_long,
           iv_mast.pk_size as item_pack_size,
           iv_mast.pk_ctch_wt as has_ctch_wgt,
           iv_mast.vprod_id as manufacture_item_number,
           cast("" as varchar(14)) as upc,  cast("" as varchar(14)) as gtin,
           iv_mast.brand as item_brand_name,
           cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,
           cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
           cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure,
           cast(nvl(icase(rtrim(iv_type.descript) = "DRY", "D", rtrim(iv_type.descript) = "FROZEN", "F",  rtrim(iv_type.descript) = "FRESH", "R", ""), "") as varchar(1)) as temperature_protection_code,
           cast(iif(ariitems.shp_unit = "KG",  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,
           cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,
           cast(iif(ariitems.shp_unit = "KG",   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,
           cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,
           ariitems.amount as extended_price,   cast(0 as numeric(9, 4)) as tax,
           arinvoic.inv_no as credit_memo_number      from arinvoic
           inner join ariitems on ariitems.refno = arinvoic.refno     
           inner join iv_mast on iv_mast.product_id = ariitems.product_id      
           inner join arcust on arcust.refno = arinvoic.cust_no      
           inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 
            left join iv_type on iv_type.iv_type = iv_mast.iv_type  
           where not ariitems.comment           and not ariitems.deposit           and not ariitems.allowance           and arinvoic.refno = 1108021
select ariitems.wh_locat as dc_warehouse_number,
           cast(2 as integer) as customer_brand,
           rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, "@L 99999") as customer_number,
           arcshpto.company1 as customer_name,
           arcshpto.address1 as customer_address1,
           arcshpto.address2 as customer_address2,
           arcshpto.city as customer_city,
           arcshpto.province as customer_state,
           arcshpto.postcode as customer_postcode,
           cast("" as varchar(6)) as brand_store_number,
           arcust.contr_id as order_guide_customer_group_number,
           left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
           left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
           left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
           arinvoic.inv_no as customer_invoice_number,
           ariitems.item as invoice_line_number,
           ariitems.product_id as dc_invoice_item,
           iv_mast.descript as item_descript_long,
           iv_mast.pk_size as item_pack_size,
           iv_mast.pk_ctch_wt as has_ctch_wgt,
           iv_mast.vprod_id as manufacture_item_number,
           cast("" as varchar(14)) as upc,  cast("" as varchar(14)) as gtin,
           iv_mast.brand as item_brand_name,
           cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,
           cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
           cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure,
           cast(nvl(icase(rtrim(iv_type.descript) = "DRY", "D", rtrim(iv_type.descript) = "FROZEN", "F",  rtrim(iv_type.descript) = "FRESH", "R", ""), "") as varchar(1)) as temperature_protection_code,
           cast(iif(ariitems.shp_unit = "KG",  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,
           cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,
           cast(iif(ariitems.shp_unit = "KG",   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,
           cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,
           ariitems.amount as extended_price,   cast(0 as numeric(9, 4)) as tax,
           arinvoic.inv_no as credit_memo_number      from arinvoic
           inner join ariitems on ariitems.refno = arinvoic.refno     
           inner join iv_mast on iv_mast.product_id = ariitems.product_id      
           inner join arcust on arcust.refno = arinvoic.cust_no      
           inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 
            left join iv_type on iv_type.iv_type = iv_mast.iv_type  
           where not ariitems.comment           and not ariitems.deposit           and not ariitems.allowance           and arinvoic.refno = 1108021
select ariitems.wh_locat as dc_warehouse_number,
           cast(2 as integer) as customer_brand,
           rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, "@L 99999") as customer_number,
           arcshpto.company1 as customer_name,
           arcshpto.address1 as customer_address1,
           arcshpto.address2 as customer_address2,
           arcshpto.city as customer_city,
           arcshpto.province as customer_state,
           arcshpto.postcode as customer_postcode,
           cast("" as varchar(6)) as brand_store_number,
           arcust.contr_id as order_guide_customer_group_number,
           left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
           left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
           left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
           arinvoic.inv_no as customer_invoice_number,
           ariitems.item as invoice_line_number,
           ariitems.product_id as dc_invoice_item,
           iv_mast.descript as item_descript_long,
           iv_mast.pk_size as item_pack_size,
           iv_mast.pk_ctch_wt as has_ctch_wgt,
           iv_mast.vprod_id as manufacture_item_number,
           iv_mast.iv_class as it_class,
           cast("" as varchar(14)) as upc,  cast("" as varchar(14)) as gtin,
           iv_mast.brand as item_brand_name,
           cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,
           cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
           cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure,
           cast(nvl(icase(rtrim(iv_type.descript) = "DRY", "D", rtrim(iv_type.descript) = "FROZEN", "F",  rtrim(iv_type.descript) = "FRESH", "R", ""), "") as varchar(1)) as temperature_protection_code,
           cast(iif(ariitems.shp_unit = "KG",  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,
           cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,
           cast(iif(ariitems.shp_unit = "KG",   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,
           cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,
           ariitems.amount as extended_price,   cast(0 as numeric(9, 4)) as tax,
           arinvoic.inv_no as credit_memo_number      from arinvoic
           inner join ariitems on ariitems.refno = arinvoic.refno     
           inner join iv_mast on iv_mast.product_id = ariitems.product_id      
           inner join arcust on arcust.refno = arinvoic.cust_no      
           inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 
            left join iv_type on iv_type.iv_type = iv_mast.iv_type  
           where not ariitems.comment           and not ariitems.deposit           and not ariitems.allowance           and arinvoic.refno = 1108021
select ariitems.wh_locat as dc_warehouse_number,
           cast(2 as integer) as customer_brand,
           rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, "@L 99999") as customer_number,
           arcshpto.company1 as customer_name,
           arcshpto.address1 as customer_address1,
           arcshpto.address2 as customer_address2,
           arcshpto.city as customer_city,
           arcshpto.province as customer_state,
           arcshpto.postcode as customer_postcode,
           cast("" as varchar(6)) as brand_store_number,
           arcust.contr_id as order_guide_customer_group_number,
           left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
           left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
           left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
           arinvoic.inv_no as customer_invoice_number,
           ariitems.item as invoice_line_number,
           ariitems.product_id as dc_invoice_item,
           iv_mast.descript as item_descript_long,
           iv_mast.pk_size as item_pack_size,
           iv_mast.pk_ctch_wt as has_ctch_wgt,
           iv_mast.vprod_id as manufacture_item_number,
           iv_mast.iv_class as it_class,
           iv_mast.vend_id as vend_id,
           cast("" as varchar(14)) as upc,  cast("" as varchar(14)) as gtin,
           iv_mast.brand as item_brand_name,
           cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,
           cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
           cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure,
           cast(nvl(icase(rtrim(iv_type.descript) = "DRY", "D", rtrim(iv_type.descript) = "FROZEN", "F",  rtrim(iv_type.descript) = "FRESH", "R", ""), "") as varchar(1)) as temperature_protection_code,
           cast(iif(ariitems.shp_unit = "KG",  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,
           cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,
           cast(iif(ariitems.shp_unit = "KG",   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,
           cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,
           ariitems.amount as extended_price,   cast(0 as numeric(9, 4)) as tax,
           arinvoic.inv_no as credit_memo_number      from arinvoic
           inner join ariitems on ariitems.refno = arinvoic.refno     
           inner join iv_mast on iv_mast.product_id = ariitems.product_id      
           inner join arcust on arcust.refno = arinvoic.cust_no      
           inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 
            left join iv_type on iv_type.iv_type = iv_mast.iv_type  
           where not ariitems.comment           and not ariitems.deposit           and not ariitems.allowance           and arinvoic.refno = 1108021
select ariitems.wh_locat as dc_warehouse_number,
           cast(2 as integer) as customer_brand,
           rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, "@L 99999") as customer_number,
           arcshpto.company1 as customer_name,
           arcshpto.address1 as customer_address1,
           arcshpto.address2 as customer_address2,
           arcshpto.city as customer_city,
           arcshpto.province as customer_state,
           arcshpto.postcode as customer_postcode,
           cast("" as varchar(6)) as brand_store_number,
           arcust.contr_id as order_guide_customer_group_number,
           left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
           left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
           left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
           arinvoic.inv_no as customer_invoice_number,
           ariitems.item as invoice_line_number,
           ariitems.product_id as dc_invoice_item,
           iv_mast.descript as item_descript_long,
           iv_mast.pk_size as item_pack_size,
           iv_mast.pk_ctch_wt as has_ctch_wgt,
           iv_mast.vprod_id as manufacture_item_number,
           iv_mast.iv_class as it_class,
           iv_mast.vend_id as vend_id,
           apvend.company1 as vend_name,
           cast("" as varchar(14)) as upc,  cast("" as varchar(14)) as gtin,
           iv_mast.brand as item_brand_name,
           cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,
           cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
           cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure,
           cast(nvl(icase(rtrim(iv_type.descript) = "DRY", "D", rtrim(iv_type.descript) = "FROZEN", "F",  rtrim(iv_type.descript) = "FRESH", "R", ""), "") as varchar(1)) as temperature_protection_code,
           cast(iif(ariitems.shp_unit = "KG",  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,
           cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,
           cast(iif(ariitems.shp_unit = "KG",   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,
           cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,
           ariitems.amount as extended_price,   cast(0 as numeric(9, 4)) as tax,
           arinvoic.inv_no as credit_memo_number      from arinvoic
           inner join ariitems on ariitems.refno = arinvoic.refno     
           inner join iv_mast on iv_mast.product_id = ariitems.product_id    
           inner join apvend on iv_mast.vend_id = apvend.vend_id   
           inner join arcust on arcust.refno = arinvoic.cust_no      
           inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 
            left join iv_type on iv_type.iv_type = iv_mast.iv_type  
           where not ariitems.comment           and not ariitems.deposit           and not ariitems.allowance           and arinvoic.refno = 1108021
select ariitems.wh_locat as dc_warehouse_number,
           cast(2 as integer) as customer_brand,
           rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, "@L 99999") as customer_number,
           arcshpto.company1 as customer_name,
           arcshpto.address1 as customer_address1,
           arcshpto.address2 as customer_address2,
           arcshpto.city as customer_city,
           arcshpto.province as customer_state,
           arcshpto.postcode as customer_postcode,
           cast("" as varchar(6)) as brand_store_number,
           arcust.contr_id as order_guide_customer_group_number,
           left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
           left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
           left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
           arinvoic.inv_no as customer_invoice_number,
           ariitems.item as invoice_line_number,
           ariitems.product_id as dc_invoice_item,
           iv_mast.descript as item_descript_long,
           iv_mast.pk_size as item_pack_size,
           iv_mast.pk_ctch_wt as has_ctch_wgt,
           iv_mast.vprod_id as manufacture_item_number,
           iv_mast.iv_class as it_class,
           iv_mast.vend_id as vend_id,
           apvend.company1 as vend_name,
           cast("" as varchar(14)) as upc,  cast("" as varchar(14)) as gtin,
           iv_mast.brand as item_brand_name,
           cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,
           cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
           cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure,
           cast(nvl(icase(rtrim(iv_mast.iv_class) = "DRY", "D", rtrim(iv_type.descript) = "FROZEN", "F",  rtrim(iv_type.descript) = "FRESH", "R", ""), "") as varchar(1)) as temperature_protection_code,
           cast(iif(ariitems.shp_unit = "KG",  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,
           cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,
           cast(iif(ariitems.shp_unit = "KG",   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,
           cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,
           ariitems.amount as extended_price,   cast(0 as numeric(9, 4)) as tax,
           arinvoic.inv_no as credit_memo_number      from arinvoic
           inner join ariitems on ariitems.refno = arinvoic.refno     
           inner join iv_mast on iv_mast.product_id = ariitems.product_id    
           inner join apvend on iv_mast.vend_id = apvend.vend_id   
           inner join arcust on arcust.refno = arinvoic.cust_no      
           inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 
            left join iv_type on iv_type.iv_type = iv_mast.iv_type  
           where not ariitems.comment           
           and not ariitems.deposit           
           and not ariitems.allowance           
           and arinvoic.refno = 1108021
select ariitems.wh_locat as dc_warehouse_number,
           cast(2 as integer) as customer_brand,
           rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, "@L 99999") as customer_number,
           arcshpto.company1 as customer_name,
           arcshpto.address1 as customer_address1,
           arcshpto.address2 as customer_address2,
           arcshpto.city as customer_city,
           arcshpto.province as customer_state,
           arcshpto.postcode as customer_postcode,
           cast("" as varchar(6)) as brand_store_number,
           arcust.contr_id as order_guide_customer_group_number,
           left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
           left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
           left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
           arinvoic.inv_no as customer_invoice_number,
           ariitems.item as invoice_line_number,
           ariitems.product_id as dc_invoice_item,
           iv_mast.descript as item_descript_long,
           iv_mast.pk_size as item_pack_size,
           iv_mast.pk_ctch_wt as has_ctch_wgt,
           iv_mast.vprod_id as manufacture_item_number,
           iv_mast.iv_class as it_class,
           iv_mast.vend_id as vend_id,
           apvend.company1 as vend_name,
           cast("" as varchar(14)) as upc,  cast("" as varchar(14)) as gtin,
           iv_mast.brand as item_brand_name,
           cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,
           cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
           cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure,

           cast(nvl(icase(rtrim(iv_mast.iv_class) = "DRY", "D", rtrim(iv_type.descript) = "FROZEN", "F",  rtrim(iv_type.descript) = "FRESH", "R", ""), "") as varchar(1)) as temperature_protection_code,

           cast(iif(ariitems.shp_unit = "KG",  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

           cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

           cast(iif(ariitems.shp_unit = "KG",   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

           cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

           ariitems.amount as extended_price,   cast(0 as numeric(9, 4)) as tax,

           arinvoic.inv_no as credit_memo_number 

           from arinvoic
          
            inner join ariitems on ariitems.refno = arinvoic.refno     
           inner join iv_mast on iv_mast.product_id = ariitems.product_id    
           inner join apvend on iv_mast.vend_id = apvend.vend_id   
           inner join arcust on arcust.refno = arinvoic.cust_no      
           inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 
            left join iv_type on iv_type.iv_type = iv_mast.iv_type  
           where not ariitems.comment           
           and not ariitems.deposit           
           and not ariitems.allowance           
           and arinvoic.refno = 1108021
Select * from arinvoic where inv_no =1922841

select * from ariitems where refno = 1108021

select * from iv_mast where product_id like '%255782%'


select ariitems.wh_locat as dc_warehouse_number,
           cast(2 as integer) as customer_brand,
           rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, "@L 99999") as customer_number,
           arcshpto.company1 as customer_name,
           arcshpto.address1 as customer_address1,
           arcshpto.address2 as customer_address2,
           arcshpto.city as customer_city,
           arcshpto.province as customer_state,
           arcshpto.postcode as customer_postcode,
           cast("" as varchar(6)) as brand_store_number,
           arcust.contr_id as order_guide_customer_group_number,
           left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
           left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
           left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
           arinvoic.inv_no as customer_invoice_number,
           ariitems.item as invoice_line_number,
           ariitems.product_id as dc_invoice_item,
           iv_mast.descript as item_descript_long,
           iv_mast.pk_size as item_pack_size,
           iv_mast.pk_ctch_wt as has_ctch_wgt,
           iv_mast.vprod_id as manufacture_item_number,
           iv_mast.iv_class as it_class,
           iv_mast.vend_id as vend_id,
           apvend.company1 as vend_name,
           cast("" as varchar(14)) as upc,  cast("" as varchar(14)) as gtin,
           iv_mast.brand as item_brand_name,
           cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure,

           cast(nvl(icase(rtrim(iv_mast.iv_class) = "DRY", "D", rtrim(iv_type.descript) = "FROZEN", "F",  rtrim(iv_type.descript) = "FRESH", "R", ""), "") as varchar(1)) as temperature_protection_code,

           cast(iif(ariitems.shp_unit = "KG",  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

           cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

           cast(iif(ariitems.shp_unit = "KG",   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

           cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

           ariitems.amount as extended_price,   

          cast( (ariitems.amount*7*5) as numeric(9, 4)) as tax,

           arinvoic.inv_no as credit_memo_number 

           from arinvoic
          
            inner join ariitems on ariitems.refno = arinvoic.refno     

           inner join iv_mast on iv_mast.product_id = ariitems.product_id    

           inner join apvend on iv_mast.vend_id = apvend.vend_id   

           inner join arcust on arcust.refno = arinvoic.cust_no      

           inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

            left join iv_type on iv_type.iv_type = iv_mast.iv_type  

           where not ariitems.comment           
           and not ariitems.deposit           
           and not ariitems.allowance           
           and arinvoic.refno = 1108021
select ariitems.wh_locat as dc_warehouse_number,
           cast(2 as integer) as customer_brand,
           rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, "@L 99999") as customer_number,
           arcshpto.company1 as customer_name,
           arcshpto.address1 as customer_address1,
           arcshpto.address2 as customer_address2,
           arcshpto.city as customer_city,
           arcshpto.province as customer_state,
           arcshpto.postcode as customer_postcode,
           cast("" as varchar(6)) as brand_store_number,
           arcust.contr_id as order_guide_customer_group_number,
           left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
           left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
           left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
           arinvoic.inv_no as customer_invoice_number,
           ariitems.item as invoice_line_number,
           ariitems.product_id as dc_invoice_item,
           iv_mast.descript as item_descript_long,
           iv_mast.pk_size as item_pack_size,
           iv_mast.pk_ctch_wt as has_ctch_wgt,
           iv_mast.vprod_id as manufacture_item_number,
           iv_mast.iv_class as it_class,
           iv_mast.vend_id as vend_id,
           apvend.company1 as vend_name,
           cast("" as varchar(14)) as upc,  cast("" as varchar(14)) as gtin,
           iv_mast.brand as item_brand_name,
           cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure,

           cast(nvl(icase(rtrim(iv_mast.iv_class) = "DRY", "D", rtrim(iv_type.descript) = "FROZEN", "F",  rtrim(iv_type.descript) = "FRESH", "R", ""), "") as varchar(1)) as temperature_protection_code,

           cast(iif(ariitems.shp_unit = "KG",  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

           cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

           cast(iif(ariitems.shp_unit = "KG",   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

           cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

           ariitems.amount as extended_price,   

          cast( ((ariitems.amount*7*5)/100) as numeric(9, 4)) as tax,

           arinvoic.inv_no as credit_memo_number 

           from arinvoic
          
            inner join ariitems on ariitems.refno = arinvoic.refno     

           inner join iv_mast on iv_mast.product_id = ariitems.product_id    

           inner join apvend on iv_mast.vend_id = apvend.vend_id   

           inner join arcust on arcust.refno = arinvoic.cust_no      

           inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

            left join iv_type on iv_type.iv_type = iv_mast.iv_type  

           where not ariitems.comment           
           and not ariitems.deposit           
           and not ariitems.allowance           
           and arinvoic.refno = 1108021
select ariitems.wh_locat as dc_warehouse_number,
           cast(2 as integer) as customer_brand,
           rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, "@L 99999") as customer_number,
           arcshpto.company1 as customer_name,
           arcshpto.address1 as customer_address1,
           arcshpto.address2 as customer_address2,
           arcshpto.city as customer_city,
           arcshpto.province as customer_state,
           arcshpto.postcode as customer_postcode,
           cast("" as varchar(6)) as brand_store_number,
           arcust.contr_id as order_guide_customer_group_number,
           left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
           left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
           left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
           arinvoic.inv_no as customer_invoice_number,
           ariitems.item as invoice_line_number,
           ariitems.product_id as dc_invoice_item,
           iv_mast.descript as item_descript_long,
           iv_mast.pk_size as item_pack_size,
           iv_mast.pk_ctch_wt as has_ctch_wgt,
           iv_mast.vprod_id as manufacture_item_number,
           iv_mast.iv_class as it_class,
           iv_mast.vend_id as vend_id,
           apvend.company1 as vend_name,
           cast("" as varchar(14)) as upc,  cast("" as varchar(14)) as gtin,
           iv_mast.brand as item_brand_name,
           cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure,

           cast(nvl(icase(rtrim(iv_mast.iv_class) = "DRY", "D", rtrim(iv_type.descript) = "FROZEN", "F",  rtrim(iv_type.descript) = "FRESH", "R", ""), "") as varchar(1)) as temperature_protection_code,

           cast(iif(ariitems.shp_unit = "KG",  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

           cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

           cast(iif(ariitems.shp_unit = "KG",   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

           cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

           ariitems.amount as extended_price,   

          cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,

           arinvoic.inv_no as credit_memo_number 

           from arinvoic
          
            inner join ariitems on ariitems.refno = arinvoic.refno     

           inner join iv_mast on iv_mast.product_id = ariitems.product_id    

           inner join apvend on iv_mast.vend_id = apvend.vend_id   

           inner join arcust on arcust.refno = arinvoic.cust_no      

           inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

            left join iv_type on iv_type.iv_type = iv_mast.iv_type  

           where not ariitems.comment           
           and not ariitems.deposit           
           and not ariitems.allowance           
           and arinvoic.refno = 1108021
Select * from arinvoic where inv_date = {01/31/2018}

Select * from arinvoic where inv_date = {01/31/2018} and cust_id = '%171155%'

Select * from arinvoic where inv_date <= {01/31/2018} and cust_id = '%171155%'

Select * from arinvoic where inv_date <= {01/31/2018} and cust_id = '559846%'

Select * from arinvoic where inv_date <= {01/31/2018} and cust_id = '%559846%'

Select * from arinvoic where inv_date = {01/31/2018} and cust_id = '%559846%'

Select * from arinvoic where  cust_id = '%559846%'

Select * from arinvoic where  cust_id like '%559846%'

Select * from arinvoic where inv_date = {01/31/2018} and cust_id like '%559846%'

Select * from arinvoic where inv_date <= {01/31/2018} and cust_id like '%559846%'

Select * from arinvoic where inv_date <= {01/31/2018} and cust_id like '%171155%'

Select * from arinvoic where inv_date = {01/31/2018} and cust_id like '%171155%'

Select * from arinvoic where inv_date = {01/31/2018} and cust_id = '171155'

Select * from arinvoic where inv_date = {01/31/2018} and cust_id like '%171155%'

Select * from arinvoic where inv_date = {01/31/2018} and cust_id = '171155'

Select * from arinvoic where inv_date = {01/31/2018} and cust_id like '%171155%'

Select * from arinvoic where inv_date = {01/31/2018} and cust_id = '171155'

Select inv_no from arinvoic where inv_date = {01/31/2018} and cust_id = '171155'


select ariitems.wh_locat as dc_warehouse_number,
           cast(2 as integer) as customer_brand,
           rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, "@L 99999") as customer_number,
           arcshpto.company1 as customer_name,
           arcshpto.address1 as customer_address1,
           arcshpto.address2 as customer_address2,
           arcshpto.city as customer_city,
           arcshpto.province as customer_state,
           arcshpto.postcode as customer_postcode,
           cast("" as varchar(6)) as brand_store_number,
           arcust.contr_id as order_guide_customer_group_number,
           left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
           left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
           left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
           arinvoic.inv_no as customer_invoice_number,
           ariitems.item as invoice_line_number,
           ariitems.product_id as dc_invoice_item,
           iv_mast.descript as item_descript_long,
           iv_mast.pk_size as item_pack_size,
           iv_mast.pk_ctch_wt as has_ctch_wgt,
           iv_mast.vprod_id as manufacture_item_number,
           iv_mast.iv_class as it_class,
           iv_mast.vend_id as vend_id,
           apvend.company1 as vend_name,
           cast("" as varchar(14)) as upc,  cast("" as varchar(14)) as gtin,
           iv_mast.brand as item_brand_name,
           cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure,

           cast(nvl(icase(rtrim(iv_mast.iv_class) = "DRY", "D", rtrim(iv_type.descript) = "FROZEN", "F",  rtrim(iv_type.descript) = "FRESH", "R", ""), "") as varchar(1)) as temperature_protection_code,

           cast(iif(ariitems.shp_unit = "KG",  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

           cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

           cast(iif(ariitems.shp_unit = "KG",   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

           cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

           ariitems.amount as extended_price,   

          cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,

           arinvoic.inv_no as credit_memo_number 

           from arinvoic
          
            inner join ariitems on ariitems.refno = arinvoic.refno     

           inner join iv_mast on iv_mast.product_id = ariitems.product_id    

           inner join apvend on iv_mast.vend_id = apvend.vend_id   

           inner join arcust on arcust.refno = arinvoic.cust_no      

           inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

            left join iv_type on iv_type.iv_type = iv_mast.iv_type  

           where not ariitems.comment           
           and not ariitems.deposit           
           and not ariitems.allowance           
           and arinvoic.refno = 1108021

select ariitems.wh_locat as dc_warehouse_number,
           cast(2 as integer) as customer_brand,
           rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, "@L 99999") as customer_number,
           arcshpto.company1 as customer_name,
           arcshpto.address1 as customer_address1,
           arcshpto.address2 as customer_address2,
           arcshpto.city as customer_city,
           arcshpto.province as customer_state,
           arcshpto.postcode as customer_postcode,
           cast("" as varchar(6)) as brand_store_number,
           arcust.contr_id as order_guide_customer_group_number,
           left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
           left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
           left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
           arinvoic.inv_no as customer_invoice_number,
           ariitems.item as invoice_line_number,
           ariitems.product_id as dc_invoice_item,
           iv_mast.descript as item_descript_long,
           iv_mast.pk_size as item_pack_size,
           iv_mast.pk_ctch_wt as has_ctch_wgt,
           iv_mast.vprod_id as manufacture_item_number,
           iv_mast.iv_class as it_class,
           iv_mast.vend_id as vend_id,
           apvend.company1 as vend_name,
           cast("" as varchar(14)) as upc,  cast("" as varchar(14)) as gtin,
           iv_mast.brand as item_brand_name,
           cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure,

           cast(nvl(icase(rtrim(iv_mast.iv_class) = "DRY", "D", rtrim(iv_type.descript) = "FROZEN", "F",  rtrim(iv_type.descript) = "FRESH", "R", ""), "") as varchar(1)) as temperature_protection_code,

           cast(iif(ariitems.shp_unit = "KG",  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

           cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

           cast(iif(ariitems.shp_unit = "KG",   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

           cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

           ariitems.amount as extended_price,   

          cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,

           arinvoic.inv_no as credit_memo_number 

           from arinvoic
          
            inner join ariitems on ariitems.refno = arinvoic.refno     

           inner join iv_mast on iv_mast.product_id = ariitems.product_id    

           inner join apvend on iv_mast.vend_id = apvend.vend_id   

           inner join arcust on arcust.refno = arinvoic.cust_no      

           inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

            left join iv_type on iv_type.iv_type = iv_mast.iv_type  

           where not ariitems.comment           
           and not ariitems.deposit           
           and not ariitems.allowance           
           and arinvoic.refno = 1108021;
select ariitems.wh_locat as dc_warehouse_number,
           cast(2 as integer) as customer_brand,
           rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, "@L 99999") as customer_number,
           arcshpto.company1 as customer_name,
           arcshpto.address1 as customer_address1,
           arcshpto.address2 as customer_address2,
           arcshpto.city as customer_city,
           arcshpto.province as customer_state,
           arcshpto.postcode as customer_postcode,
           cast("" as varchar(6)) as brand_store_number,
           arcust.contr_id as order_guide_customer_group_number,
           left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
           left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
           left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
           arinvoic.inv_no as customer_invoice_number,
           ariitems.item as invoice_line_number,
           ariitems.product_id as dc_invoice_item,
           iv_mast.descript as item_descript_long,
           iv_mast.pk_size as item_pack_size,
           iv_mast.pk_ctch_wt as has_ctch_wgt,
           iv_mast.vprod_id as manufacture_item_number,
           iv_mast.iv_class as it_class,
           iv_mast.vend_id as vend_id,
           apvend.company1 as vend_name,
           iv_mast.supplr_no as supplier,
           cast("" as varchar(14)) as upc,  cast("" as varchar(14)) as gtin,
           iv_mast.brand as item_brand_name,
           cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure,

           cast(nvl(icase(rtrim(iv_mast.iv_class) = "DRY", "D", rtrim(iv_type.descript) = "FROZEN", "F",  rtrim(iv_type.descript) = "FRESH", "R", ""), "") as varchar(1)) as temperature_protection_code,

           cast(iif(ariitems.shp_unit = "KG",  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

           cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

           cast(iif(ariitems.shp_unit = "KG",   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

           cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

           ariitems.amount as extended_price,   

          cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,

           arinvoic.inv_no as credit_memo_number 

           from arinvoic
          
            inner join ariitems on ariitems.refno = arinvoic.refno     

           inner join iv_mast on iv_mast.product_id = ariitems.product_id    

           inner join apvend on iv_mast.vend_id = apvend.vend_id   

           inner join arcust on arcust.refno = arinvoic.cust_no      

           inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

            left join iv_type on iv_type.iv_type = iv_mast.iv_type  

           where not ariitems.comment           
           and not ariitems.deposit           
           and not ariitems.allowance           
           and arinvoic.refno = 1108021;
select ariitems.wh_locat as dc_warehouse_number,
           cast(2 as integer) as customer_brand,
           rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, "@L 99999") as customer_number,
           arcshpto.company1 as customer_name,
           arcshpto.address1 as customer_address1,
           arcshpto.address2 as customer_address2,
           arcshpto.city as customer_city,
           arcshpto.province as customer_state,
           arcshpto.postcode as customer_postcode,
           cast("" as varchar(6)) as brand_store_number,
           arcust.contr_id as order_guide_customer_group_number,
           left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
           left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
           left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
           arinvoic.inv_no as customer_invoice_number,
           ariitems.item as invoice_line_number,
           ariitems.product_id as dc_invoice_item,
           iv_mast.descript as item_descript_long,
           iv_mast.pk_size as item_pack_size,
           iv_mast.pk_ctch_wt as has_ctch_wgt,
           iv_mast.vprod_id as manufacture_item_number,
           iv_mast.iv_class as it_class,
           iv_mast.vend_id as vend_id,
           apvend.company1 as vend_name,

           iv_mast.supplr_no as supplier,
           iv_mast.pk_upc as it_upc,

           cast("" as varchar(14)) as upc,  cast("" as varchar(14)) as gtin,
           iv_mast.brand as item_brand_name,
           cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure,

           cast(nvl(icase(rtrim(iv_mast.iv_class) = "DRY", "D", rtrim(iv_type.descript) = "FROZEN", "F",  rtrim(iv_type.descript) = "FRESH", "R", ""), "") as varchar(1)) as temperature_protection_code,

           cast(iif(ariitems.shp_unit = "KG",  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

           cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

           cast(iif(ariitems.shp_unit = "KG",   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

           cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

           ariitems.amount as extended_price,   

          cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,

           arinvoic.inv_no as credit_memo_number 

           from arinvoic
          
            inner join ariitems on ariitems.refno = arinvoic.refno     

           inner join iv_mast on iv_mast.product_id = ariitems.product_id    

           inner join apvend on iv_mast.vend_id = apvend.vend_id   

           inner join arcust on arcust.refno = arinvoic.cust_no      

           inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

            left join iv_type on iv_type.iv_type = iv_mast.iv_type  

           where not ariitems.comment           
           and not ariitems.deposit           
           and not ariitems.allowance           
           and arinvoic.refno = 1108021;
select ariitems.wh_locat as dc_warehouse_number,
           cast(2 as integer) as customer_brand,
           rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, "@L 99999") as customer_number,
           arcshpto.company1 as customer_name,
           arcshpto.address1 as customer_address1,
           arcshpto.address2 as customer_address2,
           arcshpto.city as customer_city,
           arcshpto.province as customer_state,
           arcshpto.postcode as customer_postcode,
           cast("" as varchar(6)) as brand_store_number,
           arcust.contr_id as order_guide_customer_group_number,
           left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
           left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
           left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
           arinvoic.inv_no as customer_invoice_number,
           ariitems.item as invoice_line_number,
           ariitems.product_id as dc_invoice_item,
           iv_mast.descript as item_descript_long,
           iv_mast.pk_size as item_pack_size,
           iv_mast.pk_ctch_wt as has_ctch_wgt,
           iv_mast.vprod_id as manufacture_item_number,
           iv_mast.iv_class as it_class,
           iv_mast.vend_id as vend_id,
           apvend.company1 as vend_name,

           iv_mast.supplr_no as supplier,
           iv_mast.pk_upc as it_upc,

           cast("" as varchar(14)) as upc,  cast("" as varchar(14)) as gtin,

           iv_mast.brand as item_brand_name,
           cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure,

           cast(nvl(icase(rtrim(iv_mast.iv_class) = "DRY", "D", rtrim(iv_type.descript) = "FROZEN", "F",  rtrim(iv_type.descript) = "FRESH", "R", ""), "") as varchar(1)) as temperature_protection_code,

           cast(iif(ariitems.shp_unit = "KG",  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

           cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

           cast(iif(ariitems.shp_unit = "KG",   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

           cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

           ariitems.amount as extended_price,   

          cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,

           arinvoic.inv_no as credit_memo_number 

           from arinvoic
          
            inner join ariitems on ariitems.refno = arinvoic.refno     

           inner join iv_mast on iv_mast.product_id = ariitems.product_id    

           inner join apvend on iv_mast.vend_id = apvend.vend_id   

           inner join arcust on arcust.refno = arinvoic.cust_no      

           inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

            left join iv_type on iv_type.iv_type = iv_mast.iv_type  

           where not ariitems.comment           
           and not ariitems.deposit           
           and not ariitems.allowance           
           and arinvoic.refno = 1108021;
select ariitems.wh_locat as dc_warehouse_number,
           cast(2 as integer) as customer_brand,
           rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, "@L 99999") as customer_number,
           arcshpto.company1 as customer_name,
           arcshpto.address1 as customer_address1,
           arcshpto.address2 as customer_address2,
           arcshpto.city as customer_city,
           arcshpto.province as customer_state,
           arcshpto.postcode as customer_postcode,
           cast("" as varchar(6)) as brand_store_number,
           arcust.contr_id as order_guide_customer_group_number,
           left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
           left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
           left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
           arinvoic.inv_no as customer_invoice_number,
           ariitems.item as invoice_line_number,
           ariitems.product_id as dc_invoice_item,
           iv_mast.descript as item_descript_long,
           iv_mast.pk_size as item_pack_size,
           iv_mast.pk_ctch_wt as has_ctch_wgt,
           iv_mast.vprod_id as manufacture_item_number,
           iv_mast.iv_class as it_class,
           iv_mast.vend_id as vend_id,
           apvend.company1 as vend_name,

           iv_mast.supplr_no as supplier,
           iv_mast.pk_upc as it_upc,

           cast("" as varchar(14)) as upc,  cast("" as varchar(14)) as gtin,

           iv_mast.brand as item_brand_name,
           cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

           iv_mast.pk_weight as net_case_weight,
           
icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure,

           cast(nvl(icase(rtrim(iv_mast.iv_class) = "DRY", "D", rtrim(iv_type.descript) = "FROZEN", "F",  rtrim(iv_type.descript) = "FRESH", "R", ""), "") as varchar(1)) as temperature_protection_code,

           cast(iif(ariitems.shp_unit = "KG",  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

           cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

           cast(iif(ariitems.shp_unit = "KG",   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

           cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

           ariitems.amount as extended_price,   

          cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,

           arinvoic.inv_no as credit_memo_number 

           from arinvoic
          
            inner join ariitems on ariitems.refno = arinvoic.refno     

           inner join iv_mast on iv_mast.product_id = ariitems.product_id    

           inner join apvend on iv_mast.vend_id = apvend.vend_id   

           inner join arcust on arcust.refno = arinvoic.cust_no      

           inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

            left join iv_type on iv_type.iv_type = iv_mast.iv_type  

           where not ariitems.comment           
           and not ariitems.deposit           
           and not ariitems.allowance           
           and arinvoic.inv_no = 20180131;
select ariitems.wh_locat as dc_warehouse_number,
           cast(2 as integer) as customer_brand,
           rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, "@L 99999") as customer_number,
           arcshpto.company1 as customer_name,
           arcshpto.address1 as customer_address1,
           arcshpto.address2 as customer_address2,
           arcshpto.city as customer_city,
           arcshpto.province as customer_state,
           arcshpto.postcode as customer_postcode,
           cast("" as varchar(6)) as brand_store_number,
           arcust.contr_id as order_guide_customer_group_number,
           left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
           left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
           left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
           arinvoic.inv_no as customer_invoice_number,
           ariitems.item as invoice_line_number,
           ariitems.product_id as dc_invoice_item,
           iv_mast.descript as item_descript_long,
           iv_mast.pk_size as item_pack_size,
           iv_mast.pk_ctch_wt as has_ctch_wgt,
           iv_mast.vprod_id as manufacture_item_number,
           iv_mast.iv_class as it_class,
           iv_mast.vend_id as vend_id,
           apvend.company1 as vend_name,

           iv_mast.supplr_no as supplier,
           iv_mast.pk_upc as it_upc,

           iv_mast.brand as item_brand_name,
           cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure,

           cast(nvl(icase(rtrim(iv_mast.iv_class) = "DRY", "D", rtrim(iv_type.descript) = "FROZEN", "F",  rtrim(iv_type.descript) = "FRESH", "R", ""), "") as varchar(1)) as temperature_protection_code,

           cast(iif(ariitems.shp_unit = "KG",  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

           cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

           cast(iif(ariitems.shp_unit = "KG",   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

           cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

           ariitems.amount as extended_price,   

           cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,

           arinvoic.inv_no as credit_memo_number 

           from arinvoic
          
           inner join ariitems on ariitems.refno = arinvoic.refno     

           inner join iv_mast on iv_mast.product_id = ariitems.product_id    

           inner join apvend on iv_mast.vend_id = apvend.vend_id   

           inner join arcust on arcust.refno = arinvoic.cust_no      

           inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

           left join iv_type on iv_type.iv_type = iv_mast.iv_type  

           where not ariitems.comment           
           
		   and not ariitems.deposit           
           
		   and not ariitems.allowance           
           
		   and arinvoic.refno = 1108021;
select ariitems.wh_locat as dc_warehouse_number,
           cast(2 as integer) as customer_brand,
           rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, "@L 99999") as customer_number,
           arcshpto.company1 as customer_name,
           arcshpto.address1 as customer_address1,
           arcshpto.address2 as customer_address2,
           arcshpto.city as customer_city,
           arcshpto.province as customer_state,
           arcshpto.postcode as customer_postcode,
           cast("" as varchar(6)) as brand_store_number,
           arcust.contr_id as order_guide_customer_group_number,
           left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
           left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
           left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
           arinvoic.inv_no as customer_invoice_number,
           ariitems.item as invoice_line_number,
           ariitems.product_id as dc_invoice_item,
           iv_mast.descript as item_descript_long,
           iv_mast.pk_size as item_pack_size,
           iv_mast.pk_ctch_wt as has_ctch_wgt,
           iv_mast.vprod_id as manufacture_item_number,
           iv_mast.iv_class as it_class,
           iv_mast.vend_id as vend_id,
           apvend.company1 as vend_name,

           iv_mast.supplr_no as supplier,
           iv_mast.pk_upc as it_upc,

           iv_mast.brand as item_brand_name,
           cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure,

           cast(nvl(icase(rtrim(iv_mast.iv_class) = "DRY", "D", rtrim(iv_type.descript) = "FROZEN", "F",  rtrim(iv_type.descript) = "FRESH", "R", ""), "") as varchar(1)) as temperature_protection_code,

           cast(iif(ariitems.shp_unit = "KG",  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

           cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

           cast(iif(ariitems.shp_unit = "KG",   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

           cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

           ariitems.amount as extended_price,   

           cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,

           arinvoic.inv_no as credit_memo_number 

           from arinvoic
          
           inner join ariitems on ariitems.refno = arinvoic.refno     

           inner join iv_mast on iv_mast.product_id = ariitems.product_id    

           inner join apvend on iv_mast.vend_id = apvend.vend_id   

           inner join arcust on arcust.refno = arinvoic.cust_no      

           inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

           left join iv_type on iv_type.iv_type = iv_mast.iv_type  

           where not ariitems.comment           
           
		   and not ariitems.deposit           
           
		   and not ariitems.allowance           
           
		   and arinvoic.inv_no=1922841;

refno = 1108021;
select ariitems.wh_locat as dc_warehouse_number,
           cast(2 as integer) as customer_brand,
           rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, "@L 99999") as customer_number,
           arcshpto.company1 as customer_name,
           arcshpto.address1 as customer_address1,
           arcshpto.address2 as customer_address2,
           arcshpto.city as customer_city,
           arcshpto.province as customer_state,
           arcshpto.postcode as customer_postcode,
           cast("" as varchar(6)) as brand_store_number,
           arcust.contr_id as order_guide_customer_group_number,
           left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
           left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
           left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
           arinvoic.inv_no as customer_invoice_number,
           ariitems.item as invoice_line_number,
           ariitems.product_id as dc_invoice_item,
           iv_mast.descript as item_descript_long,
           iv_mast.pk_size as item_pack_size,
           iv_mast.pk_ctch_wt as has_ctch_wgt,
           iv_mast.vprod_id as manufacture_item_number,
           iv_mast.iv_class as it_class,
           iv_mast.vend_id as vend_id,
           apvend.company1 as vend_name,

           iv_mast.supplr_no as supplier,
           iv_mast.pk_upc as it_upc,

           iv_mast.brand as item_brand_name,
           cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure,

           cast(nvl(icase(rtrim(iv_mast.iv_class) = "DRY", "D", rtrim(iv_type.descript) = "FROZEN", "F",  rtrim(iv_type.descript) = "FRESH", "R", ""), "") as varchar(1)) as temperature_protection_code,

           cast(iif(ariitems.shp_unit = "KG",  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

           cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

           cast(iif(ariitems.shp_unit = "KG",   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

           cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

           ariitems.amount as extended_price,   

           cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,

           arinvoic.inv_no as credit_memo_number 

           from arinvoic
          
           inner join ariitems on ariitems.refno = arinvoic.refno     

           inner join iv_mast on iv_mast.product_id = ariitems.product_id    

           inner join apvend on iv_mast.vend_id = apvend.vend_id   

           inner join arcust on arcust.refno = arinvoic.cust_no      

           inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

           left join iv_type on iv_type.iv_type = iv_mast.iv_type  

           where not ariitems.comment           
           
		   and not ariitems.deposit           
           
		   and not ariitems.allowance           
           
		   and arinvoic.refno=1108021;

inv_no=1922841;

refno = 1108021;
select ariitems.wh_locat as dc_warehouse_number,
           cast(2 as integer) as customer_brand,
           rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, "@L 99999") as customer_number,
           arcshpto.company1 as customer_name,
           arcshpto.address1 as customer_address1,
           arcshpto.address2 as customer_address2,
           arcshpto.city as customer_city,
           arcshpto.province as customer_state,
           arcshpto.postcode as customer_postcode,
           cast("" as varchar(6)) as brand_store_number,
           arcust.contr_id as order_guide_customer_group_number,
           left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
           left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
           left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
           arinvoic.inv_no as customer_invoice_number,
           ariitems.item as invoice_line_number,
           ariitems.product_id as dc_invoice_item,
           iv_mast.descript as item_descript_long,
           iv_mast.pk_size as item_pack_size,
           iv_mast.pk_ctch_wt as has_ctch_wgt,
           iv_mast.vprod_id as manufacture_item_number,
           iv_mast.iv_class as it_class,
           iv_mast.vend_id as vend_id,
           apvend.company1 as vend_name,

           iv_mast.supplr_no as supplier,
           iv_mast.pk_upc as it_upc,

           iv_mast.brand as item_brand_name,
           cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
icase(iv_mast.pk_sell_un = "KG", "LB", iv_mast.pk_sell_un) as stocking_unit_of_measure,

           cast(nvl(icase(rtrim(iv_mast.iv_class) = "DRY", "D", rtrim(iv_type.descript) = "FROZEN", "F",  rtrim(iv_type.descript) = "FRESH", "R", ""), "") as varchar(1)) as temperature_protection_code,

           cast(iif(ariitems.shp_unit = "KG",  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

           cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

           cast(iif(ariitems.shp_unit = "KG",   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

           cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

           ariitems.amount as extended_price,   

           cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,

           arinvoic.inv_no as credit_memo_number 

           from arinvoic
          
           inner join ariitems on ariitems.refno = arinvoic.refno     

           inner join iv_mast on iv_mast.product_id = ariitems.product_id    

           inner join apvend on iv_mast.vend_id = apvend.vend_id   

           inner join arcust on arcust.refno = arinvoic.cust_no      

           inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

           left join iv_type on iv_type.iv_type = iv_mast.iv_type  

           where not ariitems.comment           
           
		   and not ariitems.deposit           
           
		   and not ariitems.allowance           
           
		   and arinvoic.inv_no=1922841;

refno = 1108021;
select ariitems.wh_locat as dc_warehouse_number,
           cast(2 as integer) as customer_brand,
           rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, '@L 99999') as customer_number,
           arcshpto.company1 as customer_name,
           arcshpto.address1 as customer_address1,
           arcshpto.address2 as customer_address2,
           arcshpto.city as customer_city,
           arcshpto.province as customer_state,
           arcshpto.postcode as customer_postcode,
           cast('' as varchar(6)) as brand_store_number,
           arcust.contr_id as order_guide_customer_group_number,
           left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
           left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
           left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
           arinvoic.inv_no as customer_invoice_number,
           ariitems.item as invoice_line_number,
           ariitems.product_id as dc_invoice_item,
           iv_mast.descript as item_descript_long,
           iv_mast.pk_size as item_pack_size,
           iv_mast.pk_ctch_wt as has_ctch_wgt,
           iv_mast.vprod_id as manufacture_item_number,
           iv_mast.iv_class as it_class,
           iv_mast.vend_id as vend_id,
           apvend.company1 as vend_name,

           iv_mast.supplr_no as supplier,
           iv_mast.pk_upc as it_upc,

           iv_mast.brand as item_brand_name,
           cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure,

           cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY', 'D', rtrim(iv_type.descript) = 'FROZEN', 'F',  rtrim(iv_type.descript) = 'FRESH', 'R', ''), '') as varchar(1)) as temperature_protection_code,

           cast(iif(ariitems.shp_unit = 'KG',  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

           cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

           cast(iif(ariitems.shp_unit = 'KG',   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

           cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

           ariitems.amount as extended_price,   

           cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,

           arinvoic.inv_no as credit_memo_number 

           from arinvoic
          
           inner join ariitems on ariitems.refno = arinvoic.refno     

           inner join iv_mast on iv_mast.product_id = ariitems.product_id    

           inner join apvend on iv_mast.vend_id = apvend.vend_id   

           inner join arcust on arcust.refno = arinvoic.cust_no      

           inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

           left join iv_type on iv_type.iv_type = iv_mast.iv_type  

           where not ariitems.comment           
           
		   and not ariitems.deposit           
           
		   and not ariitems.allowance           
           
		   and arinvoic.inv_no=1922841;

refno = 1108021;
Select * from arinvoic where inv_date = {01/31/2018} and cust_id like '%171155%'

select * from ariitems where refno = 1108021

select ariitems.wh_locat as dc_warehouse_number,
           cast(2 as integer) as customer_brand,
           rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, '@L 99999') as customer_number,
           arcshpto.company1 as customer_name,
           arcshpto.address1 as customer_address1,
           arcshpto.address2 as customer_address2,
           arcshpto.city as customer_city,
           arcshpto.province as customer_state,
           arcshpto.postcode as customer_postcode,
           cast('' as varchar(6)) as brand_store_number,
           arcust.contr_id as order_guide_customer_group_number,
           left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
           left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
           left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
           arinvoic.inv_no as customer_invoice_number,
           ariitems.item as invoice_line_number,
           ariitems.product_id as dc_invoice_item,
           iv_mast.descript as item_descript_long,
           iv_mast.pk_size as item_pack_size,
           iv_mast.pk_ctch_wt as has_ctch_wgt,
           iv_mast.vprod_id as manufacture_item_number,
           iv_mast.iv_class as it_class,
           iv_mast.vend_id as vend_id,
           apvend.company1 as vend_name,

           iv_mast.supplr_no as supplier,
           iv_mast.pk_upc as it_upc,

           iv_mast.brand as item_brand_name,
           cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

           cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure,

           cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY', 'D', rtrim(iv_type.descript) = 'FROZEN', 'F',  rtrim(iv_type.descript) = 'FRESH', 'R', ''), '') as varchar(1)) as temperature_protection_code,

           cast(iif(ariitems.shp_unit = 'KG',  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

           cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

           cast(iif(ariitems.shp_unit = 'KG',   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

           cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

           ariitems.amount as extended_price,   

           cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,

           arinvoic.inv_no as credit_memo_number, 

           cast( (arinvoic.amount) as numeric(9, 4)) as totalInvAmount

           from arinvoic
          
           inner join ariitems on ariitems.refno = arinvoic.refno     

           inner join iv_mast on iv_mast.product_id = ariitems.product_id    

           inner join apvend on iv_mast.vend_id = apvend.vend_id   

           inner join arcust on arcust.refno = arinvoic.cust_no      

           inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

           left join iv_type on iv_type.iv_type = iv_mast.iv_type  

           where not ariitems.comment           
           
		   and not ariitems.deposit           
           
		   and not ariitems.allowance           
           
		   and arinvoic.inv_no=1922841;

refno = 1108021;
Select inv_no from arinvoic WHERE arinvoic.cust_id = ? and arinvoic.inv_date = {31/1/2018}
Select inv_no from arinvoic WHERE arinvoic.cust_id = 171155 and arinvoic.inv_date = {31/1/2018}
Select inv_no from arinvoic WHERE arinvoic.cust_id = '171155' and arinvoic.inv_date = {31/1/2018}
Select inv_no from arinvoic WHERE arinvoic.cust_id = '171155' 
Select inv_no from arinvoic WHERE arinvoic.cust_id = '171155' and arinvoic.inv_date = {31/01/2018}
Select inv_no from arinvoic WHERE arinvoic.cust_id = '171155' and arinvoic.inv_date = {01/31/2018}
Select inv_no from arinvoic WHERE arinvoic.cust_id = '171155' and arinvoic.inv_date = {1/31/2018}
select ariitems.wh_locat as dc_warehouse_number,
                   cast(2 as integer) as customer_brand,
                   rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, '@L 99999') as customer_number,
                   arcshpto.company1 as customer_name,
                   arcshpto.address1 as customer_address1,
                   arcshpto.address2 as customer_address2,
                   arcshpto.city as customer_city,
                   arcshpto.province as customer_state,
                   arcshpto.postcode as customer_postcode,
                   cast('' as varchar(6)) as brand_store_number,
                   arcust.contr_id as order_guide_customer_group_number,
                   left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
                   left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
                   left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
                   arinvoic.inv_no as customer_invoice_number,
                   ariitems.item as invoice_line_number,
                   ariitems.product_id as dc_invoice_item,
                   iv_mast.descript as item_descript_long,
                   iv_mast.pk_size as item_pack_size,
                   iv_mast.pk_ctch_wt as has_ctch_wgt,
                   iv_mast.vprod_id as manufacture_item_number,
                   iv_mast.iv_class as it_class,
                   iv_mast.vend_id as vend_id,
                   apvend.company1 as vend_name,
                   iv_gtin.gtin as it_gtin,

                   iv_mast.supplr_no as supplier,
                   iv_mast.pk_upc as it_upc,

                   iv_mast.brand as item_brand_name,
                   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
                   icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure,

                   cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY', 'D', rtrim(iv_type.descript) = 'FROZEN', 'F',  rtrim(iv_type.descript) = 'FRESH', 'R', ''), '') as varchar(1)) as temperature_protection_code,

                   cast(iif(ariitems.shp_unit = 'KG',  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

                   cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

                   cast(iif(ariitems.shp_unit = 'KG',   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

                   cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

                   ariitems.amount as extended_price,   

                   cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,

                   arinvoic.inv_no as credit_memo_number 

                   from arinvoic
          
                   inner join ariitems on ariitems.refno = arinvoic.refno     

                   inner join iv_mast on iv_mast.product_id = ariitems.product_id    

                   inner join apvend on iv_mast.vend_id = apvend.vend_id   

                   inner join arcust on arcust.refno = arinvoic.cust_no      

                   inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

                   left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 

                   where not ariitems.comment           
           
		           and not ariitems.deposit           
           
		           and not ariitems.allowance           
           
		           and arinvoic.inv_no = select ariitems.wh_locat as dc_warehouse_number,
                   cast(2 as integer) as customer_brand,
                   rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, '@L 99999') as customer_number,
                   arcshpto.company1 as customer_name,
                   arcshpto.address1 as customer_address1,
                   arcshpto.address2 as customer_address2,
                   arcshpto.city as customer_city,
                   arcshpto.province as customer_state,
                   arcshpto.postcode as customer_postcode,
                   cast('' as varchar(6)) as brand_store_number,
                   arcust.contr_id as order_guide_customer_group_number,
                   left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
                   left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
                   left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
                   arinvoic.inv_no as customer_invoice_number,
                   ariitems.item as invoice_line_number,
                   ariitems.product_id as dc_invoice_item,
                   iv_mast.descript as item_descript_long,
                   iv_mast.pk_size as item_pack_size,
                   iv_mast.pk_ctch_wt as has_ctch_wgt,
                   iv_mast.vprod_id as manufacture_item_number,
                   iv_mast.iv_class as it_class,
                   iv_mast.vend_id as vend_id,
                   apvend.company1 as vend_name,
                   iv_gtin.gtin as it_gtin,

                   iv_mast.supplr_no as supplier,
                   iv_mast.pk_upc as it_upc,

                   iv_mast.brand as item_brand_name,
                   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
                   icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure,

                   cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY', 'D', rtrim(iv_type.descript) = 'FROZEN', 'F',  rtrim(iv_type.descript) = 'FRESH', 'R', ''), '') as varchar(1)) as temperature_protection_code,

                   cast(iif(ariitems.shp_unit = 'KG',  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

                   cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

                   cast(iif(ariitems.shp_unit = 'KG',   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

                   cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

                   ariitems.amount as extended_price,   

                   cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,

                   arinvoic.inv_no as credit_memo_number 

                   from arinvoic
          
                   inner join ariitems on ariitems.refno = arinvoic.refno     

                   inner join iv_mast on iv_mast.product_id = ariitems.product_id    

                   inner join apvend on iv_mast.vend_id = apvend.vend_id   

                   inner join arcust on arcust.refno = arinvoic.cust_no      

                   inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

                   left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 

                   where not ariitems.comment           
           
		           and not ariitems.deposit           
           
		           and not ariitems.allowance           
           
		           and arinvoic.inv_no = select ariitems.wh_locat as dc_warehouse_number,
                   cast(2 as integer) as customer_brand,
                   rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, '@L 99999') as customer_number,
                   arcshpto.company1 as customer_name,
                   arcshpto.address1 as customer_address1,
                   arcshpto.address2 as customer_address2,
                   arcshpto.city as customer_city,
                   arcshpto.province as customer_state,
                   arcshpto.postcode as customer_postcode,
                   cast('' as varchar(6)) as brand_store_number,
                   arcust.contr_id as order_guide_customer_group_number,
                   left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
                   left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
                   left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
                   arinvoic.inv_no as customer_invoice_number,
                   ariitems.item as invoice_line_number,
                   ariitems.product_id as dc_invoice_item,
                   iv_mast.descript as item_descript_long,
                   iv_mast.pk_size as item_pack_size,
                   iv_mast.pk_ctch_wt as has_ctch_wgt,
                   iv_mast.vprod_id as manufacture_item_number,
                   iv_mast.iv_class as it_class,
                   iv_mast.vend_id as vend_id,
                   apvend.company1 as vend_name,
                   iv_gtin.gtin as it_gtin,

                   iv_mast.supplr_no as supplier,
                   iv_mast.pk_upc as it_upc,

                   iv_mast.brand as item_brand_name,
                   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
                   icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure,

                   cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY', 'D', rtrim(iv_type.descript) = 'FROZEN', 'F',  rtrim(iv_type.descript) = 'FRESH', 'R', ''), '') as varchar(1)) as temperature_protection_code,

                   cast(iif(ariitems.shp_unit = 'KG',  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

                   cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

                   cast(iif(ariitems.shp_unit = 'KG',   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

                   cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

                   ariitems.amount as extended_price,   

                   cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,

                   arinvoic.inv_no as credit_memo_number 

                   from arinvoic
          
                   inner join ariitems on ariitems.refno = arinvoic.refno     

                   inner join iv_mast on iv_mast.product_id = ariitems.product_id    

                   inner join apvend on iv_mast.vend_id = apvend.vend_id   

                   inner join arcust on arcust.refno = arinvoic.cust_no      

                   inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

                   left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 

                   where not ariitems.comment           
           
		           and not ariitems.deposit           
           
		           and not ariitems.allowance           
           
		           and arinvoic.inv_no = 1922820
select ariitems.wh_locat as dc_warehouse_number,
                   cast(2 as integer) as customer_brand,
                   rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, '@L 99999') as customer_number,
                   arcshpto.company1 as customer_name,
                   arcshpto.address1 as customer_address1,
                   arcshpto.address2 as customer_address2,
                   arcshpto.city as customer_city,
                   arcshpto.province as customer_state,
                   arcshpto.postcode as customer_postcode,
                   cast('' as varchar(6)) as brand_store_number,
                   arcust.contr_id as order_guide_customer_group_number,
                   left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
                   left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
                   left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
                   arinvoic.inv_no as customer_invoice_number,
                   ariitems.item as invoice_line_number,
                   ariitems.product_id as dc_invoice_item,
                   iv_mast.descript as item_descript_long,
                   iv_mast.pk_size as item_pack_size,
                   iv_mast.pk_ctch_wt as has_ctch_wgt,
                   iv_mast.vprod_id as manufacture_item_number,
                   iv_mast.iv_class as it_class,
                   iv_mast.vend_id as vend_id,
                   apvend.company1 as vend_name,
                   iv_gtin.gtin as it_gtin,

                   iv_mast.supplr_no as supplier,
                   iv_mast.pk_upc as it_upc,

                   iv_mast.brand as item_brand_name,
                   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
                   icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure,

                   cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY', 'D', rtrim(iv_type.descript) = 'FROZEN', 'F',  rtrim(iv_type.descript) = 'FRESH', 'R', ''), '') as varchar(1)) as temperature_protection_code,

                   cast(iif(ariitems.shp_unit = 'KG',  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

                   cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

                   cast(iif(ariitems.shp_unit = 'KG',   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

                   cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

                   ariitems.amount as extended_price,   

                   cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,

                   arinvoic.inv_no as credit_memo_number 

                   from arinvoic
          
                   inner join ariitems on ariitems.refno = arinvoic.refno     

                   inner join iv_mast on iv_mast.product_id = ariitems.product_id    

                   inner join apvend on iv_mast.vend_id = apvend.vend_id   

                   inner join arcust on arcust.refno = arinvoic.cust_no      

                   inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

                   left join iv_gtin on ar_ctitm.product_id = iv_gtin.product_id 

                   where not ariitems.comment           
           
		           and not ariitems.deposit           
           
		           and not ariitems.allowance           
           
		           and arinvoic.inv_no = 1922820
select ariitems.wh_locat as dc_warehouse_number,
                   cast(2 as integer) as customer_brand,
                   rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, '@L 99999') as customer_number,
                   arcshpto.company1 as customer_name,
                   arcshpto.address1 as customer_address1,
                   arcshpto.address2 as customer_address2,
                   arcshpto.city as customer_city,
                   arcshpto.province as customer_state,
                   arcshpto.postcode as customer_postcode,
                   cast('' as varchar(6)) as brand_store_number,
                   arcust.contr_id as order_guide_customer_group_number,
                   left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
                   left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
                   left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
                   arinvoic.inv_no as customer_invoice_number,
                   ariitems.item as invoice_line_number,
                   ariitems.product_id as dc_invoice_item,
                   iv_mast.descript as item_descript_long,
                   iv_mast.pk_size as item_pack_size,
                   iv_mast.pk_ctch_wt as has_ctch_wgt,
                   iv_mast.vprod_id as manufacture_item_number,
                   iv_mast.iv_class as it_class,
                   iv_mast.vend_id as vend_id,
                   apvend.company1 as vend_name,

                   iv_mast.supplr_no as supplier,
                   iv_mast.pk_upc as it_upc,

                   iv_mast.brand as item_brand_name,
                   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
                   icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure,

                   cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY', 'D', rtrim(iv_mast.iv_class) = 'FROZEN', 'F',  rtrim(iv_mast.iv_class) = 'FRESH', 'R', ''), '') as varchar(1)) as temperature_protection_code,

                   cast(iif(ariitems.shp_unit = 'KG',  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

                   cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

                   cast(iif(ariitems.shp_unit = 'KG',   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

                   cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

                   ariitems.amount as extended_price,   

                   cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,

                   arinvoic.inv_no as credit_memo_number 

                   from arinvoic
          
                   inner join ariitems on ariitems.refno = arinvoic.refno     

                   inner join iv_mast on iv_mast.product_id = ariitems.product_id    

                   inner join apvend on iv_mast.vend_id = apvend.vend_id   

                   inner join arcust on arcust.refno = arinvoic.cust_no      

                   inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

                   where not ariitems.comment           
           
		           and not ariitems.deposit           
           
		           and not ariitems.allowance           
           
		           and arinvoic.inv_no = 1922820
select ariitems.wh_locat as dc_warehouse_number,
                   cast(2 as integer) as customer_brand,
                   rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, '@L 99999') as customer_number,
                   arcshpto.company1 as customer_name,
                   arcshpto.address1 as customer_address1,
                   arcshpto.address2 as customer_address2,
                   arcshpto.city as customer_city,
                   arcshpto.province as customer_state,
                   arcshpto.postcode as customer_postcode,
                   cast('' as varchar(6)) as brand_store_number,
                   arcust.contr_id as order_guide_customer_group_number,
                   left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
                   left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
                   left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
                   arinvoic.inv_no as customer_invoice_number,
                   ariitems.item as invoice_line_number,
                   ariitems.product_id as dc_invoice_item,
                   iv_mast.descript as item_descript_long,
                   iv_mast.pk_size as item_pack_size,
                   iv_mast.pk_ctch_wt as has_ctch_wgt,
                   iv_mast.vprod_id as manufacture_item_number,
                   iv_mast.iv_class as it_class,
                   iv_mast.vend_id as vend_id,
                   apvend.company1 as vend_name,
                   iv_gtin.gtin as it_gtin,

                   iv_mast.supplr_no as supplier,
                   iv_mast.pk_upc as it_upc,

                   iv_mast.brand as item_brand_name,
                   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
                   icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure,

                   cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY', 'D', rtrim(iv_mast.iv_class) = 'FROZEN', 'F',  rtrim(iv_mast.iv_class) = 'FRESH', 'R', ''), '') as varchar(1)) as temperature_protection_code,

                   cast(iif(ariitems.shp_unit = 'KG',  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

                   cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

                   cast(iif(ariitems.shp_unit = 'KG',   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

                   cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

                   ariitems.amount as extended_price,   

                   cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,

                   arinvoic.inv_no as credit_memo_number 

                   from arinvoic
          
                   inner join ariitems on ariitems.refno = arinvoic.refno     

                   inner join iv_mast on iv_mast.product_id = ariitems.product_id    

                   inner join apvend on iv_mast.vend_id = apvend.vend_id   

                   inner join arcust on arcust.refno = arinvoic.cust_no      

                   inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

                   left join iv_gtin on iv_mast.product_id = iv_gtin.product_id 
                    

                   where not ariitems.comment           
           
		           and not ariitems.deposit           
           
		           and not ariitems.allowance           
           
		           and arinvoic.inv_no = 1922820
select ariitems.wh_locat as dc_warehouse_number,
                   cast(2 as integer) as customer_brand,
                   rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, '@L 99999') as customer_number,
                   arcshpto.company1 as customer_name,
                   arcshpto.address1 as customer_address1,
                   arcshpto.address2 as customer_address2,
                   arcshpto.city as customer_city,
                   arcshpto.province as customer_state,
                   arcshpto.postcode as customer_postcode,
                   cast('' as varchar(6)) as brand_store_number,
                   arcust.contr_id as order_guide_customer_group_number,
                   left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
                   left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
                   left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
                   arinvoic.inv_no as customer_invoice_number,
                   ariitems.item as invoice_line_number,
                   ariitems.product_id as dc_invoice_item,
                   iv_mast.descript as item_descript_long,
                   iv_mast.pk_size as item_pack_size,
                   iv_mast.pk_ctch_wt as has_ctch_wgt,
                   iv_mast.vprod_id as manufacture_item_number,
                   iv_mast.iv_class as it_class,
                   iv_mast.vend_id as vend_id,
                   apvend.company1 as vend_name,
                   iv_gtin.gtin as it_gtin,

                   iv_mast.supplr_no as supplier,
                   iv_mast.pk_upc as it_upc,

                   iv_mast.brand as item_brand_name,
                   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
                   icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure,

                   cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY', 'D', rtrim(iv_mast.iv_class) = 'FROZEN', 'F',  rtrim(iv_mast.iv_class) = 'FRESH', 'R', ''), '') as varchar(1)) as temperature_protection_code,

                   cast(iif(ariitems.shp_unit = 'KG',  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

                   cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

                   cast(iif(ariitems.shp_unit = 'KG',   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

                   cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

                   ariitems.amount as extended_price,   

                   cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,

                   arinvoic.inv_no as credit_memo_number 

                   from arinvoic
          
                   inner join ariitems on ariitems.refno = arinvoic.refno     

                   inner join iv_mast on iv_mast.product_id = ariitems.product_id    

                   inner join apvend on iv_mast.vend_id = apvend.vend_id   

                   inner join arcust on arcust.refno = arinvoic.cust_no      

                   inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

                   left join iv_gtin on iv_mast.product_id = iv_gtin.product_id 
                    

                   where not ariitems.comment           
           
		           and not ariitems.deposit           
           
		           and not ariitems.allowance           
           
		           and arinvoic.inv_no = 1922820
select ariitems.wh_locat as dc_warehouse_number,
                   cast(2 as integer) as customer_brand,
                   rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, '@L 99999') as customer_number,
                   arcshpto.company1 as customer_name,
                   arcshpto.address1 as customer_address1,
                   arcshpto.address2 as customer_address2,
                   arcshpto.city as customer_city,
                   arcshpto.province as customer_state,
                   arcshpto.postcode as customer_postcode,
                   cast('' as varchar(6)) as brand_store_number,
                   arcust.contr_id as order_guide_customer_group_number,
                   left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
                   left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
                   left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
                   arinvoic.inv_no as customer_invoice_number,
                   ariitems.item as invoice_line_number,
                   ariitems.product_id as dc_invoice_item,
                   iv_mast.descript as item_descript_long,
                   iv_mast.pk_size as item_pack_size,
                   iv_mast.pk_ctch_wt as has_ctch_wgt,
                   iv_mast.vprod_id as manufacture_item_number,
                   iv_mast.iv_class as it_class,
                   iv_mast.vend_id as vend_id,
                   apvend.company1 as vend_name,
                   iv_gtin.gtin as it_gtin,

                   iv_mast.supplr_no as supplier,
                   iv_mast.pk_upc as it_upc,

                   iv_mast.brand as item_brand_name,
                   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
                   icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure,

                   cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY', 'D', rtrim(iv_mast.iv_class) = 'FROZEN', 'F',  rtrim(iv_mast.iv_class) = 'FRESH', 'R', ''), '') as varchar(1)) as temperature_protection_code,

                   cast(iif(ariitems.shp_unit = 'KG',  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

                   cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

                   cast(iif(ariitems.shp_unit = 'KG',   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

                   cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

                   ariitems.amount as extended_price,   

                   cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,

                   arinvoic.amount as invoice_total_amount,

                   arinvoic.inv_no as credit_memo_number 

                   from arinvoic
          
                   inner join ariitems on ariitems.refno = arinvoic.refno     

                   inner join iv_mast on iv_mast.product_id = ariitems.product_id    

                   inner join apvend on iv_mast.vend_id = apvend.vend_id   

                   inner join arcust on arcust.refno = arinvoic.cust_no      

                   inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

                   left join iv_gtin on iv_mast.product_id = iv_gtin.product_id 
                    

                   where not ariitems.comment           
           
		           and not ariitems.deposit           
           
		           and not ariitems.allowance           
           
		           and arinvoic.inv_no = 1922820
Select * from gl_journ where journ_no = 1767

Select * from gl_journ where journ_no = 1767

Select * from gl_journ where journ_no = 1767


Select * from gl_jdist where journ_no = 1767


Select * from gl_journ where journ_no = 1767


Select * from gl_jdist where journ_no = 1767


Select sum(debit) from gl_jdist where journ_no = 1767


Select * from gl_journ where journ_no = 1767


Select * from gl_jdist where journ_no = 1767


Select sum(debit) as totDebit, sum(credit) as totCredit from gl_jdist where journ_no = 1767


Select * from gl_journ where journ_no = 1767


Select * from gl_jdist where journ_no = 1767


Select sum(debit) as totDebit, sum(credit) as totCredit, (totDebit - totCredit) as jBbal from gl_jdist where journ_no = 1767


Select * from gl_journ where journ_no = 1767


Select * from gl_jdist where journ_no = 1767


Select sum(debit) as totDebit, sum(credit) as totCredit, (sum(debit) - sum(credit)) as jBbal from gl_jdist where journ_no = 1767


Select * from gl_journ where journ_no = 1767


Select * from gl_jdist where journ_no = 1767


Select journ_no, sum(debit) as totDebit, sum(credit) as totCredit, (sum(debit) - sum(credit)) as jBbal from gl_jdist where journ_no = 1767


Select * from gl_journ where journ_no = 1767


Select * from gl_jdist where journ_no = 1767


Select sum(debit) as totDebit, sum(credit) as totCredit, (sum(debit) - sum(credit)) as jBbal from gl_jdist where journ_no = 1767


Select * from gl_journ where journ_no = 1767


Select * from gl_jdist where journ_no = 1767


Select sum(debit) as totDebit, sum(credit) as totCredit, (sum(debit) - sum(credit)) as jBbal from gl_jdist where journ_no = 1767

Select * from gl_journ where journ_no = 1767


Select * from gl_jdist where journ_no = 1767


Select sum(debit) as totDebit, sum(credit) as totCredit, (sum(debit) - sum(credit)) as jBbal from gl_jdist where journ_no = 1767


Select sum(debit) as totDebit, sum(credit) as totCredit, (sum(debit) - sum(credit)) as jBbal from gl_jdist where journ_no = 176


Select * from gl_journ where journ_no = 1767


Select * from gl_jdist where journ_no = 1767


Select sum(debit) as totDebit, sum(credit) as totCredit, (sum(debit) - sum(credit)) as jBbal from gl_jdist where journ_no = 1767


Select sum(debit) as totDebit, sum(credit) as totCredit, (sum(debit) - sum(credit)) as jBbal from gl_jdist where journ_no = 17688888


Select * from gl_journ where journ_no = 1767


Select * from gl_jdist where journ_no = 1767


Select sum(debit) as totDebit, sum(credit) as totCredit, (sum(debit) - sum(credit)) as jBbal from gl_jdist where journ_no = 1767


Select sum(debit) as totDebit, sum(credit) as totCredit, (sum(debit) - sum(credit)) as jBbal from gl_jdist where journ_no = 17688888



Select * from gl_journ where journ_no = 1767



Select * from gl_jdist where journ_no = 1767



Select sum(debit) as totDebit, sum(credit) as totCredit, (sum(debit) - sum(credit)) as jBbal from gl_jdist where journ_no = 1767



Select sum(debit) as totDebit, sum(credit) as totCredit, (sum(debit) - sum(credit)) as jBbal from gl_jdist where journ_no = 17688888




Select (sum(debit) - sum(credit)) as jBbal from gl_jdist

Select (sum(debit) - sum(credit)) as jBbal from gl_jdist where journ_no = 1767


Select (sum(debit) - sum(credit)) as jBbal from gl_jdist where journ_no = 1767


Select (sum(debit) - sum(credit)) as jBbal from gl_jdist
Select * from gl_journ where journ_no = 1767



Select * from gl_jdist where journ_no = 1767



Select sum(debit) as totDebit, sum(credit) as totCredit, (sum(debit) - sum(credit)) as jBbal from gl_jdist where journ_no = 1767



Select (sum(debit) - sum(credit)) as jBbal from gl_jdist where journ_no = 1767

select * from sm_staff

select * from sm_staff where staff_no =30

select * from sm_staff where staff_no =30

update sm_staff set password = 'v' where staff_no = 30

select * from sm_staff where staff_no =30

select * from arcust where arcust.contr_id like '17115'
select * from arinvoic.cust_no = 775
select * from arinvoic where arinvoic.cust_no = 775
select * from arcust where arcust.contr_id like '17115'

select * from arinvoic where arinvoic.cust_id = 775
select * from arcust where arcust.contr_id like '17115'


select * from arinvoic where arinvoic.cust_id = 775
select * from arcust where arcust.contr_id like '17115'


select * from arinvoic where arinvoic.cust_id = 775
select * from arinvoic where arinvoic.cust_id = 775
select * from arinvoic where arinvoic.cust_no = 775
select * from arinvoic where arinvoic.cust_no = 775
select * from arcust where arcust.contr_id like '17115'


select * from arinvoic where arinvoic.cust_no = 775
select ariitems.wh_locat as dc_warehouse_number,
                   cast(2 as integer) as customer_brand,
                   rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, '@L 99999') as customer_number,
                   arcshpto.company1 as customer_name,
                   arcshpto.address1 as customer_address1,
                   arcshpto.address2 as customer_address2,
                   arcshpto.city as customer_city,
                   arcshpto.province as customer_state,
                   arcshpto.postcode as customer_postcode,
                   cast('' as varchar(6)) as brand_store_number,
                   arcust.contr_id as order_guide_customer_group_number,
                   left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
                   left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
                   left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
                   arinvoic.inv_no as customer_invoice_number,
                   ariitems.item as invoice_line_number,
                   ariitems.product_id as dc_invoice_item,
                   iv_mast.descript as item_descript_long,
                   iv_mast.pk_size as item_pack_size,
                   iv_mast.pk_ctch_wt as has_ctch_wgt,
                   iv_mast.vprod_id as manufacture_item_number,
                   iv_mast.iv_class as it_class,
                   iv_mast.vend_id as vend_id,
                   apvend.company1 as vend_name,
                   iv_gtin.gtin as it_gtin,

                   iv_mast.supplr_no as supplier,
                   iv_mast.pk_upc as it_upc,

                   iv_mast.brand as item_brand_name,
                   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
                   icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure,

                   cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY', 'D', rtrim(iv_mast.iv_class) = 'FROZEN', 'F',  rtrim(iv_mast.iv_class) = 'FRESH', 'R', ''), '') as varchar(1)) as temperature_protection_code,

                   cast(iif(ariitems.shp_unit = 'KG',  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

                   cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

                   cast(iif(ariitems.shp_unit = 'KG',   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

                   cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

                   ariitems.amount as extended_price,  

                   arinvoic.amount as invoice_total_amount,

                   cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,

                   arinvoic.inv_no as credit_memo_number 

                   from arinvoic
          
                   inner join ariitems on ariitems.refno = arinvoic.refno     

                   inner join iv_mast on iv_mast.product_id = ariitems.product_id    

                   inner join apvend on iv_mast.vend_id = apvend.vend_id   

                   inner join arcust on arcust.refno = arinvoic.cust_no      

                   inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

                   left join iv_gtin on iv_mast.product_id = iv_gtin.product_id 

                   where not ariitems.comment           
           
		           and not ariitems.deposit           
           
		           and not ariitems.allowance           
           
		           and arinvoic.inv_no =  1922820
select ariitems.wh_locat as dc_warehouse_number,
                   cast(2 as integer) as customer_brand,
                   rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, '@L 99999') as customer_number,
                   arcshpto.company1 as customer_name,
                   arcshpto.address1 as customer_address1,
                   arcshpto.address2 as customer_address2,
                   arcshpto.city as customer_city,
                   arcshpto.province as customer_state,
                   arcshpto.postcode as customer_postcode,
                   cast('' as varchar(6)) as brand_store_number,
                   arcust.contr_id as order_guide_customer_group_number,
                   left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
                   left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
                   left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
                   arinvoic.inv_no as customer_invoice_number,
                   ariitems.item as invoice_line_number,
                   ariitems.product_id as dc_invoice_item,
                   iv_mast.descript as item_descript_long,
                   iv_mast.pk_size as item_pack_size,
                   iv_mast.pk_ctch_wt as has_ctch_wgt,
                   iv_mast.vprod_id as manufacture_item_number,
                   iv_mast.iv_class as it_class,
                   iv_mast.vend_id as vend_id,
                   apvend.company1 as vend_name,
                   iv_gtin.gtin as it_gtin,

                   iv_mast.supplr_no as supplier,
                   iv_mast.pk_upc as it_upc,

                   iv_mast.brand as item_brand_name,
                   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
                   icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure,

                   cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY', 'D', rtrim(iv_mast.iv_class) = 'FROZEN', 'F',  rtrim(iv_mast.iv_class) = 'FRESH', 'R', ''), '') as varchar(1)) as temperature_protection_code,

                   cast(iif(ariitems.shp_unit = 'KG',  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

                   cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

                   cast(iif(ariitems.shp_unit = 'KG',   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

                   cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

                   ariitems.amount as extended_price,  

                   arinvoic.amount as invoice_total_amount,

                   cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,

                   arinvoic.inv_no as credit_memo_number 

                   from arinvoic
          
                   inner join ariitems on ariitems.refno = arinvoic.refno     

                   inner join iv_mast on iv_mast.product_id = ariitems.product_id    

                   inner join apvend on iv_mast.vend_id = apvend.vend_id   

                   inner join arcust on arcust.refno = arinvoic.cust_no      

                   inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

                   left join iv_gtin on iv_mast.product_id = iv_gtin.product_id 

                   where not ariitems.comment           
           
		           and not ariitems.deposit           
           
		           and not ariitems.allowance           
           
		           and arinvoic.inv_no =  1922820
select ariitems.wh_locat as dc_warehouse_number,
                   cast(2 as integer) as customer_brand,
                   rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, '@L 99999') as customer_number,
                   arcshpto.company1 as customer_name,
                   arcshpto.address1 as customer_address1,
                   arcshpto.address2 as customer_address2,
                   arcshpto.city as customer_city,
                   arcshpto.province as customer_state,
                   arcshpto.postcode as customer_postcode,
                   cast('' as varchar(6)) as brand_store_number,
                   arcust.contr_id as order_guide_customer_group_number,
                   left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
                   left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
                   left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,
                   arinvoic.inv_no as customer_invoice_number,
                   ariitems.item as invoice_line_number,
                   ariitems.product_id as dc_invoice_item,
                   iv_mast.descript as item_descript_long,
                   iv_mast.pk_size as item_pack_size,
                   iv_mast.pk_ctch_wt as has_ctch_wgt,
                   iv_mast.vprod_id as manufacture_item_number,
                   iv_mast.iv_class as it_class,
                   iv_mast.vend_id as vend_id,
                   apvend.company1 as vend_name,
                   iv_gtin.gtin as it_gtin,

                   iv_mast.supplr_no as supplier,
                   iv_mast.pk_upc as it_upc,

                   iv_mast.brand as item_brand_name,
                   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
           
                   icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure,

                   cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY', 'D', rtrim(iv_mast.iv_class) = 'FROZEN', 'F',  rtrim(iv_mast.iv_class) = 'FRESH', 'R', ''), '') as varchar(1)) as temperature_protection_code,

                   cast(iif(ariitems.shp_unit = 'KG',  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

                   cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,

                   cast(iif(ariitems.shp_unit = 'KG',   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

                   cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

                   ariitems.amount as extended_price,  

                   arinvoic.amount as invoice_total_amount,

                   cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,

                   arinvoic.inv_no as credit_memo_number 

                   from arinvoic
          
                   inner join ariitems on ariitems.refno = arinvoic.refno     

                   inner join iv_mast on iv_mast.product_id = ariitems.product_id    

                   inner join apvend on iv_mast.vend_id = apvend.vend_id   

                   inner join arcust on arcust.refno = arinvoic.cust_no      

                   inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no 

                   left join iv_gtin on iv_mast.product_id = iv_gtin.product_id 

                   where not ariitems.comment           
           
		           and not ariitems.deposit           
           
		           and not ariitems.allowance           
           
		           and arinvoic.inv_no =  1922820
select ariitems.wh_locat as dc_warehouse_number,
                   cast(2 as integer) as customer_brand,
                   rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no,
 '@L 99999') as customer_number,
                   arcshpto.company1 as customer_name,
                   arcshpto.address1 as customer_address1,
                   arcshpto.address2 as customer_address2,
                   arcshpto.city as customer_city,
                   arcshpto.province as customer_state,
                   arcshpto.postcode as customer_postcode,
                   cast('' as varchar(6)) as brand_store_number,
                   arcust.contr_id as order_guide_customer_group_number,
                   left(ttoc(arinvoic.ord_date,
 1),
 8) as customer_order_date,
                   left(ttoc(arinvoic.shp_date,
 1),
 8) as actual_shipped_date,
                   left(ttoc(arinvoic.inv_date,
 1),
 8) as customer_invoice_date,
                   arinvoic.inv_no as customer_invoice_number,
                   ariitems.item as invoice_line_number,
                   ariitems.product_id as dc_invoice_item,
                   iv_mast.descript as item_descript_long,
                   iv_mast.pk_size as item_pack_size,
                   iv_mast.pk_ctch_wt as has_ctch_wgt,
                   iv_mast.bc_factor as BrokenCaseFactor,
                   iv_mast.vprod_id as manufacture_item_number,
                   iv_mast.iv_class as it_class,
                   iv_mast.vend_id as vend_id,
                   apvend.company1 as vend_name,
                   iv_gtin.gtin as it_gtin,
                   iv_mast.supplr_no as supplier,
                   iv_mast.pk_upc as it_upc,
                   iv_mast.brand as item_brand_name,
                   cast(icase(iv_mast.bc_factor <> 0,
 int(iv_mast.bc_factor),
 1) as integer) as units_per_case,
                   cast(round(iif(iv_mast.pk_tare_wt <> 0,
 (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621,
 0),
 4) as numeric(9,
 4)) as gross_case_weight,
                   cast(round(iif(iv_mast.pk_tare_wt <> 0,
 0,
 iv_mast.pk_weight * 2.204621),
 4) as numeric(9,
 4)) as net_case_weight,
                              icase(iv_mast.pk_sell_un = 'KG',
 'LB',
 iv_mast.pk_sell_un) as stocking_unit_of_measure,
                   cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY',
 'D',
 rtrim(iv_mast.iv_class) = 'FROZEN',
 'F',
  rtrim(iv_mast.iv_class) = 'FRESH',
 'R',
 ''),
 '') as varchar(1)) as temperature_protection_code,
                   cast(iif(ariitems.shp_unit = 'KG',
  ariitems.ord_qty * 2.204621,
  icase(ariitems.bc_ea_qty > 1,
 ariitems.ord_qty / ariitems.bc_ea_qty,
 ariitems.ord_qty))  as numeric(9,
 4)) as case_ordered_quantity,
                   cast(round(iif(iv_mast.pk_ctch_wt,
 ariitems.wt_qty * 2.204621,
 0),
 4) as integer) as total_catch_weight,
                   cast(iif(ariitems.shp_unit = 'KG',
   ariitems.ord_qty * 2.204621,
   icase(ariitems.bc_ea_qty > 1,
 ariitems.shp_qty / ariitems.bc_ea_qty,
 ariitems.shp_qty))   as numeric(9,
 4)) as cases_delivered_or_returned,
                   cast(round(iif(empty(ariitems.bc),
 ariitems.price * ariitems.pric_factr,
 ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty),
 4)   as numeric(9,
 4)) as case_price,
                   ariitems.amount as extended_price,
                     arinvoic.amount as invoice_total_amount,
                   cast( (ariitems.amount*(7+5)/100) as numeric(9,
 4)) as tax,
                   arinvoic.inv_no as credit_memo_number                    from arinvoic                             inner join ariitems on ariitems.refno = arinvoic.refno                        inner join iv_mast on iv_mast.product_id = ariitems.product_id                       inner join apvend on iv_mast.vend_id = apvend.vend_id                      inner join arcust on arcust.refno = arinvoic.cust_no                         inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no                    left join iv_gtin on iv_mast.product_id = iv_gtin.product_id                    where not ariitems.comment                      		           and not ariitems.deposit                      		           and not ariitems.allowance                      		           and arinvoic.inv_no =  1922820
select ariitems.wh_locat as dc_warehouse_number,
                   cast(2 as integer) as customer_brand,
                   rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no,
 '@L 99999') as customer_number,
                   arcshpto.company1 as customer_name,
                   arcshpto.address1 as customer_address1,
                   arcshpto.address2 as customer_address2,
                   arcshpto.city as customer_city,
                   arcshpto.province as customer_state,
                   arcshpto.postcode as customer_postcode,
                   cast('' as varchar(6)) as brand_store_number,
                   arcust.contr_id as order_guide_customer_group_number,
                   left(ttoc(arinvoic.ord_date,
 1),
 8) as customer_order_date,
                   left(ttoc(arinvoic.shp_date,
 1),
 8) as actual_shipped_date,
                   left(ttoc(arinvoic.inv_date,
 1),
 8) as customer_invoice_date,
                   arinvoic.inv_no as customer_invoice_number,
                   ariitems.item as invoice_line_number,
                   ariitems.product_id as dc_invoice_item,
                   iv_mast.descript as item_descript_long,
                   iv_mast.pk_size as item_pack_size,
                   iv_mast.pk_ctch_wt as has_ctch_wgt,

                   iv_mast.bc_factor as BrokenCaseFactor,
                   iv_mast.bc_ea_qty as BrokenCaseFactor1,

                   iv_mast.vprod_id as manufacture_item_number,
                   iv_mast.iv_class as it_class,
                   iv_mast.vend_id as vend_id,
                   apvend.company1 as vend_name,
                   iv_gtin.gtin as it_gtin,
                   iv_mast.supplr_no as supplier,
                   iv_mast.pk_upc as it_upc,
                   iv_mast.brand as item_brand_name,
                   cast(icase(iv_mast.bc_factor <> 0,
 int(iv_mast.bc_factor),
 1) as integer) as units_per_case,
                   cast(round(iif(iv_mast.pk_tare_wt <> 0,
 (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621,
 0),
 4) as numeric(9,
 4)) as gross_case_weight,
                   cast(round(iif(iv_mast.pk_tare_wt <> 0,
 0,
 iv_mast.pk_weight * 2.204621),
 4) as numeric(9,
 4)) as net_case_weight,
                              icase(iv_mast.pk_sell_un = 'KG',
 'LB',
 iv_mast.pk_sell_un) as stocking_unit_of_measure,
                   cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY',
 'D',
 rtrim(iv_mast.iv_class) = 'FROZEN',
 'F',
  rtrim(iv_mast.iv_class) = 'FRESH',
 'R',
 ''),
 '') as varchar(1)) as temperature_protection_code,
                   cast(iif(ariitems.shp_unit = 'KG',
  ariitems.ord_qty * 2.204621,
  icase(ariitems.bc_ea_qty > 1,
 ariitems.ord_qty / ariitems.bc_ea_qty,
 ariitems.ord_qty))  as numeric(9,
 4)) as case_ordered_quantity,
                   cast(round(iif(iv_mast.pk_ctch_wt,
 ariitems.wt_qty * 2.204621,
 0),
 4) as integer) as total_catch_weight,
                   cast(iif(ariitems.shp_unit = 'KG',
   ariitems.ord_qty * 2.204621,
   icase(ariitems.bc_ea_qty > 1,
 ariitems.shp_qty / ariitems.bc_ea_qty,
 ariitems.shp_qty))   as numeric(9,
 4)) as cases_delivered_or_returned,
                   cast(round(iif(empty(ariitems.bc),
 ariitems.price * ariitems.pric_factr,
 ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty),
 4)   as numeric(9,
 4)) as case_price,
                   ariitems.amount as extended_price,
                     arinvoic.amount as invoice_total_amount,
                   cast( (ariitems.amount*(7+5)/100) as numeric(9,
 4)) as tax,
                   arinvoic.inv_no as credit_memo_number                    from arinvoic                             inner join ariitems on ariitems.refno = arinvoic.refno                        inner join iv_mast on iv_mast.product_id = ariitems.product_id                       inner join apvend on iv_mast.vend_id = apvend.vend_id                      inner join arcust on arcust.refno = arinvoic.cust_no                         inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no                    left join iv_gtin on iv_mast.product_id = iv_gtin.product_id                    where not ariitems.comment                      		           and not ariitems.deposit                      		           and not ariitems.allowance                      		           and arinvoic.inv_no =  1922820
select * from iv_mast where  iv_mast.bc_factor <>  iv_mast.bc_ea_qty

select descript, iv_mast.bc_factor, iv_mast.bc_ea_qty from iv_mast where  iv_mast.bc_factor <>  iv_mast.bc_ea_qty

select ariitems.wh_locat as dc_warehouse_number,
                   cast(2 as integer) as customer_brand,
                   rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no,
 '@L 99999') as customer_number,
                   arcshpto.company1 as customer_name,
                   arcshpto.address1 as customer_address1,
                   arcshpto.address2 as customer_address2,
                   arcshpto.city as customer_city,
                   arcshpto.province as customer_state,
                   arcshpto.postcode as customer_postcode,
                   cast('' as varchar(6)) as brand_store_number,
                   arcust.contr_id as order_guide_customer_group_number,
                   left(ttoc(arinvoic.ord_date,
 1),
 8) as customer_order_date,
                   left(ttoc(arinvoic.shp_date,
 1),
 8) as actual_shipped_date,
                   left(ttoc(arinvoic.inv_date,
 1),
 8) as customer_invoice_date,
                   arinvoic.inv_no as customer_invoice_number,
                   ariitems.item as invoice_line_number,
                   ariitems.product_id as dc_invoice_item,
                   iv_mast.descript as item_descript_long,
                   iv_mast.pk_size as item_pack_size,
                   iv_mast.pk_ctch_wt as has_ctch_wgt,

                   iv_mast.bc_factor as BrokenCaseFactor,
                   iv_mast.bc_ea_qty as BrokenCaseFactor1,

                   iv_mast.vprod_id as manufacture_item_number,
                   iv_mast.iv_class as it_class,
                   iv_mast.vend_id as vend_id,
                   apvend.company1 as vend_name,
                   iv_gtin.gtin as it_gtin,
                   iv_mast.supplr_no as supplier,
                   iv_mast.pk_upc as it_upc,
                   iv_mast.brand as item_brand_name,
                   cast(icase(iv_mast.bc_factor <> 0,
 int(iv_mast.bc_factor),
 1) as integer) as units_per_case,
                   cast(round(iif(iv_mast.pk_tare_wt <> 0,
 (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621,
 0),
 4) as numeric(9,
 4)) as gross_case_weight,
                   cast(round(iif(iv_mast.pk_tare_wt <> 0,
 0,
 iv_mast.pk_weight * 2.204621),
 4) as numeric(9,
 4)) as net_case_weight,
                              icase(iv_mast.pk_sell_un = 'KG',
 'LB',
 iv_mast.pk_sell_un) as stocking_unit_of_measure,
                   cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY',
 'D',
 rtrim(iv_mast.iv_class) = 'FROZEN',
 'F',
  rtrim(iv_mast.iv_class) = 'FRESH',
 'R',
 ''),
 '') as varchar(1)) as temperature_protection_code,
                   cast(iif(ariitems.shp_unit = 'KG',
  ariitems.ord_qty * 2.204621,
  icase(ariitems.bc_ea_qty > 1,
 ariitems.ord_qty / ariitems.bc_ea_qty,
 ariitems.ord_qty))  as numeric(9,
 4)) as case_ordered_quantity,
                   cast(round(iif(iv_mast.pk_ctch_wt,
 ariitems.wt_qty * 2.204621,
 0),
 4) as integer) as total_catch_weight,
                   cast(iif(ariitems.shp_unit = 'KG',
   ariitems.ord_qty * 2.204621,
   icase(ariitems.bc_ea_qty > 1,
 ariitems.shp_qty / ariitems.bc_ea_qty,
 ariitems.shp_qty))   as numeric(9,
 4)) as cases_delivered_or_returned,
                   cast(round(iif(empty(ariitems.bc),
 ariitems.price * ariitems.pric_factr,
 ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty),
 4)   as numeric(9,
 4)) as case_price,
                   ariitems.amount as extended_price,
                     arinvoic.amount as invoice_total_amount,
                   cast( (ariitems.amount*(7+5)/100) as numeric(9,
 4)) as tax,
                   arinvoic.inv_no as credit_memo_number                    from arinvoic                             inner join ariitems on ariitems.refno = arinvoic.refno                        inner join iv_mast on iv_mast.product_id = ariitems.product_id                       inner join apvend on iv_mast.vend_id = apvend.vend_id                      inner join arcust on arcust.refno = arinvoic.cust_no                         inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no                    left join iv_gtin on iv_mast.product_id = iv_gtin.product_id                    where not ariitems.comment                      		           and not ariitems.deposit                      		           and not ariitems.allowance                      		           and arinvoic.inv_no =  1922820
select ariitems.wh_locat as dc_warehouse_number,
                   cast(2 as integer) as customer_brand,
                   rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no,
 '@L 99999') as customer_number,
                   arcshpto.company1 as customer_name,
                   arcshpto.address1 as customer_address1,
                   arcshpto.address2 as customer_address2,
                   arcshpto.city as customer_city,
                   arcshpto.province as customer_state,
                   arcshpto.postcode as customer_postcode,
                   cast('' as varchar(6)) as brand_store_number,
                   arcust.contr_id as order_guide_customer_group_number,
                   left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
                   left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
                   left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,

                   arinvoic.inv_no as customer_invoice_number,
                   ariitems.item as invoice_line_number,
                   ariitems.product_id as dc_invoice_item,
                   iv_mast.descript as item_descript_long,
                   iv_mast.pk_size as item_pack_size,
                   iv_mast.pk_ctch_wt as has_ctch_wgt,

                   iv_mast.bc_factor as BrokenCaseFactor,
                   iv_mast.bc_ea_qty as BrokenCaseFactor1,

                   iv_mast.vprod_id as manufacture_item_number,
                   iv_mast.iv_class as it_class,
                   iv_mast.vend_id as vend_id,
                   apvend.company1 as vend_name,
                   iv_gtin.gtin as it_gtin,
                   iv_mast.supplr_no as supplier,
                   iv_mast.pk_upc as it_upc,
                   iv_mast.brand as item_brand_name,
                   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_ea_qty), 1) as integer) as units_per_case,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
                   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
                   icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure,
                   cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY', 'D', rtrim(iv_mast.iv_class) = 'FROZEN', 'F',  rtrim(iv_mast.iv_class) = 'FRESH', 'R', ''), '') as varchar(1)) as temperature_protection_code,
                   cast(iif(ariitems.shp_unit = 'KG',  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,
                   cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,
                   cast(iif(ariitems.shp_unit = 'KG',   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,
                   cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,
                   ariitems.amount as extended_price,
                   arinvoic.amount as invoice_total_amount, 
                  cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,
                  arinvoic.inv_no as credit_memo_number                    
                  from arinvoic                             inner join ariitems on ariitems.refno = arinvoic.refno                        inner join iv_mast on iv_mast.product_id = ariitems.product_id                       inner join apvend on iv_mast.vend_id = apvend.vend_id                      inner join arcust on arcust.refno = arinvoic.cust_no                         inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no                    left join iv_gtin on iv_mast.product_id = iv_gtin.product_id                    where not ariitems.comment                      		           and not ariitems.deposit                      		           and not ariitems.allowance                      		           and arinvoic.inv_no =  1922820
select ariitems.wh_locat as dc_warehouse_number,
                   cast(2 as integer) as customer_brand,
                   rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no,
 '@L 99999') as customer_number,
                   arcshpto.company1 as customer_name,
                   arcshpto.address1 as customer_address1,
                   arcshpto.address2 as customer_address2,
                   arcshpto.city as customer_city,
                   arcshpto.province as customer_state,
                   arcshpto.postcode as customer_postcode,
                   cast('' as varchar(6)) as brand_store_number,
                   arcust.contr_id as order_guide_customer_group_number,
                   left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
                   left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
                   left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,

                   arinvoic.inv_no as customer_invoice_number,
                   ariitems.item as invoice_line_number,
                   ariitems.product_id as dc_invoice_item,
                   iv_mast.descript as item_descript_long,
                   iv_mast.pk_size as item_pack_size,
                   iv_mast.pk_ctch_wt as has_ctch_wgt,

                   iv_mast.bc_factor as BrokenCaseFactor,
                   iv_mast.bc_ea_qty as BrokenCaseFactor1,

                   iv_mast.vprod_id as manufacture_item_number,
                   iv_mast.iv_class as it_class,
                   iv_mast.vend_id as vend_id,
                   apvend.company1 as vend_name,
                   iv_gtin.gtin as it_gtin,
                   iv_mast.supplr_no as supplier,
                   iv_mast.pk_upc as it_upc,
                   iv_mast.brand as item_brand_name,
                   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_ea_qty), 1) as integer) as units_per_case,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
                   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,
                   icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure,
                   cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY', 'D', rtrim(iv_mast.iv_class) = 'FROZEN', 'F',  rtrim(iv_mast.iv_class) = 'FRESH', 'R', ''), '') as varchar(1)) as temperature_protection_code,
                   cast(iif(ariitems.shp_unit = 'KG',  ariitems.ord_qty * 2.204621,  icase(ariitems.bc_ea_qty > 1, ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,
                   cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,
                   cast(iif(ariitems.shp_unit = 'KG',   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,
                   cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,
                   ariitems.amount as extended_price,
                   arinvoic.amount as invoice_total_amount, 
                  cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,
                  arinvoic.inv_no as credit_memo_number                    
                  from arinvoic                             inner join ariitems on ariitems.refno = arinvoic.refno                        inner join iv_mast on iv_mast.product_id = ariitems.product_id                       inner join apvend on iv_mast.vend_id = apvend.vend_id                      inner join arcust on arcust.refno = arinvoic.cust_no                         inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no                    left join iv_gtin on iv_mast.product_id = iv_gtin.product_id                    where not ariitems.comment                      		           and not ariitems.deposit                      		           and not ariitems.allowance                      		           and arinvoic.inv_no =  1922820
select ariitems.wh_locat as dc_warehouse_number,
                   cast(2 as integer) as customer_brand,
                   rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, '@L 99999') as customer_number,
                   arcshpto.company1 as customer_name,
                   arcshpto.address1 as customer_address1,
                   arcshpto.address2 as customer_address2,
                   arcshpto.city as customer_city,
                   arcshpto.province as customer_state,
                   arcshpto.postcode as customer_postcode,
                   cast('' as varchar(6)) as brand_store_number,
                   arcust.contr_id as order_guide_customer_group_number,
                   left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
                   left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
                   left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,

                   arinvoic.inv_no as customer_invoice_number,
                   ariitems.item as invoice_line_number,
                   ariitems.product_id as dc_invoice_item,
                   ariitems.bc as IsBrokenCase,
                   iv_mast.descript as item_descript_long,
                   iv_mast.pk_size as item_pack_size,
                   iv_mast.pk_ctch_wt as has_ctch_wgt,

                   iv_mast.bc_factor as BrokenCaseFactor,
                   iv_mast.bc_ea_qty as BrokenCaseFactor1,

                   iv_mast.vprod_id as manufacture_item_number,
                   iv_mast.iv_class as it_class,
                   iv_mast.vend_id as vend_id,
                   apvend.company1 as vend_name,

                   iv_gtin.gtin as it_gtin,
                   iv_mast.supplr_no as supplier,
                   iv_mast.pk_upc as it_upc,
                   iv_mast.brand as item_brand_name,

                   

                   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_ea_qty), 1) as integer) as units_per_case,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
                   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,

                   icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure,
                   cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY', 'D', rtrim(iv_mast.iv_class) = 'FROZEN', 'F',  rtrim(iv_mast.iv_class) = 'FRESH', 'R', ''), '') as varchar(1)) as temperature_protection_code,

                   cast(iif(ariitems.shp_unit = 'KG',  ariitems.ord_qty * 2.204621,  icase((ariitems.bc_ea_qty > 1) , ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

                   cast(iif(ariitems.shp_unit = 'KG',   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

                   cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,
                   cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,
                   ariitems.amount as extended_price,
                   arinvoic.amount as invoice_total_amount, 
                  cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,
                  arinvoic.inv_no as credit_memo_number                    
                  from arinvoic                             inner join ariitems on ariitems.refno = arinvoic.refno                        inner join iv_mast on iv_mast.product_id = ariitems.product_id                       inner join apvend on iv_mast.vend_id = apvend.vend_id                      inner join arcust on arcust.refno = arinvoic.cust_no                         inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no                    left join iv_gtin on iv_mast.product_id = iv_gtin.product_id                    where not ariitems.comment                      		           and not ariitems.deposit                      		           and not ariitems.allowance                      		           and arinvoic.inv_no =  1922820
select ariitems.wh_locat as dc_warehouse_number,
                   cast(2 as integer) as customer_brand,
                   rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, '@L 99999') as customer_number,
                   arcshpto.company1 as customer_name,
                   arcshpto.address1 as customer_address1,
                   arcshpto.address2 as customer_address2,
                   arcshpto.city as customer_city,
                   arcshpto.province as customer_state,
                   arcshpto.postcode as customer_postcode,
                   cast('' as varchar(6)) as brand_store_number,
                   arcust.contr_id as order_guide_customer_group_number,
                   left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
                   left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
                   left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,

                   arinvoic.inv_no as customer_invoice_number,
                   ariitems.item as invoice_line_number,
                   ariitems.product_id as dc_invoice_item,
                   ariitems.bc as IsBrokenCase,
                   iv_mast.descript as item_descript_long,
                   iv_mast.pk_size as item_pack_size,
                   iv_mast.pk_ctch_wt as has_ctch_wgt,

                   iv_mast.bc_factor as BrokenCaseFactor,
                   iv_mast.bc_ea_qty as BrokenCaseFactor1,

                   iv_mast.vprod_id as manufacture_item_number,
                   iv_mast.iv_class as it_class,
                   iv_mast.vend_id as vend_id,
                   apvend.company1 as vend_name,

                   iv_gtin.gtin as it_gtin,
                   iv_mast.supplr_no as supplier,
                   iv_mast.pk_upc as it_upc,
                   iv_mast.brand as item_brand_name,
                  
                   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_ea_qty), 1) as integer) as units_per_case,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
                   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,

                   icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure,
                   cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY', 'D', rtrim(iv_mast.iv_class) = 'FROZEN', 'F',  rtrim(iv_mast.iv_class) = 'FRESH', 'R', ''), '') as varchar(1)) as temperature_protection_code,

                   cast(iif(ariitems.shp_unit = 'KG',  ariitems.ord_qty * 2.204621,  icase((ariitems.bc_ea_qty > 1) , ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

                   cast(iif(ariitems.shp_unit = 'KG',   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

                   cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,
                   cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

                   ariitems.amount as extended_price,
                   (arinvoic.amount ) as invoice_total_amount, 
                  cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,
                  arinvoic.inv_no as credit_memo_number                    
                  from arinvoic                             inner join ariitems on ariitems.refno = arinvoic.refno                        inner join iv_mast on iv_mast.product_id = ariitems.product_id                       inner join apvend on iv_mast.vend_id = apvend.vend_id                      inner join arcust on arcust.refno = arinvoic.cust_no                         inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no                    left join iv_gtin on iv_mast.product_id = iv_gtin.product_id                    where not ariitems.comment                      		           and not ariitems.deposit                      		           and not ariitems.allowance                      		           and arinvoic.inv_no =  1922820
select ariitems.wh_locat as dc_warehouse_number,
                   cast(2 as integer) as customer_brand,
                   rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, '@L 99999') as customer_number,
                   arcshpto.company1 as customer_name,
                   arcshpto.address1 as customer_address1,
                   arcshpto.address2 as customer_address2,
                   arcshpto.city as customer_city,
                   arcshpto.province as customer_state,
                   arcshpto.postcode as customer_postcode,
                   cast('' as varchar(6)) as brand_store_number,
                   arcust.contr_id as order_guide_customer_group_number,
                   left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
                   left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
                   left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,

                   arinvoic.inv_no as customer_invoice_number,
                   ariitems.item as invoice_line_number,
                   ariitems.product_id as dc_invoice_item,
                   ariitems.bc as IsBrokenCase,
                   iv_mast.descript as item_descript_long,
                   iv_mast.pk_size as item_pack_size,
                   iv_mast.pk_ctch_wt as has_ctch_wgt,

                   iv_mast.bc_factor as BrokenCaseFactor,
                   iv_mast.bc_ea_qty as BrokenCaseFactor1,

                   iv_mast.vprod_id as manufacture_item_number,
                   iv_mast.iv_class as it_class,
                   iv_mast.vend_id as vend_id,
                   apvend.company1 as vend_name,

                   iv_gtin.gtin as it_gtin,
                   iv_mast.supplr_no as supplier,
                   iv_mast.pk_upc as it_upc,
                   iv_mast.brand as item_brand_name,
                  
                   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_ea_qty), 1) as integer) as units_per_case,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
                   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,

                   icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure,
                   cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY', 'D', rtrim(iv_mast.iv_class) = 'FROZEN', 'F',  rtrim(iv_mast.iv_class) = 'FRESH', 'R', ''), '') as varchar(1)) as temperature_protection_code,

                   cast(iif(ariitems.shp_unit = 'KG',  ariitems.ord_qty * 2.204621,  icase((ariitems.bc_ea_qty > 1) , ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

                   cast(iif(ariitems.shp_unit = 'KG',   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

                   cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,
                   cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

                   ariitems.amount as extended_price,
                   (arinvoic.amount ) as invoice_total_amount, 
                  cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,
                  arinvoic.inv_no as credit_memo_number     
               
                  from arinvoic                             
                  inner join ariitems on ariitems.refno = arinvoic.refno                        
                  inner join iv_mast on iv_mast.product_id = ariitems.product_id                      
                  inner join apvend on iv_mast.vend_id = apvend.vend_id                      
                  inner join arcust on arcust.refno = arinvoic.cust_no                         
                  inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no                    
                  left join iv_gtin on iv_mast.product_id = iv_gtin.product_id                    
                 where not ariitems.comment    and not ariitems.deposit  
                 and not ariitems.allowance  
                 and arinvoic.inv_no =  1922820
select ariitems.wh_locat as dc_warehouse_number,
                   cast(2 as integer) as customer_brand,
                   rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, '@L 99999') as customer_number,
                   arcshpto.company1 as customer_name,
                   arcshpto.address1 as customer_address1,
                   arcshpto.address2 as customer_address2,
                   arcshpto.city as customer_city,
                   arcshpto.province as customer_state,
                   arcshpto.postcode as customer_postcode,
                   cast('' as varchar(6)) as brand_store_number,
                   arcust.contr_id as order_guide_customer_group_number,
                   left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
                   left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
                   left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,

                   arinvoic.inv_no as customer_invoice_number,
                   ariitems.item as invoice_line_number,
                   ariitems.product_id as dc_invoice_item,
                   ariitems.bc as IsBrokenCase,
                   iv_mast.descript as item_descript_long,
                   iv_mast.pk_size as item_pack_size,
                   iv_mast.pk_ctch_wt as has_ctch_wgt,

                   iv_mast.bc_factor as BrokenCaseFactor,
                   iv_mast.bc_ea_qty as BrokenCaseFactor1,

                   iv_mast.vprod_id as manufacture_item_number,
                   iv_mast.iv_class as it_class,
                   iv_mast.vend_id as vend_id,
                   apvend.company1 as vend_name,

                   iv_gtin.gtin as it_gtin,
                   iv_mast.supplr_no as supplier,
                   iv_mast.pk_upc as it_upc,
                   iv_mast.brand as item_brand_name,
                  
                   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_ea_qty), 1) as integer) as units_per_case,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
                   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,

                   icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure,
                   cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY', 'D', rtrim(iv_mast.iv_class) = 'FROZEN', 'F',  rtrim(iv_mast.iv_class) = 'FRESH', 'R', ''), '') as varchar(1)) as temperature_protection_code,

                   cast(iif(ariitems.shp_unit = 'KG',  ariitems.ord_qty * 2.204621,  icase((ariitems.bc_ea_qty > 1) , ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

                   cast(iif(ariitems.shp_unit = 'KG',   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

                   cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,
                   cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

                   ariitems.amount as extended_price,
                   (arinvoic.amount ) as invoice_total_amount, 
                  cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,
                  arinvoic.inv_no as credit_memo_number     
               
                  from arinvoic                             
                  inner join ariitems on ariitems.refno = arinvoic.refno                        
                  inner join iv_mast on iv_mast.product_id = ariitems.product_id                      
                  inner join apvend on iv_mast.vend_id = apvend.vend_id                      
                  inner join arcust on arcust.refno = arinvoic.cust_no                         
                  inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no                    
                  left join iv_gtin on iv_mast.product_id = iv_gtin.product_id   
                 
                 where not ariitems.comment    and not ariitems.deposit  
                 and not ariitems.allowance  
                 and arinvoic.inv_no =  1922820
select ariitems.wh_locat as dc_warehouse_number,
                   cast(2 as integer) as customer_brand,
                   rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, '@L 99999') as customer_number,
                   arcshpto.company1 as customer_name,
                   arcshpto.address1 as customer_address1,
                   arcshpto.address2 as customer_address2,
                   arcshpto.city as customer_city,
                   arcshpto.province as customer_state,
                   arcshpto.postcode as customer_postcode,
                   cast('' as varchar(6)) as brand_store_number,
                   arcust.contr_id as order_guide_customer_group_number,
                   left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
                   left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
                   left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,

                   arinvoic.inv_no as customer_invoice_number,
                   ariitems.item as invoice_line_number,
                   ariitems.product_id as dc_invoice_item,
                   ariitems.bc as IsBrokenCase,
                   iv_mast.descript as item_descript_long,
                   iv_mast.pk_size as item_pack_size,
                   iv_mast.pk_ctch_wt as has_ctch_wgt,

                   iv_mast.bc_factor as BrokenCaseFactor,
                   iv_mast.bc_ea_qty as BrokenCaseFactor1,

                   iv_mast.vprod_id as manufacture_item_number,
                   iv_mast.iv_class as it_class,
                   iv_mast.vend_id as vend_id,
                   apvend.company1 as vend_name,

                   iv_gtin.gtin as it_gtin,
                   iv_mast.supplr_no as supplier,
                   iv_mast.pk_upc as it_upc,
                   iv_mast.brand as item_brand_name,
                  
                   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_ea_qty), 1) as integer) as units_per_case,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
                   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,

                   icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure,
                   cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY', 'D', rtrim(iv_mast.iv_class) = 'FROZEN', 'F',  rtrim(iv_mast.iv_class) = 'FRESH', 'R', ''), '') as varchar(1)) as temperature_protection_code,

                   cast(iif(ariitems.shp_unit = 'KG',  ariitems.ord_qty * 2.204621,  icase((ariitems.bc_ea_qty > 1) , ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

                   cast(iif(ariitems.shp_unit = 'KG',   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

                   cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,
                   cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

                   ariitems.amount as extended_price,
                   (arinvoic.amount ) as invoice_total_amount, 
                  cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,
                  arinvoic.inv_no as credit_memo_number     
               
                  from arinvoic               
              
                  inner join ariitems on ariitems.refno = arinvoic.refno                        
                  inner join iv_mast on iv_mast.product_id = ariitems.product_id                      
                  inner join apvend on iv_mast.vend_id = apvend.vend_id                      
                  inner join arcust on arcust.refno = arinvoic.cust_no                         
                  inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no              
      
                  left join iv_gtin on iv_mast.product_id = iv_gtin.product_id   
                 
                 where not ariitems.comment    and not ariitems.deposit  
                 and not ariitems.allowance  
                 and arinvoic.inv_no =  1922820
select ariitems.wh_locat as dc_warehouse_number,
                   cast(2 as integer) as customer_brand,
                   rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, '@L 99999') as customer_number,
                   arcshpto.company1 as customer_name,
                   arcshpto.address1 as customer_address1,
                   arcshpto.address2 as customer_address2,
                   arcshpto.city as customer_city,
                   arcshpto.province as customer_state,
                   arcshpto.postcode as customer_postcode,
                   cast('' as varchar(6)) as brand_store_number,
                   arcust.contr_id as order_guide_customer_group_number,
                   left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
                   left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
                   left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,

                   arinvoic.inv_no as customer_invoice_number,
                   ariitems.item as invoice_line_number,
                   ariitems.product_id as dc_invoice_item,

	   ariitems.bc as IsBrokenCase,
	   ariitems.shp_unit as ShipUnit,
	   ariitems.ord_qty as OrderedQty,
	   ariitems.shp_qty as ShippedQty,

                   iv_mast.bc_factor as BrokenCaseFactor,
                   ariitems.bc_ea_qty as BrokenCaseQty,

                   ariitems.bc as IsBrokenCase,
                   iv_mast.descript as item_descript_long,
                   iv_mast.pk_size as item_pack_size,
                   iv_mast.pk_ctch_wt as has_ctch_wgt,

                   iv_mast.bc_factor as BrokenCaseFactor,
                   iv_mast.bc_ea_qty as BrokenCaseFactor1,

                   iv_mast.vprod_id as manufacture_item_number,
                   iv_mast.iv_class as it_class,
                   iv_mast.vend_id as vend_id,
                   apvend.company1 as vend_name,

                   iv_gtin.gtin as it_gtin,
                   iv_mast.supplr_no as supplier,
                   iv_mast.pk_upc as it_upc,
                   iv_mast.brand as item_brand_name,
                  
                   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_ea_qty), 1) as integer) as units_per_case,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
                   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,

                   icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure,
                   cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY', 'D', rtrim(iv_mast.iv_class) = 'FROZEN', 'F',  rtrim(iv_mast.iv_class) = 'FRESH', 'R', ''), '') as varchar(1)) as temperature_protection_code,

                   cast(iif(ariitems.shp_unit = 'KG',  ariitems.ord_qty * 2.204621,  icase((ariitems.bc_ea_qty > 1) , ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

                   cast(iif(ariitems.shp_unit = 'KG',   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

                   cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,
                   cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

                   ariitems.amount as extended_price,
                   (arinvoic.amount ) as invoice_total_amount, 
                  cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,
                  arinvoic.inv_no as credit_memo_number     
               
                  from arinvoic               
              
                  inner join ariitems on ariitems.refno = arinvoic.refno                        
                  inner join iv_mast on iv_mast.product_id = ariitems.product_id                      
                  inner join apvend on iv_mast.vend_id = apvend.vend_id                      
                  inner join arcust on arcust.refno = arinvoic.cust_no                         
                  inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no              
      
                  left join iv_gtin on iv_mast.product_id = iv_gtin.product_id   
                 
                 where not ariitems.comment    and not ariitems.deposit  
                 and not ariitems.allowance  
                 and arinvoic.inv_no =  1922820
select ariitems.wh_locat as dc_warehouse_number,
                   cast(2 as integer) as customer_brand,
                   rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, '@L 99999') as customer_number,
                   arcshpto.company1 as customer_name,
                   arcshpto.address1 as customer_address1,
                   arcshpto.address2 as customer_address2,
                   arcshpto.city as customer_city,
                   arcshpto.province as customer_state,
                   arcshpto.postcode as customer_postcode,
                   cast('' as varchar(6)) as brand_store_number,
                   arcust.contr_id as order_guide_customer_group_number,
                   left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
                   left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
                   left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,

                   arinvoic.inv_no as customer_invoice_number,
                   ariitems.item as invoice_line_number,
                   ariitems.product_id as dc_invoice_item,

	   ariitems.bc as IsBrokenCase,
	   ariitems.shp_unit as ShipUnit,
	   ariitems.ord_qty as OrderedQty,
	   ariitems.shp_qty as ShippedQty,

                   iv_mast.bc_factor as BrokenCaseFactor,
                   ariitems.bc_ea_qty as BrokenCaseQty,

                   ariitems.tax_code as tCode,

                   ariitems.bc as IsBrokenCase,
                   iv_mast.descript as item_descript_long,
                   iv_mast.pk_size as item_pack_size,
                   iv_mast.pk_ctch_wt as has_ctch_wgt,

                   iv_mast.bc_factor as BrokenCaseFactor,
                   iv_mast.bc_ea_qty as BrokenCaseFactor1,

                   iv_mast.vprod_id as manufacture_item_number,
                   iv_mast.iv_class as it_class,
                   iv_mast.vend_id as vend_id,
                   apvend.company1 as vend_name,

                   iv_gtin.gtin as it_gtin,
                   iv_mast.supplr_no as supplier,
                   iv_mast.pk_upc as it_upc,
                   iv_mast.brand as item_brand_name,
                  
                   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_ea_qty), 1) as integer) as units_per_case,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
                   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,

                   icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure,
                   cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY', 'D', rtrim(iv_mast.iv_class) = 'FROZEN', 'F',  rtrim(iv_mast.iv_class) = 'FRESH', 'R', ''), '') as varchar(1)) as temperature_protection_code,

                   cast(iif(ariitems.shp_unit = 'KG',  ariitems.ord_qty * 2.204621,  icase((ariitems.bc_ea_qty > 1) , ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

                   cast(iif(ariitems.shp_unit = 'KG',   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

                   cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,
                   cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

                   ariitems.amount as extended_price,
                   (arinvoic.amount ) as invoice_total_amount, 
                  cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,
                  arinvoic.inv_no as credit_memo_number     
               
                  from arinvoic               
              
                  inner join ariitems on ariitems.refno = arinvoic.refno                        
                  inner join iv_mast on iv_mast.product_id = ariitems.product_id                      
                  inner join apvend on iv_mast.vend_id = apvend.vend_id                      
                  inner join arcust on arcust.refno = arinvoic.cust_no                         
                  inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no              
      
                  left join iv_gtin on iv_mast.product_id = iv_gtin.product_id   
                 
                 where not ariitems.comment    and not ariitems.deposit  
                 and not ariitems.allowance  
                 and arinvoic.inv_no =  1922820
select * from arinvoic where inv_no = 1923353;
select distinct(inv_type) from arinvoic;
select ariitems.wh_locat as dc_warehouse_number,
                   cast(2 as integer) as customer_brand,
                   rtrim(arinvoic.cust_id) + transform(arinvoic.shipto_no, '@L 99999') as customer_number,
                   arcshpto.company1 as customer_name,
                   arcshpto.address1 as customer_address1,
                   arcshpto.address2 as customer_address2,
                   arcshpto.city as customer_city,
                   arcshpto.province as customer_state,
                   arcshpto.postcode as customer_postcode,
                   cast('' as varchar(6)) as brand_store_number,
                   arcust.contr_id as order_guide_customer_group_number,
                   left(ttoc(arinvoic.ord_date, 1), 8) as customer_order_date,
                   left(ttoc(arinvoic.shp_date, 1), 8) as actual_shipped_date,
                   left(ttoc(arinvoic.inv_date, 1), 8) as customer_invoice_date,

                   arinvoic.inv_no as customer_invoice_number,
                   ariitems.item as invoice_line_number,
                   ariitems.product_id as dc_invoice_item,

	   ariitems.bc as IsBrokenCase,
	   ariitems.shp_unit as ShipUnit,
	   ariitems.ord_qty as OrderedQty,
	   ariitems.shp_qty as ShippedQty,

                   iv_mast.bc_factor as BrokenCaseFactor,
                   ariitems.bc_ea_qty as BrokenCaseQty,

                   ariitems.tax_code as tCode,

                   ariitems.bc as IsBrokenCase,
                   iv_mast.descript as item_descript_long,
                   iv_mast.pk_size as item_pack_size,
                   iv_mast.pk_ctch_wt as has_ctch_wgt,

                   iv_mast.bc_factor as BrokenCaseFactor,
                   iv_mast.bc_ea_qty as BrokenCaseFactor1,

                   iv_mast.vprod_id as manufacture_item_number,
                   iv_mast.iv_class as it_class,
                   iv_mast.vend_id as vend_id,
                   apvend.company1 as vend_name,

                   iv_gtin.gtin as it_gtin,
                   iv_mast.supplr_no as supplier,
                   iv_mast.pk_upc as it_upc,
                   iv_mast.brand as item_brand_name,
                  
                   cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_ea_qty), 1) as integer) as units_per_case,

                   cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,
                   cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,

                   icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure,
                   cast(nvl(icase(rtrim(iv_mast.iv_class) = 'DRY', 'D', rtrim(iv_mast.iv_class) = 'FROZEN', 'F',  rtrim(iv_mast.iv_class) = 'FRESH', 'R', ''), '') as varchar(1)) as temperature_protection_code,

                   cast(iif(ariitems.shp_unit = 'KG',  ariitems.ord_qty * 2.204621,  icase((ariitems.bc_ea_qty > 1) , ariitems.ord_qty / ariitems.bc_ea_qty, ariitems.ord_qty))  as numeric(9, 4)) as case_ordered_quantity,

                   cast(iif(ariitems.shp_unit = 'KG',   ariitems.ord_qty * 2.204621,   icase(ariitems.bc_ea_qty > 1, ariitems.shp_qty / ariitems.bc_ea_qty, ariitems.shp_qty))   as numeric(9, 4)) as cases_delivered_or_returned,

                   cast(round(iif(iv_mast.pk_ctch_wt, ariitems.wt_qty * 2.204621, 0), 4) as integer) as total_catch_weight,
                   cast(round(iif(empty(ariitems.bc), ariitems.price * ariitems.pric_factr, ariitems.price * ariitems.pric_factr / ariitems.bc_ea_qty), 4)   as numeric(9, 4)) as case_price,

                   ariitems.amount as extended_price,
                   (arinvoic.amount ) as invoice_total_amount, 
                  cast( (ariitems.amount*(7+5)/100) as numeric(9, 4)) as tax,
                  arinvoic.inv_no as credit_memo_number     
               
                  from arinvoic               
              
                  inner join ariitems on ariitems.refno = arinvoic.refno                        
                  inner join iv_mast on iv_mast.product_id = ariitems.product_id                      
                  inner join apvend on iv_mast.vend_id = apvend.vend_id                      
                  inner join arcust on arcust.refno = arinvoic.cust_no                         
                  inner join arcshpto on arcshpto.refno = arinvoic.cust_no   and arcshpto.shipto_no = arinvoic.shipto_no              
      
                  left join iv_gtin on iv_mast.product_id = iv_gtin.product_id   
                 
                 where not ariitems.comment    and not ariitems.deposit  
                 and not ariitems.allowance  
                 and arinvoic.inv_no =  1922820
select 
                ap_pohdr.pono,   
                ap_pohdr.vend_id,  
                apsupplr.supplr_no,
                ap_pohdr.closed as po_closed_date,   
                ap_pohdr.issued as po_issued_date, 
                ap_pohdr.re_open as po_re_open_date,  
                ap_pohdr.cancelled as po_cancelled_date, 
                ap_pohdr.date as po_creation_date,   
                ap_pohdr.req_date as po_schedule_receipt_date, 
                ap_pohdr.req_date as po_actual_receipt_date, 
                apvend.company1 as vendor_name,   
                apsupplr.company1 as vendor_pickup_warehouse_name,   
                apsupplr.address1 as vendor_pickup_warehouse_address1,   
                apsupplr.address2 as vendor_pickup_warehouse_address2,   
                apsupplr.city as vendor_pickup_warehouse_city,  
                apsupplr.province as vendor_pickup_warehouse_state,  
                apsupplr.postcode as vendor_pickup_warehouse_zip, 
                ap_poitm.product_id as item_number,   
                iv_mast.descript as item_description_long,   
                iv_mast.pk_size as item_pack_size,   
                iv_mast.iv_class as it_class, 
                iv_mast.pk_ctch_wt as has_ctch_wgt,  
                iv_mast.pk_upc as pk_upc,   
                iv_gtin.gtin as it_gtin,  
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity, 
                cast(0 as integer) as po_cancelled_quantity, 
                cast(ap_poitm.cost as numeric(9, 4)) as product_price,    
                cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
                cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  
                cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  
                icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, 
                cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, 
                iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name 
                from ap_poitm 
                inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
                inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
                inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
                inner join apsupplr on apsupplr.refno = apvend.refno 
                left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id 
                where ap_poitm.product_id = '314138'
select 
                ap_pohdr.pono,   
                ap_pohdr.vend_id,  
                apsupplr.supplr_no,
                ap_pohdr.closed as po_closed_date,   
                ap_pohdr.issued as po_issued_date, 
                ap_pohdr.re_open as po_re_open_date,  
                ap_pohdr.cancelled as po_cancelled_date, 
                ap_pohdr.date as po_creation_date,   
                ap_pohdr.req_date as po_schedule_receipt_date, 
                ap_pohdr.req_date as po_actual_receipt_date, 
                apvend.company1 as vendor_name,   
                apsupplr.company1 as vendor_pickup_warehouse_name,   
                apsupplr.address1 as vendor_pickup_warehouse_address1,   
                apsupplr.address2 as vendor_pickup_warehouse_address2,   
                apsupplr.city as vendor_pickup_warehouse_city,  
                apsupplr.province as vendor_pickup_warehouse_state,  
                apsupplr.postcode as vendor_pickup_warehouse_zip, 
                ap_poitm.product_id as item_number,   
                iv_mast.descript as item_description_long,   
                iv_mast.pk_size as item_pack_size,   
                iv_mast.iv_class as it_class, 
                iv_mast.pk_ctch_wt as has_ctch_wgt,  
                iv_mast.pk_upc as pk_upc,   
                iv_gtin.gtin as it_gtin,  
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity, 
                cast(0 as integer) as po_cancelled_quantity, 
                cast(ap_poitm.cost as numeric(9, 4)) as product_price,    
                cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
                cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  
                cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  
                icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, 
                cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, 
                iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name 
                from ap_poitm 
                inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
                inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
                inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
                inner join apsupplr on apsupplr.refno = apvend.refno 
                left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id 
                where ap_poitm.product_id = '364138'
select 
                ap_pohdr.pono,   
                ap_pohdr.vend_id,  
                apsupplr.supplr_no,
                ap_pohdr.closed as po_closed_date,   
                ap_pohdr.issued as po_issued_date, 
                ap_pohdr.re_open as po_re_open_date,  
                ap_pohdr.cancelled as po_cancelled_date, 
                ap_pohdr.date as po_creation_date,   
                ap_pohdr.req_date as po_schedule_receipt_date, 
                ap_pohdr.req_date as po_actual_receipt_date, 
                apvend.company1 as vendor_name,   
                apsupplr.company1 as vendor_pickup_warehouse_name,   
                apsupplr.address1 as vendor_pickup_warehouse_address1,   
                apsupplr.address2 as vendor_pickup_warehouse_address2,   
                apsupplr.city as vendor_pickup_warehouse_city,  
                apsupplr.province as vendor_pickup_warehouse_state,  
                apsupplr.postcode as vendor_pickup_warehouse_zip, 
                ap_poitm.product_id as item_number,   
                iv_mast.descript as item_description_long,   
                iv_mast.pk_size as item_pack_size,   
                iv_mast.iv_class as it_class, 
                iv_mast.pk_ctch_wt as has_ctch_wgt,  
                iv_mast.pk_upc as pk_upc,   
                iv_gtin.gtin as it_gtin,  
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity, 
                cast(0 as integer) as po_cancelled_quantity, 
                cast(ap_poitm.cost as numeric(9, 4)) as product_price,    
                cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
                cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  
                cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  
                icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, 
                cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, 
                iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name 
                from ap_poitm 
                inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
                inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
                inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
                inner join apsupplr on apsupplr.refno = apvend.refno 
                left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id 
                where ap_poitm.product_id = '513018'
select 
                ap_pohdr.pono,   
                ap_pohdr.vend_id,  
                apsupplr.supplr_no,
                ap_pohdr.closed as po_closed_date,   
                ap_pohdr.issued as po_issued_date, 
                ap_pohdr.re_open as po_re_open_date,  
                ap_pohdr.cancelled as po_cancelled_date, 
                ap_pohdr.date as po_creation_date,   
                ap_pohdr.req_date as po_schedule_receipt_date, 
                ap_pohdr.req_date as po_actual_receipt_date, 
                apvend.company1 as vendor_name,   
                apsupplr.company1 as vendor_pickup_warehouse_name,   
                apsupplr.address1 as vendor_pickup_warehouse_address1,   
                apsupplr.address2 as vendor_pickup_warehouse_address2,   
                apsupplr.city as vendor_pickup_warehouse_city,  
                apsupplr.province as vendor_pickup_warehouse_state,  
                apsupplr.postcode as vendor_pickup_warehouse_zip, 
                ap_poitm.product_id as item_number,   
                iv_mast.descript as item_description_long,   
                iv_mast.pk_size as item_pack_size,   
                iv_mast.iv_class as it_class, 
                iv_mast.pk_ctch_wt as has_ctch_wgt,  
                iv_mast.pk_upc as pk_upc,   
                iv_gtin.gtin as it_gtin,  
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity, 
                cast(0 as integer) as po_cancelled_quantity, 
                cast(ap_poitm.cost as numeric(9, 4)) as product_price,    
                cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
                cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  
                cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  
                icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, 
                cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, 
                iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name 
                from ap_poitm 
                inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
                inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
                inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
                inner join apsupplr on apsupplr.refno = apvend.refno 
                left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id 
                where ap_poitm.product_id = '513018' and ap_pohdr.pono = '109097'
select 
                ap_pohdr.pono,   
                ap_pohdr.vend_id,  
                apsupplr.supplr_no,
                ap_pohdr.closed as po_closed_date,   
                ap_pohdr.issued as po_issued_date, 
                ap_pohdr.re_open as po_re_open_date,  
                ap_pohdr.cancelled as po_cancelled_date, 
                ap_pohdr.date as po_creation_date,   
                ap_pohdr.req_date as po_schedule_receipt_date, 
                ap_pohdr.req_date as po_actual_receipt_date, 
                apvend.company1 as vendor_name,   
                apsupplr.company1 as vendor_pickup_warehouse_name,   
                apsupplr.address1 as vendor_pickup_warehouse_address1,   
                apsupplr.address2 as vendor_pickup_warehouse_address2,   
                apsupplr.city as vendor_pickup_warehouse_city,  
                apsupplr.province as vendor_pickup_warehouse_state,  
                apsupplr.postcode as vendor_pickup_warehouse_zip, 
                ap_poitm.product_id as item_number,   
                iv_mast.descript as item_description_long,   
                iv_mast.pk_size as item_pack_size,   
                iv_mast.iv_class as it_class, 
                iv_mast.pk_ctch_wt as has_ctch_wgt,  
                iv_mast.pk_upc as pk_upc,   
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity, 
                cast(0 as integer) as po_cancelled_quantity, 
                cast(ap_poitm.cost as numeric(9, 4)) as product_price,    
                cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
                cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  
                cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  
                icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, 
                cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, 
                iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name 
                from ap_poitm 
                inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
                inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
                inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
                inner join apsupplr on apsupplr.refno = apvend.refno 
                where ap_poitm.product_id = '513018' and ap_pohdr.pono = '109097'
select 
                ap_pohdr.pono,   
                ap_pohdr.vend_id,  
                apsupplr.supplr_no,
                ap_pohdr.closed as po_closed_date,   
                ap_pohdr.issued as po_issued_date, 
                ap_pohdr.re_open as po_re_open_date,  
                ap_pohdr.cancelled as po_cancelled_date, 
                ap_pohdr.date as po_creation_date,   
                ap_pohdr.req_date as po_schedule_receipt_date, 
                ap_pohdr.req_date as po_actual_receipt_date, 
                apvend.company1 as vendor_name,   
                apsupplr.company1 as vendor_pickup_warehouse_name,   
                apsupplr.address1 as vendor_pickup_warehouse_address1,   
                apsupplr.address2 as vendor_pickup_warehouse_address2,   
                apsupplr.city as vendor_pickup_warehouse_city,  
                apsupplr.province as vendor_pickup_warehouse_state,  
                apsupplr.postcode as vendor_pickup_warehouse_zip, 
                ap_poitm.product_id as item_number,   
                iv_mast.descript as item_description_long,   
                iv_mast.pk_size as item_pack_size,   
                iv_mast.iv_class as it_class, 
                iv_mast.pk_ctch_wt as has_ctch_wgt,  
                iv_mast.pk_upc as pk_upc,   
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity, 
                cast(0 as integer) as po_cancelled_quantity, 
                cast(ap_poitm.cost as numeric(9, 4)) as product_price,    
                cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
                cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  
                cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  
                icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, 
                cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, 
                iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name 
                from ap_poitm 
                inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
                inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
                inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
                inner join apsupplr on apsupplr.vend_id = iv_mast.vend_id
                where ap_poitm.product_id = '513018' and ap_pohdr.pono = '109097'
select 
                ap_pohdr.pono,   
                ap_pohdr.vend_id,  
                apsupplr.supplr_no,
                ap_pohdr.closed as po_closed_date,   
                ap_pohdr.issued as po_issued_date, 
                ap_pohdr.re_open as po_re_open_date,  
                ap_pohdr.cancelled as po_cancelled_date, 
                ap_pohdr.date as po_creation_date,   
                ap_pohdr.req_date as po_schedule_receipt_date, 
                ap_pohdr.req_date as po_actual_receipt_date, 
                apvend.company1 as vendor_name,   
                apsupplr.company1 as vendor_pickup_warehouse_name,   
                apsupplr.address1 as vendor_pickup_warehouse_address1,   
                apsupplr.address2 as vendor_pickup_warehouse_address2,   
                apsupplr.city as vendor_pickup_warehouse_city,  
                apsupplr.province as vendor_pickup_warehouse_state,  
                apsupplr.postcode as vendor_pickup_warehouse_zip, 
                ap_poitm.product_id as item_number,   
                iv_mast.descript as item_description_long,   
                iv_mast.pk_size as item_pack_size,   
                iv_mast.iv_class as it_class, 
                iv_mast.pk_ctch_wt as has_ctch_wgt,  
                iv_mast.pk_upc as pk_upc,   
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity, 
                cast(0 as integer) as po_cancelled_quantity, 
                cast(ap_poitm.cost as numeric(9, 4)) as product_price,    
                cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
                cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  
                cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  
                icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, 
                cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, 
                iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name 
                from ap_poitm 
                inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
                inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
                inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
                inner join apsupplr on apsupplr.vend_id = iv_mast.vend_id and apsupplr.supplr_no = iv_mast.supplr_no
                where ap_poitm.product_id = '513018' and ap_pohdr.pono = '109097'
select 
                ap_pohdr.pono,   
                ap_pohdr.vend_id,  
                apsupplr.supplr_no,
                ap_pohdr.closed as po_closed_date,   
                ap_pohdr.issued as po_issued_date, 
                ap_pohdr.re_open as po_re_open_date,  
                ap_pohdr.cancelled as po_cancelled_date, 
                ap_pohdr.date as po_creation_date,   
                ap_pohdr.req_date as po_schedule_receipt_date, 
                ap_pohdr.req_date as po_actual_receipt_date, 
                apvend.company1 as vendor_name,   
                apsupplr.company1 as vendor_pickup_warehouse_name,   
                apsupplr.address1 as vendor_pickup_warehouse_address1,   
                apsupplr.address2 as vendor_pickup_warehouse_address2,   
                apsupplr.city as vendor_pickup_warehouse_city,  
                apsupplr.province as vendor_pickup_warehouse_state,  
                apsupplr.postcode as vendor_pickup_warehouse_zip, 
                ap_poitm.product_id as item_number,   
                iv_mast.descript as item_description_long,   
                iv_mast.pk_size as item_pack_size,   
                iv_mast.iv_class as it_class, 
                iv_mast.pk_ctch_wt as has_ctch_wgt,  
                iv_mast.pk_upc as pk_upc,   
                iv_gtin.gtin as it_gtin,  
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity, 
                cast(0 as integer) as po_cancelled_quantity, 
                cast(ap_poitm.cost as numeric(9, 4)) as product_price,    
                cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
                cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  
                cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  
                icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, 
                cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, 
                iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name 
                from ap_poitm 
                inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
                inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
                inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
                inner join apsupplr on apsupplr.refno = apvend.refno 
                left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id 
                where ap_poitm.product_id = '513018'
select 
                ap_pohdr.pono,   
                ap_pohdr.vend_id,  
                apsupplr.supplr_no,
                ap_pohdr.closed as po_closed_date,   
                ap_pohdr.issued as po_issued_date, 
                ap_pohdr.re_open as po_re_open_date,  
                ap_pohdr.cancelled as po_cancelled_date, 
                ap_pohdr.date as po_creation_date,   
                ap_pohdr.req_date as po_schedule_receipt_date, 
                ap_pohdr.req_date as po_actual_receipt_date, 
                apvend.company1 as vendor_name,   
                apsupplr.company1 as vendor_pickup_warehouse_name,   
                apsupplr.address1 as vendor_pickup_warehouse_address1,   
                apsupplr.address2 as vendor_pickup_warehouse_address2,   
                apsupplr.city as vendor_pickup_warehouse_city,  
                apsupplr.province as vendor_pickup_warehouse_state,  
                apsupplr.postcode as vendor_pickup_warehouse_zip, 
                ap_poitm.product_id as item_number,   
                iv_mast.descript as item_description_long,   
                iv_mast.pk_size as item_pack_size,   
                iv_mast.iv_class as it_class, 
                iv_mast.pk_ctch_wt as has_ctch_wgt,  
                iv_mast.pk_upc as pk_upc,   
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity, 
                cast(0 as integer) as po_cancelled_quantity, 
                cast(ap_poitm.cost as numeric(9, 4)) as product_price,    
                cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
                cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  
                cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  
                icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, 
                cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, 
                iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name 
                from ap_poitm 
                inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
                inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
                inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
                inner join apsupplr on apsupplr.vend_id = iv_mast.vend_id and apsupplr.supplr_no = iv_mast.supplr_no
                where ap_poitm.product_id = '513018' and ap_pohdr.pono = '109097'
select 
                ap_pohdr.pono,   
                ap_pohdr.vend_id,  
                apsupplr.supplr_no,
                ap_pohdr.closed as po_closed_date,   
                ap_pohdr.issued as po_issued_date, 
                ap_pohdr.re_open as po_re_open_date,  
                ap_pohdr.cancelled as po_cancelled_date, 
                ap_pohdr.date as po_creation_date,   
                ap_pohdr.req_date as po_schedule_receipt_date, 
                ap_pohdr.req_date as po_actual_receipt_date, 
                apvend.company1 as vendor_name,   
                apsupplr.company1 as vendor_pickup_warehouse_name,   
                apsupplr.address1 as vendor_pickup_warehouse_address1,   
                apsupplr.address2 as vendor_pickup_warehouse_address2,   
                apsupplr.city as vendor_pickup_warehouse_city,  
                apsupplr.province as vendor_pickup_warehouse_state,  
                apsupplr.postcode as vendor_pickup_warehouse_zip, 
                ap_poitm.product_id as item_number,   
                iv_mast.descript as item_description_long,   
                iv_mast.pk_size as item_pack_size,   
                iv_mast.iv_class as it_class, 
                iv_mast.pk_ctch_wt as has_ctch_wgt,  
                iv_mast.pk_upc as pk_upc,   
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity, 
                cast(0 as integer) as po_cancelled_quantity, 
                cast(ap_poitm.cost as numeric(9, 4)) as product_price,    
                cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
                cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  
                cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  
                icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, 
                cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, 
                iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name 
                from ap_poitm 
                inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
                inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
                inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id inner join apsupplr on apsupplr.refno = apvend.refno 
                where ap_poitm.product_id = '513018' and ap_pohdr.pono = '109097'
select 
                ap_pohdr.pono,   
                ap_pohdr.vend_id,  
                apsupplr.supplr_no,
                ap_pohdr.closed as po_closed_date,   
                ap_pohdr.issued as po_issued_date, 
                ap_pohdr.re_open as po_re_open_date,  
                ap_pohdr.cancelled as po_cancelled_date, 
                ap_pohdr.date as po_creation_date,   
                ap_pohdr.req_date as po_schedule_receipt_date, 
                ap_pohdr.req_date as po_actual_receipt_date, 
                apvend.company1 as vendor_name,   
                apsupplr.company1 as vendor_pickup_warehouse_name,   
                apsupplr.address1 as vendor_pickup_warehouse_address1,   
                apsupplr.address2 as vendor_pickup_warehouse_address2,   
                apsupplr.city as vendor_pickup_warehouse_city,  
                apsupplr.province as vendor_pickup_warehouse_state,  
                apsupplr.postcode as vendor_pickup_warehouse_zip, 
                ap_poitm.product_id as item_number,   
                iv_mast.descript as item_description_long,   
                iv_mast.pk_size as item_pack_size,   
                iv_mast.iv_class as it_class, 
                iv_mast.pk_ctch_wt as has_ctch_wgt,  
                iv_mast.pk_upc as pk_upc,   
                iv_gtin.gtin as it_gtin, 
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity, 
                cast(0 as integer) as po_cancelled_quantity, 
                cast(ap_poitm.cost as numeric(9, 4)) as product_price,    
                cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
                cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  
                cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  
                icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, 
                cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, 
                iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name 
                from ap_poitm 
                inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
                inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
                inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
               inner join apsupplr on apsupplr.vend_id = iv_mast.vend_id and apsupplr.supplr_no = iv_mast.supplr_no
               left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id  
                where ap_poitm.product_id = '513018' and ap_pohdr.pono = '109097'
select 
                ap_pohdr.pono,   
                ap_pohdr.vend_id,  
                apsupplr.supplr_no,
                ap_pohdr.closed as po_closed_date,   
                ap_pohdr.issued as po_issued_date, 
                ap_pohdr.re_open as po_re_open_date,  
                ap_pohdr.cancelled as po_cancelled_date, 
                ap_pohdr.date as po_creation_date,   
                ap_pohdr.req_date as po_schedule_receipt_date, 
                ap_pohdr.req_date as po_actual_receipt_date, 
                apvend.company1 as vendor_name,   
                apsupplr.company1 as vendor_pickup_warehouse_name,   
                apsupplr.address1 as vendor_pickup_warehouse_address1,   
                apsupplr.address2 as vendor_pickup_warehouse_address2,   
                apsupplr.city as vendor_pickup_warehouse_city,  
                apsupplr.province as vendor_pickup_warehouse_state,  
                apsupplr.postcode as vendor_pickup_warehouse_zip, 
                ap_poitm.product_id as item_number,   
                iv_mast.descript as item_description_long,   
                iv_mast.pk_size as item_pack_size,   
                iv_mast.iv_class as it_class, 
                iv_mast.pk_ctch_wt as has_ctch_wgt,  
                iv_mast.pk_upc as pk_upc,   
                iv_gtin.gtin as it_gtin, 
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity, 
                cast(0 as integer) as po_cancelled_quantity, 
                cast(ap_poitm.cost as numeric(9, 4)) as product_price,    
                cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
                cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  
                cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  
                icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, 
                cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, 
                iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name 
                from ap_poitm 
                inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
                inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
                inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
               inner join apsupplr on apsupplr.vend_id = iv_mast.vend_id and apsupplr.supplr_no = iv_mast.supplr_no
               left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id  
                where ap_poitm.product_id = '513018' and ap_pohdr.pono = '109097'
select * from ap_pohdr where ap_pohdr.pono = '109097'

select * from ap_pohdr where ap_pohdr.pono = '10973'
select * from ap_pohdr where ap_pohdr.pono = '10973'
select * from ap_pohdr where ap_pohdr.pono = '10973'

select 
                ap_pohdr.pono,   
                ap_pohdr.vend_id,  
                apsupplr.supplr_no,
                ap_pohdr.closed as po_closed_date,   
                ap_pohdr.issued as po_issued_date, 
                ap_pohdr.re_open as po_re_open_date,  
                ap_pohdr.cancelled as po_cancelled_date, 
                ap_pohdr.date as po_creation_date,   
                ap_pohdr.req_date as po_schedule_receipt_date, 
                ap_pohdr.req_date as po_actual_receipt_date, 
                apvend.company1 as vendor_name,   
                apsupplr.company1 as vendor_pickup_warehouse_name,   
                apsupplr.address1 as vendor_pickup_warehouse_address1,   
                apsupplr.address2 as vendor_pickup_warehouse_address2,   
                apsupplr.city as vendor_pickup_warehouse_city,  
                apsupplr.province as vendor_pickup_warehouse_state,  
                apsupplr.postcode as vendor_pickup_warehouse_zip, 
                ap_poitm.product_id as item_number,   
                iv_mast.descript as item_description_long,   
                iv_mast.pk_size as item_pack_size,   
                iv_mast.iv_class as it_class, 
                iv_mast.pk_ctch_wt as has_ctch_wgt,  
                iv_mast.pk_upc as pk_upc,   
                iv_gtin.gtin as it_gtin, 
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity, 
                cast(0 as integer) as po_cancelled_quantity, 
                cast(ap_poitm.cost as numeric(9, 4)) as product_price,    
                cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
                cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  
                cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  
                icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, 
                cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, 
                iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name 
                from ap_poitm 
                inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
                inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
                inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
               inner join apsupplr on apsupplr.vend_id = iv_mast.vend_id and apsupplr.supplr_no = iv_mast.supplr_no
               left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id  
                where ap_poitm.product_id = '265688' and ap_pohdr.pono = '109377'
select * from coremeta

select * from coremeta where cobjectnam like 'cube'

select * from coremeta where cobjectnam like '%cube%'

select 
                ap_pohdr.pono,   
                ap_pohdr.vend_id,  
                apsupplr.supplr_no,
                ap_pohdr.closed as po_closed_date,   
                ap_pohdr.issued as po_issued_date, 
                ap_pohdr.re_open as po_re_open_date,  
                ap_pohdr.cancelled as po_cancelled_date, 
                ap_pohdr.date as po_creation_date,   
                ap_pohdr.req_date as po_schedule_receipt_date, 
                ap_pohdr.req_date as po_actual_receipt_date, 
                apvend.company1 as vendor_name,   
                apsupplr.company1 as vendor_pickup_warehouse_name,   
                apsupplr.address1 as vendor_pickup_warehouse_address1,   
                apsupplr.address2 as vendor_pickup_warehouse_address2,   
                apsupplr.city as vendor_pickup_warehouse_city,  
                apsupplr.province as vendor_pickup_warehouse_state,  
                apsupplr.postcode as vendor_pickup_warehouse_zip, 
                ap_poitm.product_id as item_number,   
                iv_mast.descript as item_description_long,   
                iv_mast.pk_size as item_pack_size,   
                iv_mast.iv_class as it_class, 
                iv_mast.pk_ctch_wt as has_ctch_wgt,  
                iv_mast.pk_upc as pk_upc,   
                iv_gtin.gtin as it_gtin, 
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity, 
                cast(0 as integer) as po_cancelled_quantity, 
                cast(ap_poitm.cost as numeric(9, 4)) as product_price,    
                cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
                cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  
                cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  
                icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, 
                cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, 
                iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name 
                from ap_poitm 
                inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
                inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
                inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
               inner join apsupplr on apsupplr.vend_id = iv_mast.vend_id and apsupplr.supplr_no = iv_mast.supplr_no
               left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id  
                where ap_poitm.product_id = '265688' and ap_pohdr.pono = '109377'
select 
                ap_pohdr.pono,   
                ap_pohdr.vend_id,  
                apsupplr.supplr_no,
                ap_pohdr.closed as po_closed_date,   
                ap_pohdr.issued as po_issued_date, 
                ap_pohdr.re_open as po_re_open_date,  
                ap_pohdr.cancelled as po_cancelled_date, 
                ap_pohdr.date as po_creation_date,   
                ap_pohdr.req_date as po_schedule_receipt_date, 
                ap_pohdr.req_date as po_actual_receipt_date, 
                apvend.company1 as vendor_name,   
                apsupplr.company1 as vendor_pickup_warehouse_name,   
                apsupplr.address1 as vendor_pickup_warehouse_address1,   
                apsupplr.address2 as vendor_pickup_warehouse_address2,   
                apsupplr.city as vendor_pickup_warehouse_city,  
                apsupplr.province as vendor_pickup_warehouse_state,  
                apsupplr.postcode as vendor_pickup_warehouse_zip, 
                ap_poitm.product_id as item_number,   
                iv_mast.descript as item_description_long,   
                iv_mast.pk_size as item_pack_size,   
                iv_mast.iv_class as it_class, 
                iv_mast.pk_ctch_wt as has_ctch_wgt,  
                iv_mast.pk_upc as pk_upc,   
                iv_gtin.gtin as it_gtin, 
                ap_poitm.ord_cube as item_cube, 
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity, 
                cast(0 as integer) as po_cancelled_quantity, 
                cast(ap_poitm.cost as numeric(9, 4)) as product_price,    
                cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
                cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  
                cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  
                icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, 
                cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, 
                iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name 
                from ap_poitm 
                inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
                inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
                inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
               inner join apsupplr on apsupplr.vend_id = iv_mast.vend_id and apsupplr.supplr_no = iv_mast.supplr_no
               left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id  
                where ap_poitm.product_id = '265688' and ap_pohdr.pono = '109377'
select 
                ap_pohdr.pono,   
                ap_pohdr.vend_id,  
                apsupplr.supplr_no,
                ap_pohdr.closed as po_closed_date,   
                ap_pohdr.issued as po_issued_date, 
                ap_pohdr.re_open as po_re_open_date,  
                ap_pohdr.cancelled as po_cancelled_date, 
                ap_pohdr.date as po_creation_date,   
                ap_pohdr.req_date as po_schedule_receipt_date, 
                ap_pohdr.req_date as po_actual_receipt_date, 
                apvend.company1 as vendor_name,   
                apsupplr.company1 as vendor_pickup_warehouse_name,   
                apsupplr.address1 as vendor_pickup_warehouse_address1,   
                apsupplr.address2 as vendor_pickup_warehouse_address2,   
                apsupplr.city as vendor_pickup_warehouse_city,  
                apsupplr.province as vendor_pickup_warehouse_state,  
                apsupplr.postcode as vendor_pickup_warehouse_zip, 
                ap_poitm.product_id as item_number,   
                iv_mast.descript as item_description_long,   
                iv_mast.pk_size as item_pack_size,   
                iv_mast.iv_class as it_class, 
                iv_mast.pk_ctch_wt as has_ctch_wgt,  
                iv_mast.pk_upc as pk_upc,   
                iv_gtin.gtin as it_gtin, 
                ap_poitm.ord_cube as item_cube, 
                 iv_mast.ord_cube as iv_mast_cube, 
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity, 
                cast(0 as integer) as po_cancelled_quantity, 
                cast(ap_poitm.cost as numeric(9, 4)) as product_price,    
                cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
                cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  
                cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  
                icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, 
                cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, 
                iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name 
                from ap_poitm 
                inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
                inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
                inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
               inner join apsupplr on apsupplr.vend_id = iv_mast.vend_id and apsupplr.supplr_no = iv_mast.supplr_no
               left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id  
                where ap_poitm.product_id = '265688' and ap_pohdr.pono = '109377'
select 
                ap_pohdr.pono,   
                ap_pohdr.vend_id,  
                apsupplr.supplr_no,
                ap_pohdr.closed as po_closed_date,   
                ap_pohdr.issued as po_issued_date, 
                ap_pohdr.re_open as po_re_open_date,  
                ap_pohdr.cancelled as po_cancelled_date, 
                ap_pohdr.date as po_creation_date,   
                ap_pohdr.req_date as po_schedule_receipt_date, 
                ap_pohdr.req_date as po_actual_receipt_date, 
                apvend.company1 as vendor_name,   
                apsupplr.company1 as vendor_pickup_warehouse_name,   
                apsupplr.address1 as vendor_pickup_warehouse_address1,   
                apsupplr.address2 as vendor_pickup_warehouse_address2,   
                apsupplr.city as vendor_pickup_warehouse_city,  
                apsupplr.province as vendor_pickup_warehouse_state,  
                apsupplr.postcode as vendor_pickup_warehouse_zip, 
                ap_poitm.product_id as item_number,   
                iv_mast.descript as item_description_long,   
                iv_mast.pk_size as item_pack_size,   
                iv_mast.iv_class as it_class, 
                iv_mast.pk_ctch_wt as has_ctch_wgt,  
                iv_mast.pk_upc as pk_upc,   
                iv_gtin.gtin as it_gtin, 
                ap_poitm.ord_cube as item_cube, 
                 iv_mast.ord_cube as iv_mast_cube, 
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity, 
                cast(0 as integer) as po_cancelled_quantity, 
                cast(ap_poitm.cost as numeric(9, 4)) as product_price,    
                cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
                cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  
                cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  

                cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  
                iv_mast.pk_weight as packWeight,

                icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, 
                cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, 
                iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name 
                from ap_poitm 
                inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
                inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
                inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
               inner join apsupplr on apsupplr.vend_id = iv_mast.vend_id and apsupplr.supplr_no = iv_mast.supplr_no
               left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id  
                where ap_poitm.product_id = '265688' and ap_pohdr.pono = '109377'
Select * from iv_sell_units where product_id = '265688'

Select * from iv_mast where product_id = '265688'

select 
                ap_pohdr.pono,   
                ap_pohdr.vend_id,  
                apsupplr.supplr_no,
                ap_pohdr.closed as po_closed_date,   
                ap_pohdr.issued as po_issued_date, 
                ap_pohdr.re_open as po_re_open_date,  
                ap_pohdr.cancelled as po_cancelled_date, 
                ap_pohdr.date as po_creation_date,   
                ap_pohdr.req_date as po_schedule_receipt_date, 
                ap_pohdr.req_date as po_actual_receipt_date, 
                apvend.company1 as vendor_name,   
                apsupplr.company1 as vendor_pickup_warehouse_name,   
                apsupplr.address1 as vendor_pickup_warehouse_address1,   
                apsupplr.address2 as vendor_pickup_warehouse_address2,   
                apsupplr.city as vendor_pickup_warehouse_city,  
                apsupplr.province as vendor_pickup_warehouse_state,  
                apsupplr.postcode as vendor_pickup_warehouse_zip, 
                ap_poitm.product_id as item_number,   
                iv_mast.descript as item_description_long,   
                iv_mast.pk_size as item_pack_size,   
                iv_mast.iv_class as it_class, 
                iv_mast.pk_ctch_wt as has_ctch_wgt,  
                iv_mast.pk_upc as pk_upc,   
                iv_mast.pk_factor as packing_factor,

                iv_gtin.gtin as it_gtin, 
                ap_poitm.ord_cube as item_cube, 
                 iv_mast.ord_cube as iv_mast_cube, 
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity, 
                cast(0 as integer) as po_cancelled_quantity, 
                cast(ap_poitm.cost as numeric(9, 4)) as product_price,    
                cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
                cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  
                cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  

                cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  
                iv_mast.pk_weight as packWeight,
                 

                icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, 
                cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, 
                iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name 
                from ap_poitm 
                inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
                inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
                inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
               inner join apsupplr on apsupplr.vend_id = iv_mast.vend_id and apsupplr.supplr_no = iv_mast.supplr_no
               left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id  
                where ap_poitm.product_id = '265688' and ap_pohdr.pono = '109377'
select 
                ap_pohdr.pono,   
                ap_pohdr.vend_id,  
                apsupplr.supplr_no,
                ap_pohdr.closed as po_closed_date,   
                ap_pohdr.issued as po_issued_date, 
                ap_pohdr.re_open as po_re_open_date,  
                ap_pohdr.cancelled as po_cancelled_date, 
                ap_pohdr.date as po_creation_date,   
                ap_pohdr.req_date as po_schedule_receipt_date, 
                ap_pohdr.req_date as po_actual_receipt_date, 
                apvend.company1 as vendor_name,   
                apsupplr.company1 as vendor_pickup_warehouse_name,   
                apsupplr.address1 as vendor_pickup_warehouse_address1,   
                apsupplr.address2 as vendor_pickup_warehouse_address2,   
                apsupplr.city as vendor_pickup_warehouse_city,  
                apsupplr.province as vendor_pickup_warehouse_state,  
                apsupplr.postcode as vendor_pickup_warehouse_zip, 
                ap_poitm.product_id as item_number,   
                iv_mast.descript as item_description_long,   
                iv_mast.pk_size as item_pack_size,   
                iv_mast.iv_class as it_class, 
                iv_mast.pk_ctch_wt as has_ctch_wgt,  
                iv_mast.pk_upc as pk_upc,   
                iv_mast.pk_factor as packing_factor,

                iv_gtin.gtin as it_gtin, 
                ap_poitm.ord_cube as item_cube, 
                 iv_mast.ord_cube as iv_mast_cube, 
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity, 
                cast(0 as integer) as po_cancelled_quantity, 
                cast(ap_poitm.cost as numeric(9, 4)) as product_price,    
                cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
                cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  
                cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  

                cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  
                iv_mast.pk_weight as packWeight,
                 

                icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, 
                cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, 
                iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name 
                from ap_poitm 
                inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
                inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
                inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
               inner join apsupplr on apsupplr.vend_id = iv_mast.vend_id and apsupplr.supplr_no = iv_mast.supplr_no
               left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id  
                where ap_poitm.product_id = '265688' and ap_pohdr.pono = '109377'
select 
                ap_pohdr.pono,   
                ap_pohdr.vend_id,  
                apsupplr.supplr_no,
                ap_pohdr.closed as po_closed_date,   
                ap_pohdr.issued as po_issued_date, 
                ap_pohdr.re_open as po_re_open_date,  
                ap_pohdr.cancelled as po_cancelled_date, 
                ap_pohdr.date as po_creation_date,   
                ap_pohdr.req_date as po_schedule_receipt_date, 
                ap_pohdr.req_date as po_actual_receipt_date, 
                apvend.company1 as vendor_name,   
                apsupplr.company1 as vendor_pickup_warehouse_name,   
                apsupplr.address1 as vendor_pickup_warehouse_address1,   
                apsupplr.address2 as vendor_pickup_warehouse_address2,   
                apsupplr.city as vendor_pickup_warehouse_city,  
                apsupplr.province as vendor_pickup_warehouse_state,  
                apsupplr.postcode as vendor_pickup_warehouse_zip, 
                ap_poitm.product_id as item_number,   
                iv_mast.descript as item_description_long,   
                iv_mast.pk_size as item_pack_size,   
                iv_mast.iv_class as it_class, 
                iv_mast.pk_ctch_wt as has_ctch_wgt,  
                iv_mast.pk_upc as pk_upc,   
                iv_mast.pk_factor as packing_factor,

                iv_gtin.gtin as it_gtin, 
                ap_poitm.ord_cube as item_cube, 
                 iv_mast.ord_cube as iv_mast_cube, 
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.ord_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.ord_qty), 0) as integer) as po_order_quantit,
                cast(round(iif(ap_poitm.ord_unit = 'KG', (ap_poitm.rec_qty / iv_mast.pk_weight) * 2.204621, ap_poitm.rec_qty), 0) as integer) as po_receipt_quantity, 
                cast(0 as integer) as po_cancelled_quantity, 
                cast(ap_poitm.cost as numeric(9, 4)) as product_price,    
                cast(round(iif(iv_mast.pk_ctch_wt, ap_poitm.ord_qty_lb, 0), 0) as integer) as po_catch_weight, 
                cast(round(ap_pohdr.cube_total * 3.2808399, 0) as integer) as po_total_cube,  
                cast(icase(iv_mast.bc_factor <> 0, int(iv_mast.bc_factor), 1) as integer) as units_per_case,  

                cast(round(iif(iv_mast.pk_tare_wt <> 0, (iv_mast.pk_weight + iv_mast.pk_tare_wt) * 2.204621, 0), 4) as numeric(9, 4)) as gross_case_weight,  
                cast(round(iif(iv_mast.pk_tare_wt <> 0, 0, iv_mast.pk_weight * 2.204621), 4) as numeric(9, 4)) as net_case_weight,  
                iv_mast.pk_weight as packWeight,
                 

                icase(iv_mast.pk_sell_un = 'KG', 'LB', iv_mast.pk_sell_un) as stocking_unit_of_measure, 
                cast(round(iif(ap_pohdr.lb_prefer, ap_pohdr.wt_total, ap_pohdr.wt_total * 2.204621), 0) as integer) as po_total_weight, 
                iv_mast.vprod_id as vprod_id,iv_mast.brand as item_brand_name 
                from ap_poitm 
                inner join ap_pohdr on ap_pohdr.refno = ap_poitm.refno 
                inner join iv_mast on iv_mast.product_id = ap_poitm.product_id 
                inner join apvend on upper(apvend.vend_id) = ap_pohdr.vend_id 
               inner join apsupplr on apsupplr.vend_id = iv_mast.vend_id and apsupplr.supplr_no = iv_mast.supplr_no
               left join iv_gtin on ap_poitm.product_id = iv_gtin.product_id  
                where ap_poitm.product_id = '265688' and ap_pohdr.pono = '109377'
